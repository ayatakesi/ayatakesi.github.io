<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 26.1.

Copyright (C) 1990-1996, 1998-2018 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document under
the terms of the GNU Free Documentation License, Version 1.3 or any later
version published by the Free Software Foundation; with the Invariant
Sections being "GNU General Public License," with the Front-Cover Texts
being "A GNU Manual," and with the Back-Cover Texts as in (a) below.  A
copy of the license is included in the section entitled "GNU Free
Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and modify
this GNU manual.  Buying copies from the FSF supports it in developing GNU
and promoting software freedom." -->
<!-- Created by GNU Texinfo 6.6, http://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>25.9.4 ファイル名を展開する関数 (GNU Emacs Lisp Reference Manual)</title>

<meta name="description" content="25.9.4 ファイル名を展開する関数 (GNU Emacs Lisp Reference Manual)">
<meta name="keywords" content="25.9.4 ファイル名を展開する関数 (GNU Emacs Lisp Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Emacs Lisp">
<link href="Index.html#Index" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="File-Names.html#File-Names" rel="up" title="25.9 ファイルの名前">
<link href="Unique-File-Names.html#Unique-File-Names" rel="next" title="25.9.5 一意なファイル名の生成">
<link href="Directory-Names.html#Directory-Names" rel="prev" title="25.9.3 ディレクトリーの名前">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en">
<span id="File-Name-Expansion"></span><div class="header">
<p>
Next: <a href="Unique-File-Names.html#Unique-File-Names" accesskey="n" rel="next">Unique File Names</a>, Previous: <a href="Directory-Names.html#Directory-Names" accesskey="p" rel="prev">Directory Names</a>, Up: <a href="File-Names.html#File-Names" accesskey="u" rel="up">File Names</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html#Index" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<span id="huairuMing-woZhan-Kai-suruGuan-Shu-"></span><h4 class="subsection">25.9.4 ファイル名を展開する関数</h4>
<span id="index-expansion-of-file-names"></span>

<p><em>Expanding</em> a file name means converting a relative file name to an
absolute one.  Since this is done relative to a default directory, you must
specify the default directory as well as the file name to be expanded.  It
also involves expanding abbreviations like <samp>~/</samp>
(<a href="Directory-Names.html#abbreviate_002dfile_002dname">abbreviate-file-name</a>を参照)、
の展開、および<samp>./</samp>や<samp><var>name</var>/../</samp>のような冗長さの排除も行います。
も展開します。
</p>
<dl>
<dt id="index-expand_002dfile_002dname">Function: <strong>expand-file-name</strong> <em>filename &amp;optional directory</em></dt>
<dd><p>This function converts <var>filename</var> to an absolute file name.  If
<var>directory</var> is supplied, it is the default directory to start with if
<var>filename</var> is relative and does not start with &lsquo;<samp>~</samp>&rsquo;.  (The value of
<var>directory</var> should itself be an absolute directory name or directory
file name; it may start with &lsquo;<samp>~</samp>&rsquo;.)  Otherwise, the current buffer&rsquo;s
value of <code>default-directory</code> is used.  For example:
</p>
<div class="example">
<pre class="example">(expand-file-name &quot;foo&quot;)
     &rArr; &quot;/xcssun/users/rms/lewis/foo&quot;
</pre><pre class="example">(expand-file-name &quot;../foo&quot;)
     &rArr; &quot;/xcssun/users/rms/foo&quot;
</pre><pre class="example">(expand-file-name &quot;foo&quot; &quot;/usr/spool/&quot;)
     &rArr; &quot;/usr/spool/foo&quot;
</pre></div>

<p>If the part of <var>filename</var> before the first slash is &lsquo;<samp>~</samp>&rsquo;, it expands
to the value of the <code>HOME</code> environment variable (usually your home
directory).  If the part before the first slash is &lsquo;<samp>~<var>user</var></samp>&rsquo; and if
<var>user</var> is a valid login name, it expands to <var>user</var>&rsquo;s home
directory.  If you do not want this expansion for a relative <var>filename</var>
that might begin with a literal &lsquo;<samp>~</samp>&rsquo;, you can use <code>(concat
(file-name-as-directory directory) filename)</code> instead of
<code>(expand-file-name filename directory)</code>.
</p>
<p>&lsquo;<samp>.</samp>&rsquo;または&lsquo;<samp>..</samp>&rsquo;を含むファイル名は、正規化形式に簡略化される:
</p>
<div class="example">
<pre class="example">(expand-file-name &quot;bar/../foo&quot;)
     &rArr; &quot;/xcssun/users/rms/lewis/foo&quot;
</pre></div>

<p>出力に&lsquo;<samp>..</samp>&rsquo;コンポーネントが残り得る場合もある:
</p>
<div class="example">
<pre class="example">(expand-file-name &quot;../home&quot; &quot;/&quot;)
     &rArr; &quot;/../home&quot;
</pre></div>

<p>This is for the sake of filesystems that have the concept of a superroot
above the root directory <samp>/</samp>.  On other filesystems, <samp>/../</samp> is
interpreted exactly the same as <samp>/</samp>.
</p>
<p><code>expand-file-name</code>は環境変数を展開<em>しない</em>ことに注意。<code>substitute-in-file-name</code>だけが、それを行う。
</p>
<div class="example">
<pre class="example">(expand-file-name &quot;$HOME/foo&quot;)
     &rArr; &quot;/xcssun/users/rms/lewis/$HOME/foo&quot;
</pre></div>

<p><code>expand-file-name</code>は、あらゆる階層においてシンボリックリンクをフォローしないことにも注意。これは&lsquo;<samp>..</samp>&rsquo;の扱いが<code>file-truename</code>と<code>expand-file-name</code>で異なることに起因する。&lsquo;<samp>/tmp/bar</samp>&rsquo;がディレクトリー&lsquo;<samp>/tmp/foo/bar</samp>&rsquo;にたいするシンボリックリンクであると仮定すると:
</p>
<div class="example">
<pre class="example">(file-truename &quot;/tmp/bar/../myfile&quot;)
     &rArr; &quot;/tmp/foo/myfile&quot;
</pre><pre class="example">(expand-file-name &quot;/tmp/bar/../myfile&quot;)
     &rArr; &quot;/tmp/myfile&quot;
</pre></div>

<p>直接間接を問わず、事前に<code>expand-file-name</code>を呼び出さずに&lsquo;<samp>..</samp>&rsquo;に先行するシンボリックリンクをフォローする必要があるかもしれない場合は、それを呼び出さずに確実に<code>file-truename</code>を呼び出すべきである。<a href="Truenames.html#Truenames">本当の名前</a>を参照のこと。
</p></dd></dl>

<dl>
<dt id="index-default_002ddirectory">Variable: <strong>default-directory</strong></dt>
<dd><p>このバッファーローカル変数の値は、カレントバッファーにたいするデフォルトディレクトリーである。これは絶対ディレクトリー名であること。これは&lsquo;<samp>~</samp>&rsquo;で始まるかもしれない。この変数は、すべてのバッファーにおいてバッファーローカルである。
</p>
<p>2つ目の引数が<code>nil</code>の場合、<code>expand-file-name</code>はデフォルトディレクトリーを使用する。
</p>
<p>値は常にスラッシュで終わる文字列である。
</p>
<div class="example">
<pre class="example">default-directory
     &rArr; &quot;/user/lewis/manual/&quot;
</pre></div>
</dd></dl>

<dl>
<dt id="index-substitute_002din_002dfile_002dname">Function: <strong>substitute-in-file-name</strong> <em>filename</em></dt>
<dd><span id="Definition-of-substitute_002din_002dfile_002dname"></span><p>This function replaces environment variable references in <var>filename</var>
with the environment variable values.  Following standard Unix shell syntax,
&lsquo;<samp>$</samp>&rsquo; is the prefix to substitute an environment variable value.  If the
input contains &lsquo;<samp>$$</samp>&rsquo;, that is converted to &lsquo;<samp>$</samp>&rsquo;; this gives the user
a way to quote a &lsquo;<samp>$</samp>&rsquo;.
</p>
<p>環境変数名は&lsquo;<samp>$</samp>&rsquo;の後に続く一連の英数字(アンダースコアを含む)である。&lsquo;<samp>$</samp>&rsquo;の後続文字が、&lsquo;<samp>{</samp>&rsquo;の場合はマッチする&lsquo;<samp>}</samp>&rsquo;までのすべてが変数名である。
</p>
<p><code>substitute-in-file-name</code>により生成された出力で<code>substitute-in-file-name</code>を呼び出すと、不正な結果となる傾向がある。たとえば、単一の&lsquo;<samp>$</samp>&rsquo;をクォートするための&lsquo;<samp>$$</samp>&rsquo;の使用は正しく機能しないだろうし、環境変数値の中の&lsquo;<samp>$</samp>&rsquo;は再帰的な置換を導くだろう。したがって、この関数を呼び出して、出力をこの関数に渡すプログラムは、その後の不正な結果を防ぐために、すべての&lsquo;<samp>$</samp>&rsquo;文字を二重化する必要がある。
</p>
<p>Here we assume that the environment variable <code>HOME</code>, which holds the
user&rsquo;s home directory, has value &lsquo;<samp>/xcssun/users/rms</samp>&rsquo;.
</p>
<div class="example">
<pre class="example">(substitute-in-file-name &quot;$HOME/foo&quot;)
     &rArr; &quot;/xcssun/users/rms/foo&quot;
</pre></div>

<p>置き換え後は、&lsquo;<samp>/</samp>&rsquo;の直後に&lsquo;<samp>~</samp>&rsquo;や別の&lsquo;<samp>/</samp>&rsquo;が出現した場合、この関数は、&lsquo;<samp>/</samp>&rsquo;の前にあるすべてを無視する。
</p>
<div class="example">
<pre class="example">(substitute-in-file-name &quot;bar/~/foo&quot;)
     &rArr; &quot;~/foo&quot;
</pre><pre class="example">(substitute-in-file-name &quot;/usr/local/$HOME/foo&quot;)
     &rArr; &quot;/xcssun/users/rms/foo&quot;
     ;; <span class="roman"><samp>/usr/local/</samp>は破棄された</span>
</pre></div>

</dd></dl>

<p>Sometimes, it is not desired to expand file names.  In such cases, the file
name can be quoted to suppress the expansion, and to handle the file name
literally.  Quoting happens by prefixing the file name with &lsquo;<samp>/:</samp>&rsquo;.
</p>
<dl>
<dt id="index-file_002dname_002dquote">Macro: <strong>file-name-quote</strong> <em>name</em></dt>
<dd><p>This macro adds the quotation prefix &lsquo;<samp>/:</samp>&rsquo; to the file <var>name</var>.  For
a local file <var>name</var>, it prefixes <var>name</var> with &lsquo;<samp>/:</samp>&rsquo;.  If
<var>name</var> is a remote file name, the local part of <var>name</var> is quoted.
If <var>name</var> is already a quoted file name, <var>name</var> is returned
unchanged.
</p>
<div class="example">
<pre class="example">(substitute-in-file-name (file-name-quote &quot;bar/~/foo&quot;))
     &rArr; &quot;/:bar/~/foo&quot;
</pre><pre class="example">

</pre><pre class="example">(substitute-in-file-name (file-name-quote &quot;/ssh:host:bar/~/foo&quot;))
     &rArr; &quot;/ssh:host:/:bar/~/foo&quot;
</pre></div>

<p>The macro cannot be used to suppress file name handlers from magic file
names (see section <a href="Magic-File-Names.html#Magic-File-Names">特定のファイル名の&ldquo;Magic&rdquo;の作成</a>).
</p></dd></dl>

<dl>
<dt id="index-file_002dname_002dunquote">Macro: <strong>file-name-unquote</strong> <em>name</em></dt>
<dd><p>This macro removes the quotation prefix &lsquo;<samp>/:</samp>&rsquo; from the file <var>name</var>,
if any. If <var>name</var> is a remote file name, the local part of <var>name</var> is
unquoted.
</p></dd></dl>

<dl>
<dt id="index-file_002dname_002dquoted_002dp">Macro: <strong>file-name-quoted-p</strong> <em>name</em></dt>
<dd><p>This macro returns non-<code>nil</code>, when <var>name</var> is quoted with the prefix
&lsquo;<samp>/:</samp>&rsquo;.  If <var>name</var> is a remote file name, the local part of
<var>name</var> is checked.
</p></dd></dl>


<hr>
<div class="header">
<p>
Next: <a href="Unique-File-Names.html#Unique-File-Names" accesskey="n" rel="next">Unique File Names</a>, Previous: <a href="Directory-Names.html#Directory-Names" accesskey="p" rel="prev">Directory Names</a>, Up: <a href="File-Names.html#File-Names" accesskey="u" rel="up">File Names</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html#Index" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
