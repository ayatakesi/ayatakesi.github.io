<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 25.2.

Copyright (C) 1990-1996, 1998-2017 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document under
the terms of the GNU Free Documentation License, Version 1.3 or any later
version published by the Free Software Foundation; with the Invariant
Sections being "GNU General Public License," with the Front-Cover Texts
being "A GNU Manual," and with the Back-Cover Texts as in (a) below.  A
copy of the license is included in the section entitled "GNU Free
Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and modify
this GNU manual.  Buying copies from the FSF supports it in developing GNU
and promoting software freedom." -->
<!-- Created by GNU Texinfo 6.6, http://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>32.10.7 明示的なエンコードとデコード (GNU Emacs Lisp Reference Manual)</title>

<meta name="description" content="32.10.7 明示的なエンコードとデコード (GNU Emacs Lisp Reference Manual)">
<meta name="keywords" content="32.10.7 明示的なエンコードとデコード (GNU Emacs Lisp Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Emacs Lisp">
<link href="Index.html#Index" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Coding-Systems.html#Coding-Systems" rel="up" title="32.10 コーディングシステム">
<link href="Terminal-I_002fO-Encoding.html#Terminal-I_002fO-Encoding" rel="next" title="32.10.8 端末I/Oのエンコーディング">
<link href="Specifying-Coding-Systems.html#Specifying-Coding-Systems" rel="prev" title="32.10.6 単一の操作にたいするコーディングシステムの指定">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en">
<span id="Explicit-Encoding"></span><div class="header">
<p>
Next: <a href="Terminal-I_002fO-Encoding.html#Terminal-I_002fO-Encoding" accesskey="n" rel="next">Terminal I/O Encoding</a>, Previous: <a href="Specifying-Coding-Systems.html#Specifying-Coding-Systems" accesskey="p" rel="prev">Specifying Coding Systems</a>, Up: <a href="Coding-Systems.html#Coding-Systems" accesskey="u" rel="up">Coding Systems</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html#Index" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<span id="Ming-ShiDe-naenkodotodekodo"></span><h4 class="subsection">32.10.7 明示的なエンコードとデコード</h4>
<span id="index-encoding-in-coding-systems"></span>
<span id="index-decoding-in-coding-systems"></span>

<p>Emacs内外へテキストを転送するすべての操作は、そのテキストをエンコードまたはデコードする能力をもっています。このセクション内の関数を使用して、テキストを明示的にエンコードあるいはデコードすることもできます。
</p>
<p>エンコード結果およびデコーディングへの入力は、通常のテキストではありません。これらは理論的には一連のバイト値から構成され、すなわち一連の<acronym>ASCII</acronym>文字と8ビット文字から構成されます。ユニバイトのバッファーおよび文字列では、これらの文字は0から#xFF(255)の範囲のコードをもちます。マルチバイトのバッファーおよび文字列では、8ビット文字は#xFFより大きい文字コードをもちますが(<a href="Text-Representations.html#Text-Representations">テキストの表現方法</a>を参照)、そのようなテキストのエンコードやデコード時、Emacsは透過的にそれらを単一バイト値に変換します。
</p>
<p>コンテンツを明示的にデコードできるように、バイトシーケンスとしてバッファーにファイルを読み込むには、<code>insert-file-contents-literally</code>(<a href="Reading-from-Files.html#Reading-from-Files">ファイルの読み込み</a>を参照)を使用するのが通常の方法です。あるいは<code>find-file-noselect</code>でファイルをvisitする際、引数<var>rawfile</var>に非<code>nil</code>を指定することもできます。これらのメソッドの結果は、ユニバイトバッファーになります。
</p>
<p>テキストを明示的にエンコードした結果であるバイトシーケンスは、たとえばそれを<code>write-region</code>(see section <a href="Writing-to-Files.html#Writing-to-Files">ファイルの書き込み</a>)で書き込み、<code>coding-system-for-write</code>を<code>no-conversion</code>にバインドすることによりエンコードを抑制する等、それをファイルまたはプロセスへコピーするのが、通常の使い方です。
</p>
<p>以下は、エンコードまたはデコードを明示的に行う関数です。エンコード関数とはバイトシーケンスを生成し、デコード関数とはバイトシーケンスを操作する関数のことを意味します。これらの関数はすべて、テキストプロパティを破棄します。これらは、自身が使用したコーディングシステムを、正確に<code>last-coding-system-used</code>することも行います。
</p>
<dl>
<dt id="index-encode_002dcoding_002dregion">Command: <strong>encode-coding-region</strong> <em>start end coding-system &amp;optional destination</em></dt>
<dd><p>このコマンドは、<var>start</var>から<var>end</var>のテキストを、コーディングシステム<var>coding-system</var>でエンコードする。通常、バッファー内の元テキストはエンコードされたテキストで置き換えられるが、オプション引数<var>destination</var>でそれを変更できる。<var>destination</var>がバッファーなら、エンコードされたテキストはそのバッファーのポイントの後に挿入される(ポイントは移動しない)。<code>t</code>なら、このコマンドはエンコードされたテキストを挿入せずに、ユニバイトとしてリターンする。
</p>
<p>エンコードされたテキストが何らかのバッファーに挿入された場合、このコマンドはエンコードされたテキストの長さをリターンする。
</p>
<p>エンコードされた結果は理論的にはバイトシーケンスだが、バッファーが以前マルチバイトだったならマルチバイトのまま留まり、すべての8ビットのバイトはマルチバイト表現に変換される(<a href="Text-Representations.html#Text-Representations">テキストの表現方法</a>を参照)。
</p>
<span id="index-undecided-coding_002dsystem_002c-when-encoding"></span>
<p>期待しない結果となる恐れがあるので、テキストのエンコードする際は、<var>coding-system</var>に<code>undecided</code>を<em>使用してはならない</em>。<var>coding-system</var>にたいして自明な適値が存在しなければ、適切なエンコードを提案させるために、かわりに<code>select-safe-coding-system</code>を使用すること(<a href="User_002dChosen-Coding-Systems.html#User_002dChosen-Coding-Systems">select-safe-coding-system</a>を参照)。
</p></dd></dl>

<dl>
<dt id="index-encode_002dcoding_002dstring">Function: <strong>encode-coding-string</strong> <em>string coding-system &amp;optional nocopy buffer</em></dt>
<dd><p>この関数は、コーディングシステム<var>coding-system</var>で、<var>string</var>内のテキストをエンコードする。これはエンコードされたテキストを含む新たな文字列をリターンするが、<var>nocopy</var>が非<code>nil</code>の場合、些細なエンコード処理なら、この関数は<var>string</var>自身をリターンする。エンコード結果はユニバイト文字列である。
</p></dd></dl>

<dl>
<dt id="index-decode_002dcoding_002dregion">Command: <strong>decode-coding-region</strong> <em>start end coding-system &amp;optional destination</em></dt>
<dd><p>このコマンドは、コーディングシステム<var>coding-system</var>で、<var>start</var>から<var>end</var>のテキストをデコードする。明示的なデコードを使いやすくするために、デコード前のテキストはバイトシーケンス値であるべきだが、マルチバイトとユニバイトのバッファーいずれでも許すようになっている(マルチバイトバッファーの場合rawバイト値は8ビット文字で表現されていること)。通常、デコードされたテキストでバッファー内の元のテキストは置き換えられるが、オプション引数<var>destination</var>はそれを変更する。<var>destination</var>がバッファーなら、デコードされたテキストは、そのバッファーのポイントの後に挿入される(ポイントは移動しない)。これが<code>t</code>なら、このコマンドはデコードされたテキストを挿入せずに、それをマルチバイト文字列としてリターンする。
</p>
<p>デコードされたテキストが何らかのバッファーに挿入された場合、このコマンドはデコードされたテキストの長さをリターンする。
</p>
<p>このコマンドは、デコードされたテキストに、テキストプロパティ<code>charset</code>をputする。このプロパティの値は、元ののテキストのデコードに使用された文字セットを示す。
</p></dd></dl>

<dl>
<dt id="index-decode_002dcoding_002dstring">Function: <strong>decode-coding-string</strong> <em>string coding-system &amp;optional nocopy buffer</em></dt>
<dd><p>この関数は、<var>coding-system</var>で<var>string</var>内のテキストをデコードする。これはデコードされたテキストを含む新たな文字列をリターンするが、<var>nocopy</var>が非<code>nil</code>の場合、些細なデコード処理なら<var>string</var>自体をリターンするかもしれない。明示的なデコードを使いやすくするために、<var>string</var>のコンテンツはバイトシーケンス値をもつユニバイト文字列であるべきだが、マルチバイト文字列も許すようになっている(マルチバイト形式で8ビットバイトを含むと仮定する)。
</p>
<p>オプション引数<var>buffer</var>がバッファーを指定する場合、デコードされたテキストは、そのバッファー内のポイントの後に挿入される(ポイントは移動しない)。この場合、リターン値はデコードされたテキストの長さとなる。
</p>
<span id="index-charset_002c-text-property"></span>
<p>この関数は、デコードされたテキストに、テキストプロパティ<code>charset</code>をputする。このプロパティの値は、元のテキストのデコードに使用された、文字セットを示す。
</p>
<div class="example">
<pre class="example">(decode-coding-string &quot;Gr\374ss Gott&quot; 'latin-1)
     &rArr; #(&quot;Grüss Gott&quot; 0 9 (charset iso-8859-1))
</pre></div>
</dd></dl>

<dl>
<dt id="index-decode_002dcoding_002dinserted_002dregion">Function: <strong>decode-coding-inserted-region</strong> <em>from to filename &amp;optional visit beg end replace</em></dt>
<dd><p>この関数は、<var>from</var>から<var>to</var>のテキストを、あたかもファイル<var>filename</var>から、与えられた残りの引数で<code>insert-file-contents</code>を使用して読み込んだかのようにデコードする。
</p>
<p>デコードせずにファイルからテキストを読み込んだ後、やはりデコードすることを決心したときに使用するのが、この関数の通常の使い方である。テキストを削除して再度読み込むかわりに、この関数を呼び出せばデコードして読み込むことができる。
</p></dd></dl>




</body>
</html>
