<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 24.5.

Copyright (C) 1990-1996, 1998-2015 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document under
the terms of the GNU Free Documentation License, Version 1.3 or any later
version published by the Free Software Foundation; with the Invariant
Sections being "GNU General Public License," with the Front-Cover Texts
being "A GNU Manual," and with the Back-Cover Texts as in (a) below.  A
copy of the license is included in the section entitled "GNU Free
Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and modify
this GNU manual.  Buying copies from the FSF supports it in developing GNU
and promoting software freedom." -->
<!-- Created by GNU Texinfo 6.7, http://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>24.8.4 ファイル名を展開する関数 (GNU Emacs Lisp Reference Manual)</title>

<meta name="description" content="24.8.4 ファイル名を展開する関数 (GNU Emacs Lisp Reference Manual)">
<meta name="keywords" content="24.8.4 ファイル名を展開する関数 (GNU Emacs Lisp Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html" rel="start" title="Emacs Lisp">
<link href="Index.html" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="File-Names.html" rel="up" title="24.8 ファイルの名前">
<link href="Unique-File-Names.html" rel="next" title="24.8.5 一意なファイル名の生成">
<link href="Directory-Names.html" rel="prev" title="24.8.3 ディレクトリーの名前">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en">
<span id="File-Name-Expansion"></span><div class="header">
<p>
Next: <a href="Unique-File-Names.html" accesskey="n" rel="next">Unique File Names</a>, Previous: <a href="Directory-Names.html" accesskey="p" rel="prev">Directory Names</a>, Up: <a href="File-Names.html" accesskey="u" rel="up">File Names</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<span id="huairuMing-woZhan-Kai-suruGuan-Shu-"></span><h4 class="subsection">24.8.4 ファイル名を展開する関数</h4>
<span id="index-expansion-of-file-names"></span>

<p>ファイル名の<em>展開(expanding)</em>とは、相対ファイル名を絶対ファイル名に変換することを意味します。これはデフォルトディレクトリーから相対的に行われるため、展開されるファイル名と同様、デフォルトディレクトリーも指定しなければなりません。これは<samp>~/</samp>のような省略形
(<a href="Directory-Names.html#abbreviate_002dfile_002dname">abbreviate-file-name</a>を参照)、
の展開、および<samp>./</samp>や<samp><var>name</var>/../</samp>のような冗長さの排除も行います。
も展開します。
</p>
<dl>
<dt id="index-expand_002dfile_002dname">Function: <strong>expand-file-name</strong> <em>filename &amp;optional directory</em></dt>
<dd><p>この関数は、<var>filename</var>を絶対ファイル名に変換する。<var>directory</var>が与えられた場合、<var>filename</var>が相対的なら、それは開始点となるデフォルトディレクトリーになる(<var>directory</var>の値は、それ自体が絶対ディレクトリー名、またはディレクトリーファイル名であるべきで、それは&lsquo;<samp>~</samp>&rsquo;で始まるかもしれない)。それ以外では、カレントバッファーの<code>default-directory</code>の値が使用される。たとえば:
</p>
<div class="example">
<pre class="example">(expand-file-name &quot;foo&quot;)
     &rArr; &quot;/xcssun/users/rms/lewis/foo&quot;
</pre><pre class="example">(expand-file-name &quot;../foo&quot;)
     &rArr; &quot;/xcssun/users/rms/foo&quot;
</pre><pre class="example">(expand-file-name &quot;foo&quot; &quot;/usr/spool/&quot;)
     &rArr; &quot;/usr/spool/foo&quot;
</pre></div>

<p>結合されたファイル名の最初のスラッシュの前が&lsquo;<samp>~</samp>&rsquo;の場合は、環境変数<code>HOME</code>(通常はユーザーのホームディレクトリー)の値に展開される。最初のスラッシュの前が&lsquo;<samp>~<var>user</var></samp>&rsquo;で、かつ<var>user</var>が有効なログイン名の場合は、<var>user</var>のホームディレクトリーに展開される。
</p>
<p>&lsquo;<samp>.</samp>&rsquo;または&lsquo;<samp>..</samp>&rsquo;を含むファイル名は、正規化形式に簡略化される:
</p>
<div class="example">
<pre class="example">(expand-file-name &quot;bar/../foo&quot;)
     &rArr; &quot;/xcssun/users/rms/lewis/foo&quot;
</pre></div>

<p>出力に&lsquo;<samp>..</samp>&rsquo;コンポーネントが残り得る場合もある:
</p>
<div class="example">
<pre class="example">(expand-file-name &quot;../home&quot; &quot;/&quot;)
     &rArr; &quot;/../home&quot;
</pre></div>

<p>これは、ルートディレクトリー<samp>/</samp>の上位の&ldquo;スーパールート(superroot)&rdquo;という概念をもつファイルシステムのためのものである。その他のファイルシステムでは、<samp>/../</samp>は<samp>/</samp>とまったく同じに解釈される。
</p>
<p><code>expand-file-name</code>は環境変数を展開<em>しない</em>ことに注意。<code>substitute-in-file-name</code>だけが、それを行う。
</p>
<div class="example">
<pre class="example">(expand-file-name &quot;$HOME/foo&quot;)
     &rArr; &quot;/xcssun/users/rms/lewis/$HOME/foo&quot;
</pre></div>

<p><code>expand-file-name</code>は、あらゆる階層においてシンボリックリンクをフォローしないことにも注意。これは&lsquo;<samp>..</samp>&rsquo;の扱いが<code>file-truename</code>と<code>expand-file-name</code>で異なることに起因する。&lsquo;<samp>/tmp/bar</samp>&rsquo;がディレクトリー&lsquo;<samp>/tmp/foo/bar</samp>&rsquo;にたいするシンボリックリンクであると仮定すると:
</p>
<div class="example">
<pre class="example">(file-truename &quot;/tmp/bar/../myfile&quot;)
     &rArr; &quot;/tmp/foo/myfile&quot;
</pre><pre class="example">(expand-file-name &quot;/tmp/bar/../myfile&quot;)
     &rArr; &quot;/tmp/myfile&quot;
</pre></div>

<p>直接間接を問わず、事前に<code>expand-file-name</code>を呼び出さずに&lsquo;<samp>..</samp>&rsquo;に先行するシンボリックリンクをフォローする必要があるかもしれない場合は、それを呼び出さずに確実に<code>file-truename</code>を呼び出すべきである。<a href="Truenames.html">本当の名前</a>を参照のこと。
</p></dd></dl>

<dl>
<dt id="index-default_002ddirectory">Variable: <strong>default-directory</strong></dt>
<dd><p>このバッファーローカル変数の値は、カレントバッファーにたいするデフォルトディレクトリーである。これは絶対ディレクトリー名であること。これは&lsquo;<samp>~</samp>&rsquo;で始まるかもしれない。この変数は、すべてのバッファーにおいてバッファーローカルである。
</p>
<p>2つ目の引数が<code>nil</code>の場合、<code>expand-file-name</code>はデフォルトディレクトリーを使用する。
</p>
<p>値は常にスラッシュで終わる文字列である。
</p>
<div class="example">
<pre class="example">default-directory
     &rArr; &quot;/user/lewis/manual/&quot;
</pre></div>
</dd></dl>

<dl>
<dt id="index-substitute_002din_002dfile_002dname">Function: <strong>substitute-in-file-name</strong> <em>filename</em></dt>
<dd><span id="Definition-of-substitute_002din_002dfile_002dname"></span><p>この関数は、<var>filename</var>内で参照される環境変数を、環境変数の値に置き換える。標準的なUnixシェル構文にしたがい、
&lsquo;<samp>$</samp>&rsquo;は環境変数値置き換えのプレフィックスである。入力に&lsquo;<samp>$$</samp>&rsquo;が含まれる場合、それ&lsquo;<samp>$</samp>&rsquo;に置き換えられる。これにより、ユーザーが&lsquo;<samp>$</samp>&rsquo;を&ldquo;クォート&rdquo;する手段が与えられる。
</p>
<p>環境変数名は&lsquo;<samp>$</samp>&rsquo;の後に続く一連の英数字(アンダースコアを含む)である。&lsquo;<samp>$</samp>&rsquo;の後続文字が、&lsquo;<samp>{</samp>&rsquo;の場合はマッチする&lsquo;<samp>}</samp>&rsquo;までのすべてが変数名である。
</p>
<p><code>substitute-in-file-name</code>により生成された出力で<code>substitute-in-file-name</code>を呼び出すと、不正な結果となる傾向がある。たとえば、単一の&lsquo;<samp>$</samp>&rsquo;をクォートするための&lsquo;<samp>$$</samp>&rsquo;の使用は正しく機能しないだろうし、環境変数値の中の&lsquo;<samp>$</samp>&rsquo;は再帰的な置換を導くだろう。したがって、この関数を呼び出して、出力をこの関数に渡すプログラムは、その後の不正な結果を防ぐために、すべての&lsquo;<samp>$</samp>&rsquo;文字を二重化する必要がある。
</p>
<p>以下では、ユーザーのホームディレクトリー名を保持する環境変数<code>HOME</code>は、値&lsquo;<samp>/xcssun/users/rms</samp>&rsquo;をもつとする。
</p>
<div class="example">
<pre class="example">(substitute-in-file-name &quot;$HOME/foo&quot;)
     &rArr; &quot;/xcssun/users/rms/foo&quot;
</pre></div>

<p>置き換え後は、&lsquo;<samp>/</samp>&rsquo;の直後に&lsquo;<samp>~</samp>&rsquo;や別の&lsquo;<samp>/</samp>&rsquo;が出現した場合、この関数は、&lsquo;<samp>/</samp>&rsquo;の前にあるすべてを無視する。
</p>
<div class="example">
<pre class="example">(substitute-in-file-name &quot;bar/~/foo&quot;)
     &rArr; &quot;~/foo&quot;
</pre><pre class="example">(substitute-in-file-name &quot;/usr/local/$HOME/foo&quot;)
     &rArr; &quot;/xcssun/users/rms/foo&quot;
     ;; <span class="roman"><samp>/usr/local/</samp>は破棄された</span>
</pre></div>

</dd></dl>




</body>
</html>
