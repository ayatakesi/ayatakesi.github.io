<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 26.3.

Copyright (C) 1990-1996, 1998-2019 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document under
the terms of the GNU Free Documentation License, Version 1.3 or any later
version published by the Free Software Foundation; with the Invariant
Sections being "GNU General Public License," with the Front-Cover Texts
being "A GNU Manual," and with the Back-Cover Texts as in (a) below.  A
copy of the license is included in the section entitled "GNU Free
Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and modify
this GNU manual.  Buying copies from the FSF supports it in developing GNU
and promoting software freedom." -->
<!-- Created by GNU Texinfo 6.6, http://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>11.4.4 Destructuring with pcase Patterns (GNU Emacs Lisp Reference Manual)</title>

<meta name="description" content="11.4.4 Destructuring with pcase Patterns (GNU Emacs Lisp Reference Manual)">
<meta name="keywords" content="11.4.4 Destructuring with pcase Patterns (GNU Emacs Lisp Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Emacs Lisp">
<link href="Index.html#Index" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Pattern_002dMatching-Conditional.html#Pattern_002dMatching-Conditional" rel="up" title="11.4 Pattern-Matching Conditional">
<link href="Iteration.html#Iteration" rel="next" title="11.5 繰り返し">
<link href="Backquote-Patterns.html#Backquote-Patterns" rel="prev" title="11.4.3 Backquote-Style Patterns">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en">
<span id="Destructuring-with-pcase-Patterns"></span><div class="header">
<p>
Previous: <a href="Backquote-Patterns.html#Backquote-Patterns" accesskey="p" rel="prev">Backquote Patterns</a>, Up: <a href="Pattern_002dMatching-Conditional.html#Pattern_002dMatching-Conditional" accesskey="u" rel="up">Pattern-Matching Conditional</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html#Index" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<span id="Destructuring-with-pcase-Patterns-1"></span><h4 class="subsection">11.4.4 Destructuring with <code>pcase</code> Patterns</h4>
<span id="index-destructuring-with-pcase-patterns"></span>

<p>Pcase patterns not only express a condition on the form of the objects they
can match, but they can also extract sub-fields of those objects.  For
example we can extract 2 elements from a list that is the value of the
variable <code>my-list</code> with the following code:
</p>
<div class="example">
<pre class="example">  (pcase my-list
    (`(add ,x ,y)  (message &quot;Contains %S and %S&quot; x y)))
</pre></div>

<p>This will not only extract <code>x</code> and <code>y</code> but will additionally test
that <code>my-list</code> is a list containing exactly 3 elements and whose first
element is the symbol <code>add</code>.  If any of those tests fail, <code>pcase</code>
will immediately return <code>nil</code> without calling <code>message</code>.
</p>
<p>Extraction of multiple values stored in an object is known as
<em>destructuring</em>.  Using <code>pcase</code> patterns allows to perform
<em>destructuring binding</em>, which is similar to a local binding
(see section <a href="Local-Variables.html#Local-Variables">ローカル変数</a>), but gives values to multiple elements of a
variable by extracting those values from an object of compatible structure.
</p>
<p>The macros described in this section use <code>pcase</code> patterns to perform
destructuring binding.  The condition of the object to be of compatible
structure means that the object must match the pattern, because only then
the object&rsquo;s subfields can be extracted.  For example:
</p>
<div class="example">
<pre class="example">  (pcase-let ((`(add ,x ,y) my-list))
    (message &quot;Contains %S and %S&quot; x y))
</pre></div>

<p>does the same as the previous example, except that it directly tries to
extract <code>x</code> and <code>y</code> from <code>my-list</code> without first verifying if
<code>my-list</code> is a list which has the right number of elements and has
<code>add</code> as its first element.  The precise behavior when the object does
not actually match the pattern is undefined, although the body will not be
silently skipped: either an error is signaled or the body is run with some
of the variables potentially bound to arbitrary values like <code>nil</code>.
</p>
<p>The pcase patterns that are useful for destructuring bindings are generally
those described in <a href="Backquote-Patterns.html#Backquote-Patterns">Backquote-Style Patterns</a>, since they express a
specification of the structure of objects that will match.
</p>
<p>For an alternative facility for destructuring binding, see <a href="Sequence-Functions.html#seq_002dlet">seq-let</a>.
</p>
<dl>
<dt id="index-pcase_002dlet">Macro: <strong>pcase-let</strong> <em>bindings body&hellip;</em></dt>
<dd><p>Perform destructuring binding of variables according to <var>bindings</var>, and
then evaluate <var>body</var>.
</p>
<p><var>bindings</var> is a list of bindings of the form <code>(<var>pattern</var>&nbsp;<var>exp</var>)</code><!-- /@w -->, where <var>exp</var> is an expression to evaluate and <var>pattern</var>
is a <code>pcase</code> pattern.
</p>
<p>All <var>exp</var>s are evaluated first, after which they are matched against
their respective <var>pattern</var>, introducing new variable bindings that can
then be used inside <var>body</var>.  The variable bindings are produced by
destructuring binding of elements of <var>pattern</var> to the values of the
corresponding elements of the evaluated <var>exp</var>.
</p></dd></dl>

<dl>
<dt id="index-pcase_002dlet_002a">Macro: <strong>pcase-let*</strong> <em>bindings body&hellip;</em></dt>
<dd><p>Perform destructuring binding of variables according to <var>bindings</var>, and
then evaluate <var>body</var>.
</p>
<p><var>bindings</var> is a list of bindings of the form <code>(<var>pattern</var>
<var>exp</var>)</code>, where <var>exp</var> is an expression to evaluate and <var>pattern</var>
is a <code>pcase</code> pattern.  The variable bindings are produced by
destructuring binding of elements of <var>pattern</var> to the values of the
corresponding elements of the evaluated <var>exp</var>.
</p>
<p>Unlike <code>pcase-let</code>, but similarly to <code>let*</code>, each <var>exp</var> is
matched against its corresponding <var>pattern</var> before processing the next
element of <var>bindings</var>, so the variable bindings introduced in each one
of the <var>bindings</var> are available in the <var>exp</var>s of the <var>bindings</var>
that follow it, additionally to being available in <var>body</var>.
</p></dd></dl>

<dl>
<dt id="index-pcase_002ddolist">Macro: <strong>pcase-dolist</strong> <em>(pattern list) body&hellip;</em></dt>
<dd><p>Execute <var>body</var> once for each element of <var>list</var>, on each iteration
performing a destructuring binding of variables in <var>pattern</var> to the
values of the corresponding subfields of the element of <var>list</var>.  The
bindings are performed as if by <code>pcase-let</code>.  When <var>pattern</var> is a
simple variable, this ends up being equivalent to <code>dolist</code>
(see section <a href="Iteration.html#Iteration">繰り返し</a>).
</p></dd></dl>


<hr>
<div class="header">
<p>
Previous: <a href="Backquote-Patterns.html#Backquote-Patterns" accesskey="p" rel="prev">Backquote Patterns</a>, Up: <a href="Pattern_002dMatching-Conditional.html#Pattern_002dMatching-Conditional" accesskey="u" rel="up">Pattern-Matching Conditional</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html#Index" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
