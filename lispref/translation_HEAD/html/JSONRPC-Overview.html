<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 6.8, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 30.0.50.

Copyright (C) 1990-1996, 1998-2024 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document under
the terms of the GNU Free Documentation License, Version 1.3 or any later
version published by the Free Software Foundation; with the Invariant
Sections being "GNU General Public License," with the Front-Cover Texts
being "A GNU Manual," and with the Back-Cover Texts as in (a) below.  A
copy of the license is included in the section entitled "GNU Free
Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and modify
this GNU manual.  Buying copies from the FSF supports it in developing GNU
and promoting software freedom." -->
<title>JSONRPC Overview (GNU Emacs Lisp Reference Manual)</title>

<meta name="description" content="JSONRPC Overview (GNU Emacs Lisp Reference Manual)">
<meta name="keywords" content="JSONRPC Overview (GNU Emacs Lisp Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2any">
<meta name="date" content="May 3, 2024">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Index.html" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="JSONRPC.html" rel="up" title="JSONRPC">
<link href="Process_002dbased-JSONRPC-connections.html" rel="next" title="Process-based JSONRPC connections">
<style type="text/css">
<!--
a.copiable-anchor {visibility: hidden; text-decoration: none; line-height: 0em}
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
span:hover a.copiable-anchor {visibility: visible}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en">
<div class="subsection" id="JSONRPC-Overview">
<div class="header">
<p>
Next: <a href="Process_002dbased-JSONRPC-connections.html" accesskey="n" rel="next">プロセスベースのJSONRPC接続</a>, Up: <a href="JSONRPC.html" accesskey="u" rel="up">JSONRPCによる対話</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<span id="Gai-Guan-"></span><h4 class="subsection">33.32.1 概観</h4>

<p><a href="https://www.jsonrpc.org/">spec</a>から引用するとJSONRPCは、&quot;同一プロセス、ソケットやhttp、多くのさまざまなメッセージパッシング環境において使用可能という概念においてトランスポート非依存&quot;です。
</p>
<span id="index-jsonrpc_002dconnection"></span>
<p>この非依存性をモデル化するために、<code>jsonrpc</code>ライブラリーはリモートのJSONのエンドポイントへの接続の表現に<code>jsonrpc-connection</code>クラスのオブジェクトを使用します(Emacsのオブジェクトシステムの詳細は<a data-manual="eieio" href="https://www.gnu.org/software/emacs/manual/html_node/eieio/index.html#Top">EIEIO</a> in <cite>EIEIO</cite>を参照)。これはオブジェクト指向の現代的な用語では&ldquo;抽象的(abstract)&rdquo;なクラス、すなわち有用な接続オブジェクトの実クラスは常に<code>jsonrpc-connection</code>のサブクラスになります。それにも関わらず、<code>jsonrpc-connection</code>クラスを中心に2つのAPIを個別に定義できます。
</p>
<span id="index-JSONRPC-application-interfaces"></span>
<ol>
<li> An API for building JSONRPC applications

<span id="index-_003arequest_002ddispatcher"></span>
<span id="index-_003anotification_002ddispatcher"></span>
<span id="index-jsonrpc_002dnotify"></span>
<span id="index-jsonrpc_002drequest"></span>
<span id="index-jsonrpc_002dasync_002drequest"></span>
<p>In this scenario, a new aspiring JSONRPC-based application selects a
concrete subclass of <code>jsonrpc-connection</code> that provides the transport
for the JSONRPC messages to be exchanged between endpoints.
</p>
<p>The application creates objects of that subclass using
<code>make-instance</code>.  To initiate a contact to a remote endpoint, the
application passes this object to the functions such as
<code>jsonrpc-notify</code>, <code>jsonrpc-request</code>, or
<code>jsonrpc-async-request</code>.
</p>
<p>For handling remotely initiated contacts, which generally come in
asynchronously, the <code>make-instance</code> instantiation should initialize it
the <code>:request-dispatcher</code> and <code>:notification-dispatcher</code> EIEIO
keyword arguments.  These are both functions of 3 arguments: the connection
object; a symbol naming the JSONRPC method invoked remotely; and a JSONRPC
<code>params</code> object.
</p>
<span id="index-jsonrpc_002derror"></span>
<p>The function passed as <code>:request-dispatcher</code> is responsible for
handling the remote endpoint&rsquo;s requests, which expect a reply from the local
endpoint (in this case, the application you&rsquo;re building).  Inside that
function, you may either return locally (a regular return)  or non-locally
(throw an error).  Both exits from the request dispatcher cause a reply to
the remote endpoint&rsquo;s request to be sent through the transport.
</p>
<p>A regular return determines a success response, and the return value must be
a Lisp object that can be serialized as JSON (see <a href="Parsing-JSON.html">JSON値の解析と生成</a>).  The
result is forwarded to the server as the JSONRPC <code>result</code> object.  A
non-local return, achieved by calling the function <code>jsonrpc-error</code>,
causes an error response to be sent to the server.  The details of the
accompanying JSONRPC <code>error</code> object are filled out with whatever was
passed to <code>jsonrpc-error</code>.  A non-local return triggered by an
unexpected error of any other type also causes an error response to be sent
(unless you have set <code>debug-on-error</code>, in which case this calls the
Lisp debugger, see <a href="Error-Debugging.html">エラーによるデバッガへのエンター</a>).
</p>
<span id="index-jsonrpc_002dconvert_002dto_002dendpoint"></span>
<span id="index-jsonrpc_002dconvert_002dfrom_002dendpoint"></span>
<p>It&rsquo;s possible to use the <code>jsonrpc</code> library to build applications based
on transport protocols that can be described as &ldquo;quasi-JSONRPC&rdquo;.  These
are similar, but not quite identical to JSONRPC, such as the
<a href="https://www.jsonrpc.org/">DAP (Debug Adapter Protocol)</a>.  These
protocols also define request, response and notification messages but the
format is not quite the same as JSONRPC.  The generic functions
<code>jsonrpc-convert-to-endpoint</code> and <code>jsonrpc-convert-from-endpoint</code>
can be customized for converting between the internal representation of
JSONRPC and whatever the endpoint accepts (see <a href="Generic-Functions.html">ジェネリック関数</a>).
</p>
</li><li> An API for building JSONRPC transports

<p>In this scenario, <code>jsonrpc-connection</code> is sub-classed to implement a
different underlying transport strategy (for details on how to subclass, see
<a data-manual="eieio" href="https://www.gnu.org/software/emacs/manual/html_node/eieio/Inheritance.html#Inheritance">(eieio)Inheritance</a>.).  Users of the application-building
interface can then instantiate objects of this concrete class (using the
<code>make-instance</code> function) and connect to JSONRPC endpoints using that
strategy.  See <a href="Process_002dbased-JSONRPC-connections.html">プロセスベースのJSONRPC接続</a> for a built-in
transport implementation.
</p>
<p>このAPIには必須部分とオプション部分がある。
</p>
<span id="index-jsonrpc_002dconnection_002dsend"></span>
<p>To allow its users to initiate JSONRPC contacts (notifications or requests)
or reply to endpoint requests, the new transport implementation must equip
the <code>jsonrpc-connection-send</code> generic function with a specialization
for the the new subclass (see <a href="Generic-Functions.html">ジェネリック関数</a>).  This generic function
is called automatically by primitives such as <code>jsonrpc-request</code> and
<code>jsonrpc-notify</code>.  The specialization should ensure that the message
described in the argument list is sent through whatever underlying
communication mechanism (a.k.a. &ldquo;wire&rdquo;) is used by the new transport to
talk to endpoints.  This &ldquo;wire&rdquo; may be a network socket, a serial
interface, an HTTP connection, etc.
</p>
<span id="index-jsonrpc_002dconnection_002dreceive"></span>
<p>Likewise, for handling the three types of remote contacts (requests,
notifications, and responses to local requests), the transport
implementation must arrange for the function
<code>jsonrpc-connection-receive</code> to be called from Elisp after noticing
some data on the &ldquo;wire&rdquo; that can be used to craft a JSONRPC (or
quasi-JSONRPC) message.
</p>
<span id="index-jsonrpc_002dshutdown"></span>
<span id="index-jsonrpc_002drunning_002dp"></span>
<p>Finally, and optionally, the <code>jsonrpc-connection</code> subclass should add
specializations to the <code>jsonrpc-shutdown</code> and <code>jsonrpc-running-p</code>
generic functions if these concepts apply to the transport.  The
specialization of <code>jsonrpc-shutdown</code> should ensure the release of any
system resources (e.g. processes, timers, etc.) used to listen for
messages on the wire.  The specialization of <code>jsonrpc-running-p</code> should
tell if these resources are still active or have already been released (via
<code>jsonrpc-shutdown</code> or otherwise).
</p>
</li></ol>

</div>
<hr>
<div class="header">
<p>
Next: <a href="Process_002dbased-JSONRPC-connections.html">プロセスベースのJSONRPC接続</a>, Up: <a href="JSONRPC.html">JSONRPCによる対話</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>


This page has generated for branch:work/master_4078d0fd3ee9e55c3da219aa6e7788ac6130697b, commit:c7db2a384198d0c98b496ec88317efbf77a2fb57 to check Japanese translation.
</body>
</html>
