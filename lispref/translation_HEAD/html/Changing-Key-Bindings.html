<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 6.8, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 27.1.

Copyright (C) 1990-1996, 1998-2022 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document under
the terms of the GNU Free Documentation License, Version 1.3 or any later
version published by the Free Software Foundation; with the Invariant
Sections being "GNU General Public License," with the Front-Cover Texts
being "A GNU Manual," and with the Back-Cover Texts as in (a) below.  A
copy of the license is included in the section entitled "GNU Free
Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and modify
this GNU manual.  Buying copies from the FSF supports it in developing GNU
and promoting software freedom." -->
<title>Changing Key Bindings (GNU Emacs Lisp Reference Manual)</title>

<meta name="description" content="Changing Key Bindings (GNU Emacs Lisp Reference Manual)">
<meta name="keywords" content="Changing Key Bindings (GNU Emacs Lisp Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2any">
<meta name="date" content="August 20, 2023">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Index.html" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Keymaps.html" rel="up" title="Keymaps">
<link href="Low_002dLevel-Key-Binding.html" rel="next" title="Low-Level Key Binding">
<link href="Functions-for-Key-Lookup.html" rel="prev" title="Functions for Key Lookup">
<style type="text/css">
<!--
a.copiable-anchor {visibility: hidden; text-decoration: none; line-height: 0em}
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
span:hover a.copiable-anchor {visibility: visible}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en">
<div class="section" id="Changing-Key-Bindings">
<div class="header">
<p>
Next: <a href="Low_002dLevel-Key-Binding.html" accesskey="n" rel="next">Low-Level Key Binding</a>, Previous: <a href="Functions-for-Key-Lookup.html" accesskey="p" rel="prev">キー照合のための関数</a>, Up: <a href="Keymaps.html" accesskey="u" rel="up">キーマップ</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<span id="kibaindeingunoBian-Geng-"></span><h3 class="section">23.12 キーバインディングの変更</h3>
<span id="index-changing-key-bindings"></span>
<span id="index-rebinding"></span>

<p>The way to rebind a key is to change its entry in a keymap.  If you change a
binding in the global keymap, the change is effective in all buffers (though
it has no direct effect in buffers that shadow the global binding with a
local one).  If you change the current buffer&rsquo;s local map, that usually
affects all buffers using the same major mode.  The <code>keymap-global-set</code>
and <code>keymap-local-set</code> functions are convenient interfaces for these
operations (see <a href="Key-Binding-Commands.html">キーのバインドのためのコマンド</a>).  You can also use
<code>keymap-set</code>, a more general function; then you must explicitly specify
the map to change.
</p>
<p>Lispプログラムでリバインドするキーシーケンスを選択するときは、さまざまなキーの使用についてのEmacsの慣習にしたがってください(<a href="Key-Binding-Conventions.html">キーバインディング規約</a>を参照)。
</p>
<p>The functions below signal an error if <var>keymap</var> is not a keymap, or if
<var>key</var> is not a valid key.
</p>
<p><var>key</var> is a string representing a single key or a series of key strokes.
Key strokes are separated by a single space character.
</p>
<p>Each key stroke is either a single character, or the name of an event,
surrounded by angle brackets.  In addition, any key stroke may be preceded
by one or more modifier keys.  Finally, a limited number of characters have
a special shorthand syntax.  Here&rsquo;s some example key sequences:
</p>
<dl compact="compact">
<dt><span><kbd>f</kbd></span></dt>
<dd><p>The key <kbd>f</kbd>.
</p>
</dd>
<dt><span><kbd>S o m</kbd></span></dt>
<dd><p>A three key sequence of the keys <kbd>S</kbd>, <kbd>o</kbd> and <kbd>m</kbd>.
</p>
</dd>
<dt><span><kbd>C-c o</kbd></span></dt>
<dd><p>A two key sequence of the keys <kbd>c</kbd> with the control modifier and then
the key <kbd>o</kbd>
</p>
</dd>
<dt><span><kbd>H-&lt;left&gt;</kbd></span></dt>
<dd><p>The key named <kbd>left</kbd> with the hyper modifier.
</p>
</dd>
<dt><span><kbd>M-RET</kbd></span></dt>
<dd><p>The <kbd>return</kbd> key with a meta modifier.
</p>
</dd>
<dt><span><kbd>C-M-&lt;space&gt;</kbd></span></dt>
<dd><p>The <kbd>space</kbd> key with both the control and meta modifiers.
</p></dd>
</dl>

<p>The only keys that have a special shorthand syntax are <kbd>NUL</kbd>, <kbd>RET</kbd>,
<kbd>TAB</kbd>, <kbd>LFD</kbd>, <kbd>ESC</kbd>, <kbd>SPC</kbd> and <kbd>DEL</kbd>.
</p>
<p>The modifiers have to be specified in alphabetical order:
&lsquo;<samp>A-C-H-M-S-s</samp>&rsquo;, which is &lsquo;<samp>Alt-Control-Hyper-Meta-Shift-super</samp>&rsquo;.
</p>
<dl class="def">
<dt id="index-keymap_002dset"><span class="category">Function: </span><span><strong>keymap-set</strong> <em>keymap key binding</em><a href='#index-keymap_002dset' class='copiable-anchor'> &para;</a></span></dt>
<dd><p>This function sets the binding for <var>key</var> in <var>keymap</var>.  (If <var>key</var>
is more than one event long, the change is actually made in another keymap
reached from <var>keymap</var>.)  The argument <var>binding</var> can be any Lisp
object, but only certain types are meaningful.  (For a list of meaningful
types, see <a href="Key-Lookup.html">キーの照合</a>.)  The value returned by <code>keymap-set</code> is
<var>binding</var>.
</p>
<p>If <var>key</var> is <kbd>&lt;t&gt;</kbd>, this sets the default binding in <var>keymap</var>.
When an event has no binding of its own, the Emacs command loop uses the
keymap&rsquo;s default binding, if there is one.
</p>
<span id="index-invalid-prefix-key-error"></span>
<span id="index-key-sequence-error"></span>
<p>Every prefix of <var>key</var> must be a prefix key (i.e., bound to a keymap)  or
undefined; otherwise an error is signaled.  If some prefix of <var>key</var> is
undefined, then <code>keymap-set</code> defines it as a prefix key so that the
rest of <var>key</var> can be defined as specified.
</p>
<p>前に<var>keymap</var>内で<var>key</var>にたいするバインディングが存在しなければ、新たなバインディングが<var>keymap</var>の先頭に追加される。キーマップ内のバインディングの順序はキーボード入力にたいし影響を与えないが、メニューキーマップにたいしては問題となる(<a href="Menu-Keymaps.html">メニューキーアップ</a>を参照)。
</p></dd></dl>

<p>以下はsparseキーマップを作成してその中にバインディングをいくつか作成する例:
</p>
<div class="example">
<pre class="example">(setq map (make-sparse-keymap))
    &rArr; (keymap)
</pre><pre class="example">(keymap-set map &quot;C-f&quot; 'forward-char)
    &rArr; forward-char
</pre><pre class="example">map
    &rArr; (keymap (6 . forward-char))
</pre><pre class="example">

</pre><pre class="example">;; <span class="roman">Build sparse submap for <kbd>C-x</kbd> and bind <kbd>f</kbd> in that.</span>
(keymap-set map &quot;C-x f&quot; 'forward-word)
    &rArr; forward-word
</pre><pre class="example">map
&rArr; (keymap
    (24 keymap                ; <kbd>C-x</kbd>
        (102 . forward-word)) ;      <kbd>f</kbd>
    (6 . forward-char))       ; <kbd>C-f</kbd>
</pre><pre class="example">

</pre><pre class="example">;; <span class="roman">Bind <kbd>C-p</kbd> to the <code>ctl-x-map</code>.</span>
(keymap-set map &quot;C-p&quot; ctl-x-map)
;; <code>ctl-x-map</code>
&rArr; [nil &hellip; find-file &hellip; backward-kill-sentence]
</pre><pre class="example">

</pre><pre class="example">;; <span class="roman">Bind <kbd>C-f</kbd> to <code>foo</code> in the <code>ctl-x-map</code>.</span>
(keymap-set map &quot;C-p C-f&quot; 'foo)
&rArr; 'foo
</pre><pre class="example">map
&rArr; (keymap     ; <span class="roman"><code>ctl-x-map</code>内の<code>foo</code>に注目</span>
    (16 keymap [nil &hellip; foo &hellip; backward-kill-sentence])
    (24 keymap
        (102 . forward-word))
    (6 . forward-char))
</pre></div>

<p><kbd>C-p
C-f</kbd>にたいする新たなバインディングの格納は、実際には<code>ctl-x-map</code>内のエントリーを変更することによって機能し、これはデフォルトグローバルマップ内の<kbd>C-p
C-f</kbd>と<kbd>C-x C-f</kbd>の両方のバインディングを変更する効果をもつことに注意。
</p>
<p><code>keymap-set</code> is the general work horse for defining a key in a keymap.
When writing modes, however, you frequently have to bind a large number of
keys at once, and using <code>keymap-set</code> on them all can be tedious and
error-prone.  Instead you can use <code>define-keymap</code>, which creates a
keymap and binds a number of keys.  See <a href="Creating-Keymaps.html">キーマップの作成</a>, for details.
</p>
<p>関数<code>substitute-key-definition</code>はキーマップから特定のバインディングをもつキーをスキャンして、それらを異なるバインディングにリバインドする。より明快かつ多くの場合には同じ結果を生成できる他の機能として、あるコマンドから別のコマンドへのリマップがある(<a href="Remapping-Commands.html">コマンドのリマップ</a>を参照)。
</p>
<dl class="def">
<dt id="index-substitute_002dkey_002ddefinition"><span class="category">Function: </span><span><strong>substitute-key-definition</strong> <em>olddef newdef keymap &amp;optional oldmap</em><a href='#index-substitute_002dkey_002ddefinition' class='copiable-anchor'> &para;</a></span></dt>
<dd><span id="index-replace-bindings"></span>
<p>この関数は<var>keymap</var>内で<var>olddef</var>にバインドされるすべてのキーについて<var>olddef</var>を<var>newdef</var>に置き換える。言い換えると<var>olddef</var>が出現する箇所のすべてを<var>newdef</var>に置き換える。この関数は<code>nil</code>をリターンする。
</p>
<p>たとえば以下をEmacsの標準バインディングで行うと<kbd>C-x C-f</kbd>を再定義する:
</p>
<div class="example">
<pre class="example">(substitute-key-definition
 'find-file 'find-file-read-only (current-global-map))
</pre></div>

<p><var>oldmap</var>が非<code>nil</code>なら、どのキーをリバインドするかを<var>oldmap</var>内のバインディングが決定するように<code>substitute-key-definition</code>の動作を変更する。リバインディングは依然として<var>oldmap</var>ではなく<var>keymap</var>で発生する。したがって他のマップ内のバインディングの制御下でマップを変更することができる。たとえば、
</p>
<div class="example">
<pre class="example">(substitute-key-definition
  'delete-backward-char 'my-funny-delete
  my-map global-map)
</pre></div>

<p>これは標準的な削除コマンドにグローバルにバインドされたキーにたいして<code>my-map</code>内の特別な削除コマンドを設定する。
</p>
<p>以下はキーマップの置き換え(substitution)の前後を示した例:
</p>
<div class="example">
<pre class="example">(setq map (list 'keymap
                (cons ?1 olddef-1)
                (cons ?2 olddef-2)
                (cons ?3 olddef-1)))
&rArr; (keymap (49 . olddef-1) (50 . olddef-2) (51 . olddef-1))
</pre><pre class="example">

</pre><pre class="example">(substitute-key-definition 'olddef-1 'newdef map)
&rArr; nil
</pre><pre class="example">map
&rArr; (keymap (49 . newdef) (50 . olddef-2) (51 . newdef))
</pre></div>
</dd></dl>

<dl class="def">
<dt id="index-suppress_002dkeymap"><span class="category">Function: </span><span><strong>suppress-keymap</strong> <em>keymap &amp;optional nodigits</em><a href='#index-suppress_002dkeymap' class='copiable-anchor'> &para;</a></span></dt>
<dd><span id="index-self_002dinsert_002dcommand-override"></span>
<p>この関数は<code>self-insert-command</code>をコマンド<code>undefined</code>にリマップ(<a href="Remapping-Commands.html">コマンドのリマップ</a>を参照)することによってfullキーマップのコンテンツを変更する。これはすべてのプリント文字を未定義にする効果をもつので、通常のテキスト挿入は不可能になる。<code>suppress-keymap</code>は<code>nil</code>をリターンする。
</p>
<p><var>nodigits</var>が<code>nil</code>なら、<code>suppress-keymap</code>は数字が<code>digit-argument</code>、<kbd>-</kbd>が<code>negative-argument</code>を実行するように定義する。それ以外は残りのプリント文字と同じように、それらの文字も未定義にする。
</p>
<span id="index-yank-suppression"></span>
<span id="index-quoted_002dinsert-suppression"></span>
<p><code>suppress-keymap</code>関数は<code>yank</code>や<code>quoted-insert</code>のようなコマンドを抑制(suppress)しないのでバッファーの変更は可能。バッファーの変更を防ぐには、バッファーを読み取り専用(read-only)にすること(<a href="Read-Only-Buffers.html">読み取り専用のバッファー</a>を参照)。
</p>
<p>この関数は<var>keymap</var>を変更するので、通常は新たに作成したキーマップにたいして使用するだろう。他の目的のために使用されている既存のキーマップに操作を行うと恐らくトラブルの原因となる。たとえば<code>global-map</code>の抑制はEmacsをほとんど使用不可能にするだろう。
</p>
<p>この関数はテキストの挿入が望ましくないメジャーモードの、ローカルキーマップ初期化に使用され得る。しかしそのようなモードは通常は<code>special-mode</code>
(<a href="Basic-Major-Modes.html">基本的なメジャーモード</a>を参照)から継承される。この場合にはそのモードのキーマップは既に抑制済みの<code>special-mode-map</code>から自動的に受け継がれる。以下に<code>special-mode-map</code>が定義される方法を示す:
</p>
<div class="example">
<pre class="example">(defvar special-mode-map
  (let ((map (make-sparse-keymap)))
    (suppress-keymap map)
    (keymap-set map &quot;q&quot; 'quit-window)
    &hellip;
    map))
</pre></div>
</dd></dl>

</div>
<hr>
<div class="header">
<p>
Next: <a href="Low_002dLevel-Key-Binding.html">Low-Level Key Binding</a>, Previous: <a href="Functions-for-Key-Lookup.html">キー照合のための関数</a>, Up: <a href="Keymaps.html">キーマップ</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>


This page has generated for branch:master, commit:c2f360590be0d0fece220bd6d307fd58dcd5263e to check Japanese translation.
</body>
</html>
