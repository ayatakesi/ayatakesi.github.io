<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 6.8, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 30.0.60.

Copyright (C) 1990-1996, 1998-2024 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document under
the terms of the GNU Free Documentation License, Version 1.3 or any later
version published by the Free Software Foundation; with the Invariant
Sections being "GNU General Public License," with the Front-Cover Texts
being "A GNU Manual," and with the Back-Cover Texts as in (a) below.  A
copy of the license is included in the section entitled "GNU Free
Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and modify
this GNU manual.  Buying copies from the FSF supports it in developing GNU
and promoting software freedom." -->
<title>X Selections (GNU Emacs Lisp Reference Manual)</title>

<meta name="description" content="X Selections (GNU Emacs Lisp Reference Manual)">
<meta name="keywords" content="X Selections (GNU Emacs Lisp Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2any">
<meta name="date" content="August 25, 2024">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Index.html" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Accessing-Selections.html" rel="up" title="Accessing Selections">
<link href="Other-Selections.html" rel="next" title="Other Selections">
<style type="text/css">
<!--
a.copiable-anchor {visibility: hidden; text-decoration: none; line-height: 0em}
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
span:hover a.copiable-anchor {visibility: visible}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en">
<div class="subsection" id="X-Selections">
<div class="header">
<p>
Next: <a href="Other-Selections.html" accesskey="n" rel="next">その他の選択</a>, Up: <a href="Accessing-Selections.html" accesskey="u" rel="up">選択へのアクセス</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<span id="XXuan-Ze-"></span><h4 class="subsection">30.22.1 X選択</h4>

<p>Xは選択データにたいする固定化されたデータタイプの定義と選択の個数の固定化を控えてきました。選択は文字列名にたいしてXサーバーが発行する29ビットの一意な識別子である、Xの&ldquo;アトム(atom)&rdquo;によって識別されます。この複雑さはEmacsにより隠蔽されています。アトムの名前と同じ名前のシンボルをLispが提供すると、Emacsはそれ以上の介入を行わずにそれらの識別子を要求するのです。
</p>
<p>Xであるプログラムが選択を&ldquo;セット&rdquo;したとき、Xは実際にはそのプログラムを選択の&ldquo;オーナー(owner:
所有者)&rdquo;にします。それからXサーバーがプログラムに選択リクエストを送信します。プログラムは選択データを要求したクライアントに応答する義務があります。
</p>
<p>同様にプログラムがXサーバーから選択データを&ldquo;ゲット&rdquo;するのではなく、プログラムの選択リクエストはその選択にたいして最後に所有権を表明したウィンドウとともに、データへのリクエストにたいして応答が期待されるクライアントに送信されるのです。
</p>
<p>選択にたいするリクエストにはそれぞれ3つのパラメーターが組み込まれています:
</p>
<ul>
<li> 選択をリクエストした、リクエスト元となるプログラム(<em>リクエスター(requestor)</em>とも呼ばれる)を識別するウィンドウ。

</li><li> <em>ターゲット(target)</em>、すなわち所有者が変換を要する選択を識別するアトム。変換ターゲットとはリクエスターが望むデータの種類と考えるのが一番簡単であろう。lEmacsがリクエストした選択では、<code>gui-get-selection</code>の<var>type</var>引数によってターゲットが判断される。

</li><li> リクエスターが最後に入力を受信した時点でのXサーバー時刻を表す32ビットタイムスタンプ。これはLispコードとは無関係であり、Xサーバー、所有者、リクエスター間での同期をうながすことだけが目的のパラメーター。
</li></ul>

<p>選択の所有者は一連のバイト、32ビットワード、およびそれらのワードタイプを識別する別のアトムをリクエスターに転送することによって応答を行います。選択のリクエスト後に、選択の所有者が転送したデータをLisp表現(<code>gui-get-selection</code>がリターン)に変換するために、Emacsがデータフォーマットとデータタイプに独自の解釈を適用します。
</p>
<p>Emacsは一連の任意のバイトから構成される選択データを、それらのバイトを保持するユニバイト文字列に変換します。このユニバイト文字列は符号なし数値として単一の16ビットまたは32ビットのワードから構成され、さらに符号なし数値のベクターとして複数のそのようなワードから構成されます。この一般的なパターンの例外として、以下の変換ターゲットからのデータにたいして、Emacsは特別な扱いをほどこします:
</p>
<dl compact="compact">
<dt><span><code>INTEGER</code></span></dt>
<dd><p>このタイプの16ビットまたは32ビットのワードは、符号なし整数ではなく符号つき整数として扱われる。選択データに複数のワードがあればベクター、それ以外はその整数自体をリターンする。
</p>
</dd>
<dt><span><code>ATOM</code></span></dt>
<dd><p>このタイプの32ビットのワードはXアトムとして扱われて、その名前がアトムを識別するようなLispシンボル(単独またはベクター)としてリターンされる。無効なアトムは<code>nil</code>に置き換えられる。
</p>
</dd>
<dt><span><code>COMPOUND_TEXT</code></span></dt>
<dt><span><code>UTF8_STRING</code></span></dt>
<dt><span><code>STRING</code></span></dt>
<dd><p>選択データのタイプにセットされた単一の<code>foreign-selection</code>テキストプロパティは、それらのデータタイプへのリクエストを継承するユニバイト文字列に配置される。
</p></dd>
</dl>

<p>選択の所有者はそれぞれ少なくとも2つの選択ターゲットをリターンしなければなりません。1つ目はその所有者がサポートする選択データを記述するアトムの個数である<code>TARGETS</code>、2つ目は内部的な目的のためにXクライアントが使用する<code>MULTIPLE</code>です。選択の所有者は任意の個数の他のターゲットをサポートでき、それらの一部はXコンソーシアム(<a href="http://x.org/releases/X11R7.6/doc/xorg-docs/specs/ICCCM/icccm.html">Inter-Client Communication Conventions
Manual</a>)によって標準化されているかもしれないし、他の<code>UTF8_STRING</code>のようなターゲットについてはXFree86プロジェクトによって標準化されるはずでした(しかしその標準化が完了することはなかった)。
</p>
<p>慣例により特定の選択ターゲットへのリクエストは特定のタイプ、あるいはいくつかのタイプのいずれか(選択の所有者にとって一番都合がいいタイプ)がリターンされるかもしれません。後者の選択ターゲットのタイプについては<em>ポリモーフィックターゲット(polymorphic
target:
多様ターゲット)</em>と呼ばれています。あるリクエストへの応答において０，選択ターゲットがデータを何もリターンしないこともあり得ます。その後に副作用として選択の所有者は何らかのアクションを実行します。したがってこのように応答されるターゲットは<em>副作用ターゲット(side-effect
targets)</em>と呼ばれます。
</p>
<p>以下は<code>CLIPBOARD</code>、<code>PRIMARY</code>、<code>SECONDARY</code>のターゲットからのリクエスト時には標準とおおむね一貫性のある挙動を示す選択ターゲットの一部です。
</p>
<dl compact="compact">
<dt><span><code>ADOBE_PORTABLE_DOCUMENT_FORMAT</code></span></dt>
<dd><p>このターゲットはAdobe Systemの&ldquo;PDF(Portable Document
Format)&rdquo;のフォーマットのデータを文字列としてリターンする。
</p>
</dd>
<dt><span><code>APPLE_PICT</code></span></dt>
<dd><p>このターゲットはMacintoshコンピューターで用いられている&ldquo;PICT&rdquo;イメージフォーマットのデータを文字列としてリターンする。
</p>
</dd>
<dt><span><code>BACKGROUND</code></span></dt>
<dt><span><code>BITMAP</code></span></dt>
<dt><span><code>COLORMAP</code></span></dt>
<dt><span><code>FOREGROUND</code></span></dt>
<dd><p>これらビットマップのバックグラウンドカラーのピクセル値、ビットマップのX識別子、バックグラウンドとフォアグラウンドが割り当てられたカラーマップ、ビットマップのフォアグラウンドカラーのピクセル値という4つのターゲットは、組み合わせられてXサーバーに格納されたビットマップイメージを使用するために必要な整数をリターンする。
</p>
</dd>
<dt><span><code>CHARACTER_POSITION</code></span></dt>
<dd><p>このターゲットは選択データを含むテキストフィールドで選択データの開始と終了の位置(単位はバイト)を記述するタイプ<code>SPAN</code>の2つの32ビット符号なし整数をリターンする。
</p>
</dd>
<dt><span><code>COMPOUND_TEXT</code></span></dt>
<dd><p>このターゲットはXコンソーシアムのマルチバイトエンコーディングシステムのタイプ<code>COMPOUND_TEXT</code>の文字列をリターンする。
</p>
</dd>
<dt><span><code>DELETE</code></span></dt>
<dd><p>このターゲットは何もリターンしないが、副作用として選択を含んだテキストフィールドから選択のコンテンツを削除する。
</p>
</dd>
<dt><span><code>DRAWABLE</code></span></dt>
<dt><span><code>PIXMAP</code></span></dt>
<dd><p>このターゲットはそれぞれがXサーバーのdrawableかpixmapに相当する符号なし32ビット整数のリストをリターンする。
</p>
</dd>
<dt><span><code>ENCAPSULATED_POSTSCRIPT</code></span></dt>
<dt><span><code>_ADOBE_EPS</code></span></dt>
<dd><p>このターゲットはEPS(Encapsulated Postscript)のコードを含む文字列をリターンする。
</p>
</dd>
<dt><span><code>FILE_NAME</code></span></dt>
<dd><p>このターゲットはNULL文字で区切られた1つ以上のファイル名を含む文字列をリターンする。
</p>
</dd>
<dt><span><code>HOST_NAME</code></span></dt>
<dd><p>このターゲットは選択の所有者が実行されているマシンのFQDN(Fully-Qualified Domain Name:
完全修飾ドメイン名)を含む文字列をリターンする。
</p>
</dd>
<dt><span><code>USER</code></span></dt>
<dd><p>このターゲットは選択の所有者が実行されているマシンのユーザー名を含む文字列をリターンする。
</p>
</dd>
<dt><span><code>LENGTH</code></span></dt>
<dd><p>。このターゲットは選択データの長さを含む32ビットまたは16ビットの符号なし整数をリターンする。
</p>
</dd>
<dt><span><code>LINE_NUMBER</code></span></dt>
<dd><p>このターゲットは選択データを含むテキストフィールド内における選択データの開始と終了の位置に相当する行番号を記述するタイプ<code>SPAN</code>の2つの32ビット符号なし整数をリターンする。
</p>
</dd>
<dt><span><code>MODULE</code></span></dt>
<dd><p>このターゲットは選択データを含むすべての関数の名前をリターンする。主にテキストエディターによってリクエストされる。
</p>
</dd>
<dt><span><code>STRING</code></span></dt>
<dd><p>このターゲットは選択データをISO Latin-1フォーマット、Unix改行のタイプ<code>STRING</code>の文字列としてリターンする。
</p>
</dd>
<dt><span><code>C_STRING</code></span></dt>
<dd><p>このターゲットは選択データを&ldquo;C文字列&rdquo;としてリターンする。これは何であれ所有者が用いているエンコーディングによるNULL終端された、あるいはまったく終端されていない、または終端されているいないに関わらずASCII文字列のいずれかであるようなraw選択データを意味すると解釈される。
</p>
</dd>
<dt><span><code>UTF8_STRING</code></span></dt>
<dd><p>これは選択データをUTF-8,でエンコードされたEOLフォーマット未指定のタイプ<code>UTF8_STRING</code>の文字列としてリターンする。
</p>
</dd>
<dt><span><code>TIMESTAMP</code></span></dt>
<dd><p>このターゲットは選択にたいして所有者が所有権を得た際のXサーバータイムスタンプを16ビットまたは32ビットのタイプ<code>CARDINAL</code>のワードとしてリターンする。
</p>
</dd>
<dt><span><code>TEXT</code></span></dt>
<dd><p>このポリモーフィックターゲットは選択データを<code>COMPOUND_TEXT</code>、<code>STRING</code>、<code>C_STRING</code>、<code>UTF8_STRING</code>のいずれかから何であれ選択の所有者にとって都合がいいデータタイプの文字列としてとしてリターンする。
</p></dd>
</dl>

<p><code>selection-coding-system</code>および<code>next-selection-coding-system</code>がどちらもセットされておらず関数<code>gui-get-selection</code>を用いてターゲット<code>STRING</code>、<code>COMPOUND_TEXT</code>、<code>UTF8_STRING</code>へのリクエストを作成すると結果となる文字列はそれぞれ<code>iso-8859-1</code>、<code>compound-text-with-extensions</code>、<code>utf-8</code>という正しいコーディングシステムによってデコードされます。
</p>
<p>上述のターゲット(およびさまざまなプログラムが独自の用途に用いる多くのターゲット)に加えて、いくつかの著名なプログラムやツールキットが適切なX標準化団体との対話なしで独自に選択データタイプを定義しています。これらのターゲットは一般的に<code>text/html</code>や<code>image/jpeg</code>のようなMIMEタイプに習って命名されており、以下のデータ形式をリターンすることが目撃されてきました:
</p>
<ul>
<li> 未終端、改行終端、NULL文字終端されたイメージまたはテキストのファイルのファイル名。

</li><li> 適当なフォーマットのイメージまたはテキストのデータ。

</li><li> 適当なフォーマットでファイルを識別する<code>file://</code>のURI(またはおそらく改行かNULLで終端されたURIリスト)。
</li></ul>

<p>これらの選択ターゲットを最初に使用したのはNetscapeでしたが、現在ではあらゆる種類のプログラムが提供しており、それらは特にGTK+またはQtツールキットの最近のバージョンにもとづいています。
</p>
<p>Emacsには選択の所有者としての役割りを果たす能力もあります。<code>gui-set-selection</code>が呼び出されると提供される選択データは内部的に記録されて、Emacsはセットされる選択の所有権を取得します。
</p>
<dl class="def">
<dt id="index-selection_002dconverter_002dalist"><span class="category">Variable: </span><span><strong>selection-converter-alist</strong><a href='#index-selection_002dconverter_002dalist' class='copiable-anchor'> &para;</a></span></dt>
<dd><p>選択ターゲットから&ldquo;選択コンバーター(selection
converter)&rdquo;となる関数へのalist。選択リクエストを受信すると、Emacsはリクエストされた選択ターゲットに関連する選択コンバーターを検索する。
</p>
<p>選択コンバーターはリクエストされた選択を識別するアトムに相当するシンボル、リクエストされた選択ターゲット、<code>gui-set-selection</code>でセットする値という3つの引数で呼び出される。選択コンバーターはデータタイプと個数を示すシンボルのコンス、シンボル、数値かシンボルのベクター、またはそのようなコンスのcdrのいずれかをリターンしなければならない。
</p>
<p>選択コンバーターの値が特別なシンボル<code>NULL</code>の場合にはリクエスターにリターンされるデータタイプは<code>NULL</code>にセットされて、応答には何のデータも送信されない。
</p>
<p>値が文字列の場合には、ユニバイト文字列でなければならない。データタイプを明示的に指定しなければ、リクエスターにはタイプ<code>STRING</code>でデータは転送される。
</p>
<p>値がシンボルならその値の&ldquo;アトム&rdquo;が取得されて、リクエスターには32ビット値(データタイプが指定されていなければタイプは<code>ATOM</code>)として転送される。
</p>
<p><code>-32769</code>から<code>32768</code>の間の数値の場合には、リクエスターには16ビット値(データタイプが指定されていなければタイプは<code>INTEGER</code>)として転送される。
</p>
<p>上記以外の数値なら32ビット値とみなされる。たとえ符号なしの数値がリターンされても、リクエスターがタイプ<code>INTEGER</code>のワードを符号つきとして扱うだろう。符号なしの値をリターンするには、そこでタイプ<code>CARDINAL</code>を指定すること。
</p>
<p>値がシンボルか数値のベクターの場合には、リクエスターへの応答は複数のアトムか数値からなるリストになる。リターンされるデータタイプが明示的に指定されていなければ、リストの最初の要素のデータタイプ。
</p></dd></dl>

<p>デフォルトでは、Emacsは以下の選択ターゲットにたいしてセコンバーターを構成します:
</p>
<dl compact="compact">
<dt><span><code>TEXT</code></span></dt>
<dd><p>この選択コンバーターは以下のように選択データをリターンする:
</p>
<ul>
<li> 選択コンテンツがマルチバイトを含まない、あるいは&ldquo;8ビットrawバイトバイト&rdquo;(<a href="Text-Representations.html">テキストの表現方法</a>を参照)を含む場合にはタイプ<code>C_STRING</code>の文字列。

</li><li> 選択コンテンツがISO-Latin-1テキストとして表現可能ならタイプ<code>STRING</code>の文字列。

</li><li> 選択コンテンツがXコンソーシアムのCompound Text
Encodingでエンコードでき、<code>selection-coding-system</code>か<code>next-selection-coding-system</code>が<code>:mime-charset</code>プロパティに<code>x-ctext</code>をもつコーディングシステムにセットされていれば、タイプ<code>COMPOUND_TEXT</code>の文字列。

</li><li> 上記以外ならタイプ<code>UTF8_STRING</code>の文字列。
</li></ul>

</dd>
<dt><span><code>COMPOUND_TEXT</code></span></dt>
<dd><p>この選択コンバーターは選択データをタイプ<code>COMPOUND_TEXT</code>の文字列としてリターンする。
</p>
</dd>
<dt><span><code>STRING</code></span></dt>
<dd><p>この選択コンバーターは選択データをISO-Latin-1フォーマットでエンコードされたタイプ<code>STRING</code>の文字列としてリターンする。
</p>
</dd>
<dt><span><code>UTF8_STRING</code></span></dt>
<dd><p>この選択コンバーターは選択データをUTF-8フォーマットでリターンする。
</p>
</dd>
<dt><span><code>text/plain</code></span></dt>
<dt><span><code>text/plain;charset=utf-8</code></span></dt>
<dt><span><code>text/uri-list</code></span></dt>
<dt><span><code>text/x-xdnd-username</code></span></dt>
<dt><span><code>XmTRANSFER_SUCCESS</code></span></dt>
<dt><span><code>XmTRANSFER_FAILURE</code></span></dt>
<dt><span><code>FILE</code></span></dt>
<dt><span><code>_DT_NETFILE</code></span></dt>
<dd><p>これらはドラッグアンドドロップ操作中に内部の用途にたいして使用される選択コンバーターであり、<code>XdndSelection</code>以外の選択にたいしては利用できない。
</p>
</dd>
<dt><span><code>TARGETS</code></span></dt>
<dd><p>この選択コンバーターは、Emacsが理解できる選択ターゲットごとに1つずつアトムのリストをリターンする。
</p>
</dd>
<dt><span><code>MULTIPLE</code></span></dt>
<dd><p>この選択コンバーターはCコードで実装されており、同時に複数の選択ターゲットを指定する選択リクエストの転送を効果的に実装するために用いられる。
</p>
</dd>
<dt><span><code>LENGTH</code></span></dt>
<dd><p>この選択コンバーターは選択データの長さをバイト単位でリターンする。
</p>
</dd>
<dt><span><code>DELETE</code></span></dt>
<dd><p>この選択コンバーターはドラッグアンドドロップ操作中に内部的な用途のために使用される。
</p>
</dd>
<dt><span><code>FILE_NAME</code></span></dt>
<dd><p>この選択コンバーターは選択データを含むバッファーのファイル名をリターンする。
</p>
</dd>
<dt><span><code>CHARACTER_POSITION</code></span></dt>
<dd><p>この選択コンバーターは選択データを含むバッファー内の選択の終了それぞれの文字位置をリターンする。
</p>
</dd>
<dt><span><code>LINE_NUMBER</code></span></dt>
<dt><span><code>COLUMN_NUMBER</code></span></dt>
<dd><p>この選択コンバーターは選択データを含むバッファー内の選択の終了それぞれの行番号、または列番号をリターンする。
</p>
</dd>
<dt><span><code>OWNER_OS</code></span></dt>
<dd><p>この選択コンバーターはEmacsを実行中のオペレーティングシステムの名前をリターンする。
</p>
</dd>
<dt><span><code>HOST_NAME</code></span></dt>
<dd><p>この選択コンバーターはEmacsを実行中のマシンのFQDN(完全修飾ドメイン名)をリターンする。
</p>
</dd>
<dt><span><code>USER</code></span></dt>
<dd><p>この選択コンバーターは実行中のEmacsのユーザーアカウントのユーザー名をリターンする。
</p>
</dd>
<dt><span><code>CLASS</code></span></dt>
<dt><span><code>NAME</code></span></dt>
<dd><p>この選択コンバーターはEmacsが使用しているリソースのクラスまたは名前をリターンする。
</p>
</dd>
<dt><span><code>INTEGER</code></span></dt>
<dd><p>この選択コンバーター文字通り整数値をリターンする。
</p>
</dd>
<dt><span><code>SAVE_TARGETS</code></span></dt>
<dt><span><code>_EMACS_INTERNAL</code></span></dt>
<dd><p>これらの選択コンバーターは内部的な用途のために用いられる。
</p></dd>
</dl>

<p><code>INTEGER</code>を除いたすべての選択コンバーターは次のいずれかのデータが<code>gui-set-selection</code>に提供されることを期待します:
</p>
<ul>
<li> 文字列。

</li><li> <code>(<var>beg</var>&nbsp;<var>end</var>&nbsp;<var>buf</var>)</code><!-- /@w -->という形式のフォーム。ここで<var>beg</var>と<var>end</var>はバッファー<var>buf</var>において選択データの境界を記述するマーカーかオーバーレイ。
</li></ul>

</div>
<hr>
<div class="header">
<p>
Next: <a href="Other-Selections.html">その他の選択</a>, Up: <a href="Accessing-Selections.html">選択へのアクセス</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>


This page has generated for branch:work/emacs-30_0a626a64c70e6842027d58dd2b52776d864cedb2, commit:8db8a49b3c34a06228192a7775535ce12eed30da to check Japanese translation.
</body>
</html>
