<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- This is the GNU Emacs Lisp Reference Manual
corresponding to Emacs version 27.1.

Copyright (C) 1990-1996, 1998-2022 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document under
the terms of the GNU Free Documentation License, Version 1.3 or any later
version published by the Free Software Foundation; with the Invariant
Sections being "GNU General Public License," with the Front-Cover Texts
being "A GNU Manual," and with the Back-Cover Texts as in (a) below.  A
copy of the license is included in the section entitled "GNU Free
Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and modify
this GNU manual.  Buying copies from the FSF supports it in developing GNU
and promoting software freedom." -->
<!-- Created by GNU Texinfo 6.7, http://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Suspicious Text (GNU Emacs Lisp Reference Manual)</title>

<meta name="description" content="Suspicious Text (GNU Emacs Lisp Reference Manual)">
<meta name="keywords" content="Suspicious Text (GNU Emacs Lisp Reference Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2any">
<meta name="date" content="November 30, 2022">
<link href="index.html" rel="start" title="Top">
<link href="Index.html" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Text.html" rel="up" title="Text">
<link href="GnuTLS-Cryptography.html" rel="next" title="GnuTLS Cryptography">
<link href="Checksum_002fHash.html" rel="prev" title="Checksum/Hash">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en">
<span id="Suspicious-Text"></span><div class="header">
<p>
Next: <a href="GnuTLS-Cryptography.html" accesskey="n" rel="next">GnuTLS Cryptography</a>, Previous: <a href="Checksum_002fHash.html" accesskey="p" rel="prev">Checksum/Hash</a>, Up: <a href="Text.html" accesskey="u" rel="up">Text</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<span id="Suspicious-Text-1"></span><h3 class="section">33.27 Suspicious Text</h3>
<span id="index-suspicious-text"></span>
<span id="index-insecure-text"></span>
<span id="index-security-vulnerabilities-in-text"></span>

<p>Emacs can display text from many external sources, like email and Web
sites.  Attackers may attempt to confuse the user reading this text by using
obfuscated <acronym>URL</acronym>s or email addresses, and tricking the user into
visiting a web page they didn&rsquo;t intend to visit, or sending an email to the
wrong address.
</p>
<p>This usually involves using characters from scripts that visually look like
<acronym>ASCII</acronym> characters (i.e., are homoglyphs), but there are also other
techniques used, like using bidirectional overrides, or having an
<acronym>HTML</acronym> link text that says one thing, while the underlying
<acronym>URL</acronym> points somewhere else.
</p>
<span id="index-suspicious-text-strings"></span>
<p>To help identify these <em>suspicious text strings</em>, Emacs provides a
library to do a number of checks on text.  (See
<a href="https://www.unicode.org/reports/tr39/">UTS #39: Unicode Security
Mechanisms</a> for the rationale behind the checks that are available and more
details about them.)  Packages that present data that might be suspicious
should use this library to flag suspicious text on display.
</p>
<span id="index-textsec_002dcheck"></span>
<dl>
<dt id="index-textsec_002dsuspicious_002dp">Function: <strong>textsec-suspicious-p</strong> <em>object type</em></dt>
<dd><p>This function is the high-level interface function that packages should
use.  It respects the <code>textsec-check</code> user option, which allows the
user to disable the checks.
</p>
<p>This function checks <var>object</var> (whose data type depends on <var>type</var>) to
see if it looks suspicious when interpreted as a thing of <var>type</var>.  The
available types and the corresponding <var>object</var> data types are:
</p>
<dl compact="compact">
<dt><code>domain</code></dt>
<dd><p>Check whether a domain (e.g., &lsquo;<samp>www.gnu.org</samp>&rsquo; looks suspicious.
<var>object</var> should be a string, the domain name.
</p>
</dd>
<dt><code>url</code></dt>
<dd><p>Check whether an <acronym>URL</acronym> (e.g., &lsquo;<samp>http://gnu.org/foo/bar</samp>&rsquo;)  looks
suspicious.  <var>object</var> should be a string, the <acronym>URL</acronym> to check.
</p>
</dd>
<dt><code>link</code></dt>
<dd><p>Check whether an <acronym>HTML</acronym> link (e.g., &lsquo;<samp>&lt;a
href='http://gnu.org'&gt;fsf.org&lt;/a&gt;</samp>&rsquo; looks suspicious.  In this case,
<var>object</var> should be a <code>cons</code> cell where the <code>car</code> is the
<acronym>URL</acronym> string, and the <code>cdr</code> is the link text.  The link is
deemed suspicious if the link text contains a domain name, and that domain
name points to something other than the <acronym>URL</acronym>.
</p>
</dd>
<dt><code>email-address</code></dt>
<dd><p>Check whether an email address (e.g., &lsquo;<samp>foo@example.org</samp>&rsquo;) looks
suspicious.  <var>object</var> should be a string.
</p>
</dd>
<dt><code>local-address</code></dt>
<dd><p>Check whether the local part of an email address (the bit before the
&lsquo;<samp>@</samp>&rsquo; sign) looks suspicious.  <var>object</var> should be a string.
</p>
</dd>
<dt><code>name</code></dt>
<dd><p>Check whether a name (used in an email address header) looks suspicious.
<var>object</var> should be a string.
</p>
</dd>
<dt><code>email-address-header</code></dt>
<dd><p>Check whether a full RFC2822 email address header (e.g.,
&lsquo;<samp>=?utf-8?Q?=C3=81?= &lt;foo@example.com&gt;</samp>&rsquo;) looks suspicious.
<var>object</var> should be a string.
</p></dd>
</dl>

<p>If <var>object</var> is suspicious, this function returns a string that explains
why it is suspicious.  If <var>object</var> is not suspicious, the function
returns <code>nil</code>.
</p></dd></dl>

<span id="index-textsec_002dsuspicious-_0028face_0029"></span>
<p>If the text is suspicious, the application should mark the suspicious text
with the <code>textsec-suspicious</code> face, and make the explanation returned
by <code>textsec-suspicious-p</code> available to the user in some way (for
example, in a tooltip).  The application might also prompt the user for
confirmation before taking any action on a suspicious string (like sending
an email to a suspicious email address).
</p>
<hr>
<div class="header">
<p>
Next: <a href="GnuTLS-Cryptography.html" accesskey="n" rel="next">GnuTLS Cryptography</a>, Previous: <a href="Checksum_002fHash.html" accesskey="p" rel="prev">Checksum/Hash</a>, Up: <a href="Text.html" accesskey="u" rel="up">Text</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html" title="Index" rel="index">Index</a>]</p>
</div>


This page has generated for branch:work/emacs-29_edd64e64a389e0f0e6ce670846d4fae79a9d8b35, commit:df3ba36a70711ee2e2a40b18e83acb402f794194 to check Japanese translation.
</body>
</html>
