<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>oldXMenu/Activate.c</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.6.7' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<a id='TOP' name='TOP'></a><h2 class='header'><a href='../mains.html'>root</a>/<a href='../files/4756.html'>oldXMenu</a>/Activate.c</h2>
<em class='comment'>/* [&lt;][&gt;]<a href='#L127'>[^]</a><a href='#L140'>[v]</a>[top]<a href='#BOTTOM'>[bottom]</a><a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</em>
<hr />
<h2 class='header'>DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href='#L127' title='Defined at 127.'>XMenuActivateSetWaitFunction</a></li>
<li><a href='#L134' title='Defined at 134.'>XMenuActivateSetTranslateFunction</a></li>
<li><a href='#L140' title='Defined at 140.'>XMenuActivate</a></li>
</ol>
<hr />
<pre>
<a id='L1' name='L1'></a>     1 <em class='comment'>/* Copyright    Massachusetts Institute of Technology    1985   */</em>
<a id='L2' name='L2'></a>     2 
<a id='L3' name='L3'></a>     3 <em class='comment'>/*</em>
<a id='L4' name='L4'></a>     4 <em class='comment'></em>
<a id='L5' name='L5'></a>     5 <em class='comment'>Copyright 1985, 1986, 1987 by the Massachusetts Institute of Technology</em>
<a id='L6' name='L6'></a>     6 <em class='comment'></em>
<a id='L7' name='L7'></a>     7 <em class='comment'>Permission to use, copy, modify, and distribute this</em>
<a id='L8' name='L8'></a>     8 <em class='comment'>software and its documentation for any purpose and without</em>
<a id='L9' name='L9'></a>     9 <em class='comment'>fee is hereby granted, provided that the above copyright</em>
<a id='L10' name='L10'></a>    10 <em class='comment'>notice appear in all copies and that both that copyright</em>
<a id='L11' name='L11'></a>    11 <em class='comment'>notice and this permission notice appear in supporting</em>
<a id='L12' name='L12'></a>    12 <em class='comment'>documentation, and that the name of M.I.T. not be used in</em>
<a id='L13' name='L13'></a>    13 <em class='comment'>advertising or publicity pertaining to distribution of the</em>
<a id='L14' name='L14'></a>    14 <em class='comment'>software without specific, written prior permission.</em>
<a id='L15' name='L15'></a>    15 <em class='comment'>M.I.T. makes no representations about the suitability of</em>
<a id='L16' name='L16'></a>    16 <em class='comment'>this software for any purpose.  It is provided "as is"</em>
<a id='L17' name='L17'></a>    17 <em class='comment'>without express or implied warranty.</em>
<a id='L18' name='L18'></a>    18 <em class='comment'></em>
<a id='L19' name='L19'></a>    19 <em class='comment'>*/</em>
<a id='L20' name='L20'></a>    20 
<a id='L21' name='L21'></a>    21 
<a id='L22' name='L22'></a>    22 
<a id='L23' name='L23'></a>    23 <em class='comment'>/*</em>
<a id='L24' name='L24'></a>    24 <em class='comment'>Copyright (C) 2001-2023 Free Software Foundation, Inc.</em>
<a id='L25' name='L25'></a>    25 <em class='comment'></em>
<a id='L26' name='L26'></a>    26 <em class='comment'>This program is free software: you can redistribute it and/or modify</em>
<a id='L27' name='L27'></a>    27 <em class='comment'>it under the terms of the GNU General Public License as published by</em>
<a id='L28' name='L28'></a>    28 <em class='comment'>the Free Software Foundation, either version 3 of the License, or (at</em>
<a id='L29' name='L29'></a>    29 <em class='comment'>your option) any later version.</em>
<a id='L30' name='L30'></a>    30 <em class='comment'></em>
<a id='L31' name='L31'></a>    31 <em class='comment'>This program is distributed in the hope that it will be useful,</em>
<a id='L32' name='L32'></a>    32 <em class='comment'>but WITHOUT ANY WARRANTY; without even the implied warranty of</em>
<a id='L33' name='L33'></a>    33 <em class='comment'>MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</em>
<a id='L34' name='L34'></a>    34 <em class='comment'>GNU General Public License for more details.</em>
<a id='L35' name='L35'></a>    35 <em class='comment'></em>
<a id='L36' name='L36'></a>    36 <em class='comment'>You should have received a copy of the GNU General Public License</em>
<a id='L37' name='L37'></a>    37 <em class='comment'>along with this program.  If not, see &lt;https://www.gnu.org/licenses/&gt;.  */</em>
<a id='L38' name='L38'></a>    38 
<a id='L39' name='L39'></a>    39 <em class='comment'>/*</em>
<a id='L40' name='L40'></a>    40 <em class='comment'> * XMenu:       MIT Project Athena, X Window system menu package</em>
<a id='L41' name='L41'></a>    41 <em class='comment'> *</em>
<a id='L42' name='L42'></a>    42 <em class='comment'> *      XMenuActivate - Maps a given menu to the display and activates</em>
<a id='L43' name='L43'></a>    43 <em class='comment'> *                      the menu for user selection.  The user is allowed to</em>
<a id='L44' name='L44'></a>    44 <em class='comment'> *                      specify which pane and selection will be current,</em>
<a id='L45' name='L45'></a>    45 <em class='comment'> *                      the X and Y location of the menu (relative to the</em>
<a id='L46' name='L46'></a>    46 <em class='comment'> *                      parent window) and the mouse button event mask that</em>
<a id='L47' name='L47'></a>    47 <em class='comment'> *                      will be used to identify a selection request.</em>
<a id='L48' name='L48'></a>    48 <em class='comment'> *</em>
<a id='L49' name='L49'></a>    49 <em class='comment'> *                      A menu selection is shown to be current by placing</em>
<a id='L50' name='L50'></a>    50 <em class='comment'> *                      a highlight box around the selection as the mouse</em>
<a id='L51' name='L51'></a>    51 <em class='comment'> *                      cursor enters its active region.  Inactive selections</em>
<a id='L52' name='L52'></a>    52 <em class='comment'> *                      will not be highlighted.  As the mouse cursor moved</em>
<a id='L53' name='L53'></a>    53 <em class='comment'> *                      from one menu pane to another menu pane the pane being</em>
<a id='L54' name='L54'></a>    54 <em class='comment'> *                      entered is raised and made current and the pane being</em>
<a id='L55' name='L55'></a>    55 <em class='comment'> *                      left is lowered.</em>
<a id='L56' name='L56'></a>    56 <em class='comment'> *</em>
<a id='L57' name='L57'></a>    57 <em class='comment'> *                      Anytime XMenuActivate returns, the p_num and</em>
<a id='L58' name='L58'></a>    58 <em class='comment'> *                      s_num are left at their last known values (i.e.,</em>
<a id='L59' name='L59'></a>    59 <em class='comment'> *                      the last known current pane and selection indices).</em>
<a id='L60' name='L60'></a>    60 <em class='comment'> *                      The following are the defined return states:</em>
<a id='L61' name='L61'></a>    61 <em class='comment'> *</em>
<a id='L62' name='L62'></a>    62 <em class='comment'> *                      1)      If at any time an error occurs the data</em>
<a id='L63' name='L63'></a>    63 <em class='comment'> *                              pointer is left untouched and XM_FAILURE</em>
<a id='L64' name='L64'></a>    64 <em class='comment'> *                              is returned.</em>
<a id='L65' name='L65'></a>    65 <em class='comment'> *</em>
<a id='L66' name='L66'></a>    66 <em class='comment'> *                      2)      When a selection request is received (i.e.,</em>
<a id='L67' name='L67'></a>    67 <em class='comment'> *                              when the specified mouse event occurs) the</em>
<a id='L68' name='L68'></a>    68 <em class='comment'> *                              data pointer will be set to the data</em>
<a id='L69' name='L69'></a>    69 <em class='comment'> *                              associated with the particular selection</em>
<a id='L70' name='L70'></a>    70 <em class='comment'> *                              current at the time of the selection request</em>
<a id='L71' name='L71'></a>    71 <em class='comment'> *                              and XM_SUCCESS is returned.</em>
<a id='L72' name='L72'></a>    72 <em class='comment'> *</em>
<a id='L73' name='L73'></a>    73 <em class='comment'> *                      3)      If no selection was current at the time a</em>
<a id='L74' name='L74'></a>    74 <em class='comment'> *                              selection request is made the data pointer</em>
<a id='L75' name='L75'></a>    75 <em class='comment'> *                              will be left untouched and XM_NO_SELECT will</em>
<a id='L76' name='L76'></a>    76 <em class='comment'> *                              be returned.</em>
<a id='L77' name='L77'></a>    77 <em class='comment'> *</em>
<a id='L78' name='L78'></a>    78 <em class='comment'> *                      4)      If the selection that was current at the time</em>
<a id='L79' name='L79'></a>    79 <em class='comment'> *                              a selection request is made is not an active</em>
<a id='L80' name='L80'></a>    80 <em class='comment'> *                              selection the data pointer will be left</em>
<a id='L81' name='L81'></a>    81 <em class='comment'> *                              untouched and XM_IA_SELECT will be returned.</em>
<a id='L82' name='L82'></a>    82 <em class='comment'> *</em>
<a id='L83' name='L83'></a>    83 <em class='comment'> *                      Since X processes events in an asynchronous manner</em>
<a id='L84' name='L84'></a>    84 <em class='comment'> *                      it is likely that XMenuActivate will encounter</em>
<a id='L85' name='L85'></a>    85 <em class='comment'> *                      a "foreign event" while it is executing.  Foreign</em>
<a id='L86' name='L86'></a>    86 <em class='comment'> *                      events are handled in one of three ways:</em>
<a id='L87' name='L87'></a>    87 <em class='comment'> *</em>
<a id='L88' name='L88'></a>    88 <em class='comment'> *                      1)      The event is discarded.  This is the default</em>
<a id='L89' name='L89'></a>    89 <em class='comment'> *                              mode and requires no action on the part of the</em>
<a id='L90' name='L90'></a>    90 <em class='comment'> *                              application.</em>
<a id='L91' name='L91'></a>    91 <em class='comment'> *</em>
<a id='L92' name='L92'></a>    92 <em class='comment'> *                      2)      The application has identified an asynchronous</em>
<a id='L93' name='L93'></a>    93 <em class='comment'> *                              event handler that will be called and the</em>
<a id='L94' name='L94'></a>    94 <em class='comment'> *                              foreign event handed off to it.  Note:</em>
<a id='L95' name='L95'></a>    95 <em class='comment'> *                              AEQ mode disables this mode temporarily.</em>
<a id='L96' name='L96'></a>    96 <em class='comment'> *</em>
<a id='L97' name='L97'></a>    97 <em class='comment'> *                      3)      The application has enabled asynchronous event</em>
<a id='L98' name='L98'></a>    98 <em class='comment'> *                              queuing mode.  In this mode all foreign events</em>
<a id='L99' name='L99'></a>    99 <em class='comment'> *                              will be queued up until XMenuActivate</em>
<a id='L100' name='L100'></a>   100 <em class='comment'> *                              terminates; at which time they will be</em>
<a id='L101' name='L101'></a>   101 <em class='comment'> *                              returned to the X event queue.  As long as</em>
<a id='L102' name='L102'></a>   102 <em class='comment'> *                              AEQ mode is enabled any asynchronous event</em>
<a id='L103' name='L103'></a>   103 <em class='comment'> *                              handler as temporarily disabled.</em>
<a id='L104' name='L104'></a>   104 <em class='comment'> *</em>
<a id='L105' name='L105'></a>   105 <em class='comment'> *                      Any events encountered while taking down the menu</em>
<a id='L106' name='L106'></a>   106 <em class='comment'> *                      (i.e., exposure events from occluded windows) will</em>
<a id='L107' name='L107'></a>   107 <em class='comment'> *                      automatically be returned to the X event queue after</em>
<a id='L108' name='L108'></a>   108 <em class='comment'> *                      XMenuActivate has cleaned the queue of any of its own</em>
<a id='L109' name='L109'></a>   109 <em class='comment'> *                      events that are no longer needed.</em>
<a id='L110' name='L110'></a>   110 <em class='comment'> *</em>
<a id='L111' name='L111'></a>   111 <em class='comment'> *      Author:         Tony Della Fera, DEC</em>
<a id='L112' name='L112'></a>   112 <em class='comment'> *                      March 12, 1986</em>
<a id='L113' name='L113'></a>   113 <em class='comment'> *</em>
<a id='L114' name='L114'></a>   114 <em class='comment'> */</em>
<a id='L115' name='L115'></a>   115 
<a id='L116' name='L116'></a>   116 <em class='sharp'>#include</em> "<a href='3773.html'>XMenuInt.h</a>"
<a id='L117' name='L117'></a>   117 <em class='sharp'>#include</em> &lt;X11/keysym.h&gt;
<a id='L118' name='L118'></a>   118 
<a id='L119' name='L119'></a>   119 <em class='comment'>/* For debug, set this to 0 to not grab the keyboard on menu popup */</em>
<a id='L120' name='L120'></a>   120 <strong class='reserved'>int</strong> x_menu_grab_keyboard = 1;
<a id='L121' name='L121'></a>   121 
<a id='L122' name='L122'></a>   122 <strong class='reserved'>static</strong> Wait_func wait_func;
<a id='L123' name='L123'></a>   123 <strong class='reserved'>static</strong> <strong class='reserved'>void</strong>* wait_data;
<a id='L124' name='L124'></a>   124 <strong class='reserved'>static</strong> Translate_func translate_func = <a href='../D/4485.html' title='Multiple defined in 11 places.'>NULL</a>;
<a id='L125' name='L125'></a>   125 
<a id='L126' name='L126'></a>   126 <strong class='reserved'>void</strong>
<a id='L127' name='L127'></a>   127 <a href='../R/6415.html' title='Multiple referred from 2 places.'>XMenuActivateSetWaitFunction</a> (Wait_func <a href='../D/11929.html' title='Multiple defined in 3 places.'>func</a>, <strong class='reserved'>void</strong> *data)
<a id='L128' name='L128'></a>   128 <em class='brace'>{</em>
<a id='L129' name='L129'></a>   129   wait_func = <a href='../D/11929.html' title='Multiple defined in 3 places.'>func</a>;
<a id='L130' name='L130'></a>   130   wait_data = data;
<a id='L131' name='L131'></a>   131 <em class='brace'>}</em>
<a id='L132' name='L132'></a>   132 
<a id='L133' name='L133'></a>   133 <strong class='reserved'>void</strong>
<a id='L134' name='L134'></a>   134 <a href='../R/6414.html' title='Multiple referred from 2 places.'>XMenuActivateSetTranslateFunction</a> (Translate_func <a href='../D/11929.html' title='Multiple defined in 3 places.'>func</a>)
<a id='L135' name='L135'></a>   135 <em class='brace'>{</em>
<a id='L136' name='L136'></a>   136   translate_func = <a href='../D/11929.html' title='Multiple defined in 3 places.'>func</a>;
<a id='L137' name='L137'></a>   137 <em class='brace'>}</em>
<a id='L138' name='L138'></a>   138 
<a id='L139' name='L139'></a>   139 <strong class='reserved'>int</strong>
<a id='L140' name='L140'></a>   140 <a href='../R/6413.html' title='Multiple referred from 4 places.'>XMenuActivate</a>(
<a id='L141' name='L141'></a>   141     <strong class='reserved'>register</strong> <a href='../D/1632.html' title='Multiple defined in 6 places.'>Display</a> *<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>,          <em class='comment'>/* Display to put menu on. */</em>
<a id='L142' name='L142'></a>   142     <strong class='reserved'>register</strong> <a href='../D/7171.html' title='Multiple defined in 2 places.'>XMenu</a> *menu,               <em class='comment'>/* Menu to activate. */</em>
<a id='L143' name='L143'></a>   143     <strong class='reserved'>int</strong> *p_num,                         <em class='comment'>/* Pane number selected. */</em>
<a id='L144' name='L144'></a>   144     <strong class='reserved'>int</strong> *s_num,                         <em class='comment'>/* Selection number selected. */</em>
<a id='L145' name='L145'></a>   145     <strong class='reserved'>int</strong> x_pos,                          <em class='comment'>/* X coordinate of menu position. */</em>
<a id='L146' name='L146'></a>   146     <strong class='reserved'>int</strong> y_pos,                          <em class='comment'>/* Y coordinate of menu position. */</em>
<a id='L147' name='L147'></a>   147     <strong class='reserved'>unsigned</strong> <strong class='reserved'>int</strong> event_mask,            <em class='comment'>/* Mouse button event mask. */</em>
<a id='L148' name='L148'></a>   148     <strong class='reserved'>char</strong> **data,                        <em class='comment'>/* Pointer to return data value. */</em>
<a id='L149' name='L149'></a>   149     <strong class='reserved'>void</strong> (*help_callback) (<strong class='reserved'>char</strong> <strong class='reserved'>const</strong> *, <strong class='reserved'>int</strong>, <strong class='reserved'>int</strong>)) <em class='comment'>/* Help callback.  */</em>
<a id='L150' name='L150'></a>   150 <em class='brace'>{</em>
<a id='L151' name='L151'></a>   151     <strong class='reserved'>int</strong> status;                         <em class='comment'>/* X routine call status. */</em>
<a id='L152' name='L152'></a>   152     <strong class='reserved'>int</strong> orig_x;                         <em class='comment'>/* Upper left menu origin X coord. */</em>
<a id='L153' name='L153'></a>   153     <strong class='reserved'>int</strong> orig_y;                         <em class='comment'>/* Upper left menu origin Y coord. */</em>
<a id='L154' name='L154'></a>   154     <strong class='reserved'>int</strong> ret_val;                        <em class='comment'>/* Return value. */</em>
<a id='L155' name='L155'></a>   155 
<a id='L156' name='L156'></a>   156     <strong class='reserved'>register</strong> <a href='../S/3790.html#L137' title='Defined at 137 in oldXMenu/XMenu.h.'>XMPane</a> *p_ptr;             <em class='comment'>/* Current XMPane. */</em>
<a id='L157' name='L157'></a>   157     <strong class='reserved'>register</strong> <a href='../S/3790.html#L137' title='Defined at 137 in oldXMenu/XMenu.h.'>XMPane</a> *event_xmp;         <em class='comment'>/* Event XMPane pointer. */</em>
<a id='L158' name='L158'></a>   158     <strong class='reserved'>register</strong> <a href='../S/3790.html#L137' title='Defined at 137 in oldXMenu/XMenu.h.'>XMPane</a> *cur_p;             <em class='comment'>/* Current pane. */</em>
<a id='L159' name='L159'></a>   159     <strong class='reserved'>register</strong> <a href='../S/3790.html#L163' title='Defined at 163 in oldXMenu/XMenu.h.'>XMSelect</a> *cur_s;           <em class='comment'>/* Current selection. */</em>
<a id='L160' name='L160'></a>   160     <a href='../S/3790.html#L113' title='Defined at 113 in oldXMenu/XMenu.h.'>XMWindow</a> *event_xmw;                <em class='comment'>/* Event XMWindow pointer. */</em>
<a id='L161' name='L161'></a>   161     XEvent event;                       <em class='comment'>/* X input event. */</em>
<a id='L162' name='L162'></a>   162     XEvent peek_event;                  <em class='comment'>/* X input peek ahead event. */</em>
<a id='L163' name='L163'></a>   163 
<a id='L164' name='L164'></a>   164     Bool <a href='../S/4023.html#L63' title='Defined at 63 in lwlib/lwlib-Xm.c.'>selection</a> = False;             <em class='comment'>/* Selection has been made. */</em>
<a id='L165' name='L165'></a>   165     Bool forward = True;                <em class='comment'>/* Moving forward in the pane list. */</em>
<a id='L166' name='L166'></a>   166 
<a id='L167' name='L167'></a>   167     <a href='../D/6888.html' title='Multiple defined in 5 places.'>Window</a> root, child;
<a id='L168' name='L168'></a>   168     <strong class='reserved'>int</strong> root_x, root_y, win_x, win_y;
<a id='L169' name='L169'></a>   169     <strong class='reserved'>unsigned</strong> <strong class='reserved'>int</strong> mask;
<a id='L170' name='L170'></a>   170     KeySym keysym;
<a id='L171' name='L171'></a>   171 
<a id='L172' name='L172'></a>   172     <em class='comment'>/*</em>
<a id='L173' name='L173'></a>   173 <em class='comment'>     * Define and allocate a foreign event queue to hold events</em>
<a id='L174' name='L174'></a>   174 <em class='comment'>     * that don't belong to XMenu.  These events are later restored</em>
<a id='L175' name='L175'></a>   175 <em class='comment'>     * to the X event queue.</em>
<a id='L176' name='L176'></a>   176 <em class='comment'>     */</em>
<a id='L177' name='L177'></a>   177     <strong class='reserved'>typedef</strong> <strong class='reserved'>struct</strong> <a href='../S/3769.html#L179' title='Referred from 179 in oldXMenu/Activate.c.'>_xmeventque</a> <em class='brace'>{</em>
<a id='L178' name='L178'></a>   178         XEvent event;
<a id='L179' name='L179'></a>   179         <strong class='reserved'>struct</strong> <a href='../S/3769.html#L177' title='Defined at 177 in oldXMenu/Activate.c.'>_xmeventque</a> *next;
<a id='L180' name='L180'></a>   180     <em class='brace'>}</em> <a href='../R/6358.html' title='Multiple referred from 5 places.'>XMEventQue</a>;
<a id='L181' name='L181'></a>   181 
<a id='L182' name='L182'></a>   182     <a href='../S/3769.html#L180' title='Defined at 180 in oldXMenu/Activate.c.'>XMEventQue</a> *feq = <a href='../D/4485.html' title='Multiple defined in 11 places.'>NULL</a>;             <em class='comment'>/* Foreign event queue. */</em>
<a id='L183' name='L183'></a>   183     <a href='../S/3769.html#L180' title='Defined at 180 in oldXMenu/Activate.c.'>XMEventQue</a> *feq_tmp;                <em class='comment'>/* Foreign event queue temporary. */</em>
<a id='L184' name='L184'></a>   184 
<a id='L185' name='L185'></a>   185     <em class='comment'>/*</em>
<a id='L186' name='L186'></a>   186 <em class='comment'>     * If there are no panes in the menu then return failure</em>
<a id='L187' name='L187'></a>   187 <em class='comment'>     * because the menu is not initialized.</em>
<a id='L188' name='L188'></a>   188 <em class='comment'>     */</em>
<a id='L189' name='L189'></a>   189     <strong class='reserved'>if</strong> (menu-&gt;p_count == 0) <em class='brace'>{</em>
<a id='L190' name='L190'></a>   190         _XMErrorCode = <a href='../S/3790.html#L54' title='Defined at 54 in oldXMenu/XMenu.h.'>XME_NOT_INIT</a>;
<a id='L191' name='L191'></a>   191         <strong class='reserved'>return</strong>(<a href='../D/7165.html' title='Multiple defined in 2 places.'>XM_FAILURE</a>);
<a id='L192' name='L192'></a>   192     <em class='brace'>}</em>
<a id='L193' name='L193'></a>   193 
<a id='L194' name='L194'></a>   194     <em class='comment'>/*</em>
<a id='L195' name='L195'></a>   195 <em class='comment'>     * Find the desired current pane.</em>
<a id='L196' name='L196'></a>   196 <em class='comment'>     */</em>
<a id='L197' name='L197'></a>   197     cur_p = <a href='../S/3760.html#L359' title='Defined at 359 in oldXMenu/Internal.c.'>_XMGetPanePtr</a>(menu, *p_num);
<a id='L198' name='L198'></a>   198     <strong class='reserved'>if</strong> (cur_p == <a href='../D/4485.html' title='Multiple defined in 11 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L199' name='L199'></a>   199         <strong class='reserved'>return</strong>(<a href='../D/7165.html' title='Multiple defined in 2 places.'>XM_FAILURE</a>);
<a id='L200' name='L200'></a>   200     <em class='brace'>}</em>
<a id='L201' name='L201'></a>   201     cur_p-&gt;activated = cur_p-&gt;active;
<a id='L202' name='L202'></a>   202 
<a id='L203' name='L203'></a>   203     <em class='comment'>/*</em>
<a id='L204' name='L204'></a>   204 <em class='comment'>     * Find the desired current selection.</em>
<a id='L205' name='L205'></a>   205 <em class='comment'>     * If the current selection index is out of range a null current selection</em>
<a id='L206' name='L206'></a>   206 <em class='comment'>     * will be assumed and the cursor will be placed in the current pane</em>
<a id='L207' name='L207'></a>   207 <em class='comment'>     * header.</em>
<a id='L208' name='L208'></a>   208 <em class='comment'>     */</em>
<a id='L209' name='L209'></a>   209     cur_s = <a href='../S/3760.html#L395' title='Defined at 395 in oldXMenu/Internal.c.'>_XMGetSelectionPtr</a>(cur_p, *s_num);
<a id='L210' name='L210'></a>   210 
<a id='L211' name='L211'></a>   211     <em class='comment'>/*</em>
<a id='L212' name='L212'></a>   212 <em class='comment'>     * Compute origin of menu so that cursor is in</em>
<a id='L213' name='L213'></a>   213 <em class='comment'>     * Correct pane and selection.</em>
<a id='L214' name='L214'></a>   214 <em class='comment'>     */</em>
<a id='L215' name='L215'></a>   215     <a href='../S/3760.html#L819' title='Defined at 819 in oldXMenu/Internal.c.'>_XMTransToOrigin</a>(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>,
<a id='L216' name='L216'></a>   216                      menu,
<a id='L217' name='L217'></a>   217                      cur_p, cur_s,
<a id='L218' name='L218'></a>   218                      x_pos, y_pos,
<a id='L219' name='L219'></a>   219                      &amp;orig_x, &amp;orig_y);
<a id='L220' name='L220'></a>   220     menu-&gt;x_pos = orig_x;       <em class='comment'>/* Store X and Y coords of menu. */</em>
<a id='L221' name='L221'></a>   221     menu-&gt;y_pos = orig_y;
<a id='L222' name='L222'></a>   222 
<a id='L223' name='L223'></a>   223     <strong class='reserved'>if</strong> (<a href='../D/7191.html' title='Multiple defined in 2 places.'>XMenuRecompute</a>(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>, menu) == <a href='../D/7165.html' title='Multiple defined in 2 places.'>XM_FAILURE</a>) <em class='brace'>{</em>
<a id='L224' name='L224'></a>   224         <strong class='reserved'>return</strong>(<a href='../D/7165.html' title='Multiple defined in 2 places.'>XM_FAILURE</a>);
<a id='L225' name='L225'></a>   225     <em class='brace'>}</em>
<a id='L226' name='L226'></a>   226 
<a id='L227' name='L227'></a>   227     <em class='comment'>/*</em>
<a id='L228' name='L228'></a>   228 <em class='comment'>     * Flush the window creation queue.</em>
<a id='L229' name='L229'></a>   229 <em class='comment'>     * This batches all window creates since lazy evaluation</em>
<a id='L230' name='L230'></a>   230 <em class='comment'>     * is more efficient than individual evaluation.</em>
<a id='L231' name='L231'></a>   231 <em class='comment'>     * This routine also does an XFlush().</em>
<a id='L232' name='L232'></a>   232 <em class='comment'>     */</em>
<a id='L233' name='L233'></a>   233     <strong class='reserved'>if</strong> (<a href='../S/3760.html#L219' title='Defined at 219 in oldXMenu/Internal.c.'>_XMWinQueFlush</a>(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>, menu, cur_p, cur_s) == <a href='../S/3773.html#L57' title='Defined at 57 in oldXMenu/XMenuInt.h.'>_FAILURE</a>) <em class='brace'>{</em>
<a id='L234' name='L234'></a>   234         <strong class='reserved'>return</strong>(<a href='../D/7165.html' title='Multiple defined in 2 places.'>XM_FAILURE</a>);
<a id='L235' name='L235'></a>   235     <em class='brace'>}</em>
<a id='L236' name='L236'></a>   236 
<a id='L237' name='L237'></a>   237     <em class='comment'>/*</em>
<a id='L238' name='L238'></a>   238 <em class='comment'>     * Make sure windows are in correct order (in case we were passed</em>
<a id='L239' name='L239'></a>   239 <em class='comment'>     * an already created menu in incorrect order.)</em>
<a id='L240' name='L240'></a>   240 <em class='comment'>     */</em>
<a id='L241' name='L241'></a>   241     <strong class='reserved'>for</strong>(p_ptr = menu-&gt;p_list-&gt;next; p_ptr != cur_p; p_ptr = p_ptr-&gt;next)
<a id='L242' name='L242'></a>   242         XRaiseWindow(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>, p_ptr-&gt;<a href='../S/314.html#L100' title='Defined at 100 in src/window.h.'>window</a>);
<a id='L243' name='L243'></a>   243     <strong class='reserved'>for</strong>(p_ptr = menu-&gt;p_list-&gt;prev; p_ptr != cur_p-&gt;prev; p_ptr = p_ptr-&gt;prev)
<a id='L244' name='L244'></a>   244         XRaiseWindow(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>, p_ptr-&gt;<a href='../S/314.html#L100' title='Defined at 100 in src/window.h.'>window</a>);
<a id='L245' name='L245'></a>   245 
<a id='L246' name='L246'></a>   246     <em class='comment'>/*</em>
<a id='L247' name='L247'></a>   247 <em class='comment'>     * Make sure all selection windows are mapped.</em>
<a id='L248' name='L248'></a>   248 <em class='comment'>     */</em>
<a id='L249' name='L249'></a>   249     <strong class='reserved'>for</strong> (
<a id='L250' name='L250'></a>   250         p_ptr = menu-&gt;p_list-&gt;next;
<a id='L251' name='L251'></a>   251         p_ptr != menu-&gt;p_list;
<a id='L252' name='L252'></a>   252         p_ptr = p_ptr-&gt;next
<a id='L253' name='L253'></a>   253     )<em class='brace'>{</em>
<a id='L254' name='L254'></a>   254         XMapSubwindows(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>, p_ptr-&gt;<a href='../S/314.html#L100' title='Defined at 100 in src/window.h.'>window</a>);
<a id='L255' name='L255'></a>   255     <em class='brace'>}</em>
<a id='L256' name='L256'></a>   256 
<a id='L257' name='L257'></a>   257     <em class='comment'>/*</em>
<a id='L258' name='L258'></a>   258 <em class='comment'>     * Synchronize the X buffers and the event queue.</em>
<a id='L259' name='L259'></a>   259 <em class='comment'>     * From here on, all events in the queue that don't belong to</em>
<a id='L260' name='L260'></a>   260 <em class='comment'>     * XMenu are sent back to the application via an application</em>
<a id='L261' name='L261'></a>   261 <em class='comment'>     * provided event handler or discarded if the application has</em>
<a id='L262' name='L262'></a>   262 <em class='comment'>     * not provided an event handler.</em>
<a id='L263' name='L263'></a>   263 <em class='comment'>     */</em>
<a id='L264' name='L264'></a>   264     <a href='../D/7282.html' title='Multiple defined in 3 places.'>XSync</a>(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>, 0);
<a id='L265' name='L265'></a>   265 
<a id='L266' name='L266'></a>   266     <em class='comment'>/*</em>
<a id='L267' name='L267'></a>   267 <em class='comment'>     * Grab the mouse for menu input.</em>
<a id='L268' name='L268'></a>   268 <em class='comment'>     */</em>
<a id='L269' name='L269'></a>   269 
<a id='L270' name='L270'></a>   270     status = XGrabPointer(
<a id='L271' name='L271'></a>   271                           <a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>,
<a id='L272' name='L272'></a>   272                           menu-&gt;<a href='../D/15229.html' title='Multiple defined in 2 places.'>parent</a>,
<a id='L273' name='L273'></a>   273                           True,
<a id='L274' name='L274'></a>   274                           event_mask,
<a id='L275' name='L275'></a>   275                           GrabModeAsync,
<a id='L276' name='L276'></a>   276                           GrabModeAsync,
<a id='L277' name='L277'></a>   277                           None,
<a id='L278' name='L278'></a>   278                           menu-&gt;<a href='../D/14594.html' title='Multiple defined in 2 places.'>mouse_cursor</a>,
<a id='L279' name='L279'></a>   279                           CurrentTime
<a id='L280' name='L280'></a>   280                           );
<a id='L281' name='L281'></a>   281     <strong class='reserved'>if</strong> (status == Success &amp;&amp; x_menu_grab_keyboard)
<a id='L282' name='L282'></a>   282       <em class='brace'>{</em>
<a id='L283' name='L283'></a>   283         status = XGrabKeyboard (<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>,
<a id='L284' name='L284'></a>   284                                 menu-&gt;<a href='../D/15229.html' title='Multiple defined in 2 places.'>parent</a>,
<a id='L285' name='L285'></a>   285                                 False,
<a id='L286' name='L286'></a>   286                                 GrabModeAsync,
<a id='L287' name='L287'></a>   287                                 GrabModeAsync,
<a id='L288' name='L288'></a>   288                                 CurrentTime);
<a id='L289' name='L289'></a>   289         <strong class='reserved'>if</strong> (status != Success)
<a id='L290' name='L290'></a>   290           XUngrabPointer(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>, CurrentTime);
<a id='L291' name='L291'></a>   291       <em class='brace'>}</em>
<a id='L292' name='L292'></a>   292 
<a id='L293' name='L293'></a>   293     <strong class='reserved'>if</strong> (status == <a href='../S/3773.html#L54' title='Defined at 54 in oldXMenu/XMenuInt.h.'>_X_FAILURE</a>) <em class='brace'>{</em>
<a id='L294' name='L294'></a>   294         _XMErrorCode = <a href='../S/3790.html#L59' title='Defined at 59 in oldXMenu/XMenu.h.'>XME_GRAB_MOUSE</a>;
<a id='L295' name='L295'></a>   295         <strong class='reserved'>return</strong>(<a href='../D/7165.html' title='Multiple defined in 2 places.'>XM_FAILURE</a>);
<a id='L296' name='L296'></a>   296     <em class='brace'>}</em>
<a id='L297' name='L297'></a>   297 
<a id='L298' name='L298'></a>   298     <em class='comment'>/*</em>
<a id='L299' name='L299'></a>   299 <em class='comment'>     * Map the menu panes.</em>
<a id='L300' name='L300'></a>   300 <em class='comment'>     */</em>
<a id='L301' name='L301'></a>   301     XMapWindow(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>, cur_p-&gt;<a href='../S/314.html#L100' title='Defined at 100 in src/window.h.'>window</a>);
<a id='L302' name='L302'></a>   302     <strong class='reserved'>for</strong> (p_ptr = menu-&gt;p_list-&gt;next;
<a id='L303' name='L303'></a>   303          p_ptr != cur_p;
<a id='L304' name='L304'></a>   304          p_ptr = p_ptr-&gt;next)
<a id='L305' name='L305'></a>   305       XMapWindow(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>, p_ptr-&gt;<a href='../S/314.html#L100' title='Defined at 100 in src/window.h.'>window</a>);
<a id='L306' name='L306'></a>   306     <strong class='reserved'>for</strong> (p_ptr = cur_p-&gt;next;
<a id='L307' name='L307'></a>   307          p_ptr != menu-&gt;p_list;
<a id='L308' name='L308'></a>   308          p_ptr = p_ptr-&gt;next)
<a id='L309' name='L309'></a>   309       XMapWindow(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>, p_ptr-&gt;<a href='../S/314.html#L100' title='Defined at 100 in src/window.h.'>window</a>);
<a id='L310' name='L310'></a>   310 
<a id='L311' name='L311'></a>   311     XRaiseWindow(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>, cur_p-&gt;<a href='../S/314.html#L100' title='Defined at 100 in src/window.h.'>window</a>);       <em class='comment'>/* Make sure current */</em>
<a id='L312' name='L312'></a>   312                                                 <em class='comment'>/* pane is on top. */</em>
<a id='L313' name='L313'></a>   313 
<a id='L314' name='L314'></a>   314     cur_s = <a href='../D/4485.html' title='Multiple defined in 11 places.'>NULL</a>;                       <em class='comment'>/* Clear current selection. */</em>
<a id='L315' name='L315'></a>   315 
<a id='L316' name='L316'></a>   316     <em class='comment'>/*</em>
<a id='L317' name='L317'></a>   317 <em class='comment'>     * Begin event processing loop.</em>
<a id='L318' name='L318'></a>   318 <em class='comment'>     */</em>
<a id='L319' name='L319'></a>   319     <strong class='reserved'>while</strong> (1) <em class='brace'>{</em>
<a id='L320' name='L320'></a>   320         <strong class='reserved'>if</strong> (wait_func) (*wait_func) (wait_data);
<a id='L321' name='L321'></a>   321         XNextEvent(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>, &amp;event);    <em class='comment'>/* Get next event. */</em>
<a id='L322' name='L322'></a>   322         <strong class='reserved'>switch</strong> (event.type) <em class='brace'>{</em>           <em class='comment'>/* Dispatch on the event type. */</em>
<a id='L323' name='L323'></a>   323     <strong class='reserved'>case</strong> Expose:
<a id='L324' name='L324'></a>   324             event_xmp = (<a href='../S/3790.html#L137' title='Defined at 137 in oldXMenu/XMenu.h.'>XMPane</a> *)<a href='../S/3763.html#L39' title='Defined at 39 in oldXMenu/XLookAssoc.c.'>XLookUpAssoc</a>(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>,
<a id='L325' name='L325'></a>   325                                                menu-&gt;assoc_tab,
<a id='L326' name='L326'></a>   326                                                event.xexpose.<a href='../S/314.html#L100' title='Defined at 100 in src/window.h.'>window</a>);
<a id='L327' name='L327'></a>   327             <strong class='reserved'>if</strong> (event_xmp == <a href='../D/4485.html' title='Multiple defined in 11 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L328' name='L328'></a>   328                 <em class='comment'>/*</em>
<a id='L329' name='L329'></a>   329 <em class='comment'>                 * If AEQ mode is enabled then queue the event.</em>
<a id='L330' name='L330'></a>   330 <em class='comment'>                 */</em>
<a id='L331' name='L331'></a>   331                 <strong class='reserved'>if</strong> (menu-&gt;aeq) <em class='brace'>{</em>
<a id='L332' name='L332'></a>   332                     feq_tmp = (<a href='../S/3769.html#L180' title='Defined at 180 in oldXMenu/Activate.c.'>XMEventQue</a> *)<a href='../D/14196.html' title='Multiple defined in 19 places.'>malloc</a>(<strong class='reserved'>sizeof</strong>(<a href='../S/3769.html#L180' title='Defined at 180 in oldXMenu/Activate.c.'>XMEventQue</a>));
<a id='L333' name='L333'></a>   333                     <strong class='reserved'>if</strong> (feq_tmp == <a href='../D/4485.html' title='Multiple defined in 11 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L334' name='L334'></a>   334                         _XMErrorCode = <a href='../S/3790.html#L61' title='Defined at 61 in oldXMenu/XMenu.h.'>XME_CALLOC</a>;
<a id='L335' name='L335'></a>   335                         <strong class='reserved'>return</strong>(<a href='../D/7165.html' title='Multiple defined in 2 places.'>XM_FAILURE</a>);
<a id='L336' name='L336'></a>   336                     <em class='brace'>}</em>
<a id='L337' name='L337'></a>   337                     feq_tmp-&gt;event = event;
<a id='L338' name='L338'></a>   338                     feq_tmp-&gt;next = feq;
<a id='L339' name='L339'></a>   339                     feq = feq_tmp;
<a id='L340' name='L340'></a>   340                 <em class='brace'>}</em>
<a id='L341' name='L341'></a>   341                 <strong class='reserved'>else</strong> <strong class='reserved'>if</strong> (_XMEventHandler) (*_XMEventHandler)(&amp;event);
<a id='L342' name='L342'></a>   342                 <strong class='reserved'>break</strong>;
<a id='L343' name='L343'></a>   343             <em class='brace'>}</em>
<a id='L344' name='L344'></a>   344             <strong class='reserved'>if</strong> (event_xmp-&gt;activated) <em class='brace'>{</em>
<a id='L345' name='L345'></a>   345                 XSetWindowBackground(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>,
<a id='L346' name='L346'></a>   346                                      event_xmp-&gt;<a href='../S/314.html#L100' title='Defined at 100 in src/window.h.'>window</a>,
<a id='L347' name='L347'></a>   347                                      menu-&gt;bkgnd_color);
<a id='L348' name='L348'></a>   348             <em class='brace'>}</em>
<a id='L349' name='L349'></a>   349             <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L350' name='L350'></a>   350                 XSetWindowBackgroundPixmap(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>,
<a id='L351' name='L351'></a>   351                                            event_xmp-&gt;<a href='../S/314.html#L100' title='Defined at 100 in src/window.h.'>window</a>,
<a id='L352' name='L352'></a>   352                                            menu-&gt;inact_pixmap);
<a id='L353' name='L353'></a>   353             <em class='brace'>}</em>
<a id='L354' name='L354'></a>   354             <a href='../S/3760.html#L880' title='Defined at 880 in oldXMenu/Internal.c.'>_XMRefreshPane</a>(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>, menu, event_xmp);
<a id='L355' name='L355'></a>   355             <strong class='reserved'>break</strong>;
<a id='L356' name='L356'></a>   356     <strong class='reserved'>case</strong> EnterNotify:
<a id='L357' name='L357'></a>   357             <em class='comment'>/*</em>
<a id='L358' name='L358'></a>   358 <em class='comment'>             * First wait a small period of time, and see</em>
<a id='L359' name='L359'></a>   359 <em class='comment'>             * if another EnterNotify event follows hard on the</em>
<a id='L360' name='L360'></a>   360 <em class='comment'>             * heels of this one. i.e., the user is simply</em>
<a id='L361' name='L361'></a>   361 <em class='comment'>             * "passing through". If so, ignore this one.</em>
<a id='L362' name='L362'></a>   362 <em class='comment'>             */</em>
<a id='L363' name='L363'></a>   363 
<a id='L364' name='L364'></a>   364             event_xmw = (<a href='../S/3790.html#L113' title='Defined at 113 in oldXMenu/XMenu.h.'>XMWindow</a> *)<a href='../S/3763.html#L39' title='Defined at 39 in oldXMenu/XLookAssoc.c.'>XLookUpAssoc</a>(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>,
<a id='L365' name='L365'></a>   365                                                  menu-&gt;assoc_tab,
<a id='L366' name='L366'></a>   366                                                  event.xcrossing.<a href='../S/314.html#L100' title='Defined at 100 in src/window.h.'>window</a>);
<a id='L367' name='L367'></a>   367             <strong class='reserved'>if</strong> (event_xmw == <a href='../D/4485.html' title='Multiple defined in 11 places.'>NULL</a>) <strong class='reserved'>break</strong>;
<a id='L368' name='L368'></a>   368             <strong class='reserved'>if</strong> (event_xmw-&gt;type == <a href='../S/3790.html#L89' title='Defined at 89 in oldXMenu/XMenu.h.'>SELECTION</a>) <em class='brace'>{</em>
<a id='L369' name='L369'></a>   369                 <em class='comment'>/*</em>
<a id='L370' name='L370'></a>   370 <em class='comment'>                 * We have entered a selection.</em>
<a id='L371' name='L371'></a>   371 <em class='comment'>                 */</em>
<a id='L372' name='L372'></a>   372                 <em class='comment'>/* if (XPending(display) == 0) usleep(150000); */</em>
<a id='L373' name='L373'></a>   373                 <strong class='reserved'>if</strong> (XPending(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>) != 0) <em class='brace'>{</em>
<a id='L374' name='L374'></a>   374                     XPeekEvent(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>, &amp;peek_event);
<a id='L375' name='L375'></a>   375                     <strong class='reserved'>if</strong>(peek_event.type == LeaveNotify) <em class='brace'>{</em>
<a id='L376' name='L376'></a>   376                         <strong class='reserved'>break</strong>;
<a id='L377' name='L377'></a>   377                     <em class='brace'>}</em>
<a id='L378' name='L378'></a>   378                 <em class='brace'>}</em>
<a id='L379' name='L379'></a>   379                 cur_s = (<a href='../S/3790.html#L163' title='Defined at 163 in oldXMenu/XMenu.h.'>XMSelect</a> *)event_xmw;
<a id='L380' name='L380'></a>   380                 help_callback (cur_s-&gt;help_string,
<a id='L381' name='L381'></a>   381                                cur_p-&gt;serial, cur_s-&gt;serial);
<a id='L382' name='L382'></a>   382 
<a id='L383' name='L383'></a>   383                 <em class='comment'>/*</em>
<a id='L384' name='L384'></a>   384 <em class='comment'>                 * If the pane we are in is active and the</em>
<a id='L385' name='L385'></a>   385 <em class='comment'>                 * selection entered is active then activate</em>
<a id='L386' name='L386'></a>   386 <em class='comment'>                 * the selection.</em>
<a id='L387' name='L387'></a>   387 <em class='comment'>                 */</em>
<a id='L388' name='L388'></a>   388                 <strong class='reserved'>if</strong> (cur_p-&gt;active &amp;&amp; cur_s-&gt;active &gt; 0) <em class='brace'>{</em>
<a id='L389' name='L389'></a>   389                     cur_s-&gt;activated = 1;
<a id='L390' name='L390'></a>   390                     <a href='../S/3760.html#L948' title='Defined at 948 in oldXMenu/Internal.c.'>_XMRefreshSelection</a>(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>, menu, cur_s);
<a id='L391' name='L391'></a>   391                 <em class='brace'>}</em>
<a id='L392' name='L392'></a>   392             <em class='brace'>}</em>
<a id='L393' name='L393'></a>   393             <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L394' name='L394'></a>   394                 <em class='comment'>/*</em>
<a id='L395' name='L395'></a>   395 <em class='comment'>                 * We have entered a pane.</em>
<a id='L396' name='L396'></a>   396 <em class='comment'>                 */</em>
<a id='L397' name='L397'></a>   397                 <em class='comment'>/* if (XPending(display) == 0) usleep(150000); */</em>
<a id='L398' name='L398'></a>   398                 <strong class='reserved'>if</strong> (XPending(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>) != 0) <em class='brace'>{</em>
<a id='L399' name='L399'></a>   399                     XPeekEvent(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>, &amp;peek_event);
<a id='L400' name='L400'></a>   400                     <strong class='reserved'>if</strong> (peek_event.type == EnterNotify) <strong class='reserved'>break</strong>;
<a id='L401' name='L401'></a>   401                 <em class='brace'>}</em>
<a id='L402' name='L402'></a>   402                 XQueryPointer(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>,
<a id='L403' name='L403'></a>   403                               menu-&gt;<a href='../D/15229.html' title='Multiple defined in 2 places.'>parent</a>,
<a id='L404' name='L404'></a>   404                               &amp;root, &amp;child,
<a id='L405' name='L405'></a>   405                               &amp;root_x, &amp;root_y,
<a id='L406' name='L406'></a>   406                               &amp;win_x, &amp;win_y,
<a id='L407' name='L407'></a>   407                               &amp;mask);
<a id='L408' name='L408'></a>   408                 event_xmp = (<a href='../S/3790.html#L137' title='Defined at 137 in oldXMenu/XMenu.h.'>XMPane</a> *)<a href='../S/3763.html#L39' title='Defined at 39 in oldXMenu/XLookAssoc.c.'>XLookUpAssoc</a>(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>,
<a id='L409' name='L409'></a>   409                                                    menu-&gt;assoc_tab,
<a id='L410' name='L410'></a>   410                                                    child);
<a id='L411' name='L411'></a>   411                 <strong class='reserved'>if</strong> (event_xmp == <a href='../D/4485.html' title='Multiple defined in 11 places.'>NULL</a>) <strong class='reserved'>break</strong>;
<a id='L412' name='L412'></a>   412                 <strong class='reserved'>if</strong> (event_xmp == cur_p) <strong class='reserved'>break</strong>;
<a id='L413' name='L413'></a>   413                 <strong class='reserved'>if</strong> (event_xmp-&gt;serial &gt; cur_p-&gt;serial) forward = True;
<a id='L414' name='L414'></a>   414                 <strong class='reserved'>else</strong> forward = False;
<a id='L415' name='L415'></a>   415                 p_ptr = cur_p;
<a id='L416' name='L416'></a>   416                 <strong class='reserved'>while</strong> (p_ptr != event_xmp) <em class='brace'>{</em>
<a id='L417' name='L417'></a>   417                     <strong class='reserved'>if</strong> (forward) p_ptr = p_ptr-&gt;next;
<a id='L418' name='L418'></a>   418                     <strong class='reserved'>else</strong> p_ptr = p_ptr-&gt;prev;
<a id='L419' name='L419'></a>   419                     XRaiseWindow(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>, p_ptr-&gt;<a href='../S/314.html#L100' title='Defined at 100 in src/window.h.'>window</a>);
<a id='L420' name='L420'></a>   420                 <em class='brace'>}</em>
<a id='L421' name='L421'></a>   421                 <strong class='reserved'>if</strong> (cur_p-&gt;activated) <em class='brace'>{</em>
<a id='L422' name='L422'></a>   422                     cur_p-&gt;activated = False;
<a id='L423' name='L423'></a>   423                     XSetWindowBackgroundPixmap(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>,
<a id='L424' name='L424'></a>   424                                                cur_p-&gt;<a href='../S/314.html#L100' title='Defined at 100 in src/window.h.'>window</a>,
<a id='L425' name='L425'></a>   425                                                menu-&gt;inact_pixmap);
<a id='L426' name='L426'></a>   426                     <a href='../S/3760.html#L880' title='Defined at 880 in oldXMenu/Internal.c.'>_XMRefreshPane</a>(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>, menu, cur_p);
<a id='L427' name='L427'></a>   427                 <em class='brace'>}</em>
<a id='L428' name='L428'></a>   428                 <strong class='reserved'>if</strong> (event_xmp-&gt;active) event_xmp-&gt;activated = True;
<a id='L429' name='L429'></a>   429 <em class='sharp'>#if</em> 1
<a id='L430' name='L430'></a>   430                 <em class='comment'>/*</em>
<a id='L431' name='L431'></a>   431 <em class='comment'>                 * i suspect the we don't get an EXPOSE event when backing</em>
<a id='L432' name='L432'></a>   432 <em class='comment'>                 * store is enabled; the menu windows content is probably</em>
<a id='L433' name='L433'></a>   433 <em class='comment'>                 * not drawn in when it should be in that case.</em>
<a id='L434' name='L434'></a>   434 <em class='comment'>                 * in that case, this is probably an ugly fix!</em>
<a id='L435' name='L435'></a>   435 <em class='comment'>                 * i hope someone more familiar with this code would</em>
<a id='L436' name='L436'></a>   436 <em class='comment'>                 * take it from here.  -- caveh@eng.sun.com.</em>
<a id='L437' name='L437'></a>   437 <em class='comment'>                 */</em>
<a id='L438' name='L438'></a>   438                 XSetWindowBackground(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>,
<a id='L439' name='L439'></a>   439                                      event_xmp-&gt;<a href='../S/314.html#L100' title='Defined at 100 in src/window.h.'>window</a>,
<a id='L440' name='L440'></a>   440                                      menu-&gt;bkgnd_color);
<a id='L441' name='L441'></a>   441                 <a href='../S/3760.html#L880' title='Defined at 880 in oldXMenu/Internal.c.'>_XMRefreshPane</a>(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>, menu, event_xmp);
<a id='L442' name='L442'></a>   442 <em class='sharp'>#endif</em>
<a id='L443' name='L443'></a>   443                 cur_p = event_xmp;
<a id='L444' name='L444'></a>   444             <em class='brace'>}</em>
<a id='L445' name='L445'></a>   445             <strong class='reserved'>break</strong>;
<a id='L446' name='L446'></a>   446     <strong class='reserved'>case</strong> LeaveNotify:
<a id='L447' name='L447'></a>   447             event_xmw = (<a href='../S/3790.html#L113' title='Defined at 113 in oldXMenu/XMenu.h.'>XMWindow</a> *)<a href='../S/3763.html#L39' title='Defined at 39 in oldXMenu/XLookAssoc.c.'>XLookUpAssoc</a>(
<a id='L448' name='L448'></a>   448                                                  <a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>,
<a id='L449' name='L449'></a>   449                                                  menu-&gt;assoc_tab,
<a id='L450' name='L450'></a>   450                                                  event.xcrossing.<a href='../S/314.html#L100' title='Defined at 100 in src/window.h.'>window</a>
<a id='L451' name='L451'></a>   451                                                  );
<a id='L452' name='L452'></a>   452             <strong class='reserved'>if</strong> (event_xmw == <a href='../D/4485.html' title='Multiple defined in 11 places.'>NULL</a>) <strong class='reserved'>break</strong>;
<a id='L453' name='L453'></a>   453             <strong class='reserved'>if</strong>(cur_s == <a href='../D/4485.html' title='Multiple defined in 11 places.'>NULL</a>) <strong class='reserved'>break</strong>;
<a id='L454' name='L454'></a>   454 
<a id='L455' name='L455'></a>   455             <em class='comment'>/*</em>
<a id='L456' name='L456'></a>   456 <em class='comment'>             * If the current selection was activated then</em>
<a id='L457' name='L457'></a>   457 <em class='comment'>             * deactivate it.</em>
<a id='L458' name='L458'></a>   458 <em class='comment'>             */</em>
<a id='L459' name='L459'></a>   459             <em class='comment'>/* Emacs specific, HELP_STRING cannot be validly NULL</em>
<a id='L460' name='L460'></a>   460 <em class='comment'>             * in the real XMenu library.  */</em>
<a id='L461' name='L461'></a>   461             help_callback (<a href='../D/4485.html' title='Multiple defined in 11 places.'>NULL</a>, cur_p-&gt;serial, cur_s-&gt;serial);
<a id='L462' name='L462'></a>   462             <strong class='reserved'>if</strong> (cur_s-&gt;activated) <em class='brace'>{</em>
<a id='L463' name='L463'></a>   463                 cur_s-&gt;activated = False;
<a id='L464' name='L464'></a>   464                 <a href='../S/3760.html#L948' title='Defined at 948 in oldXMenu/Internal.c.'>_XMRefreshSelection</a>(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>, menu, cur_s);
<a id='L465' name='L465'></a>   465             <em class='brace'>}</em>
<a id='L466' name='L466'></a>   466             cur_s = <a href='../D/4485.html' title='Multiple defined in 11 places.'>NULL</a>;
<a id='L467' name='L467'></a>   467             <strong class='reserved'>break</strong>;
<a id='L468' name='L468'></a>   468 
<a id='L469' name='L469'></a>   469     <strong class='reserved'>case</strong> ButtonPress:
<a id='L470' name='L470'></a>   470     <strong class='reserved'>case</strong> ButtonRelease:
<a id='L471' name='L471'></a>   471                 *p_num = cur_p-&gt;serial;
<a id='L472' name='L472'></a>   472                 <em class='comment'>/*</em>
<a id='L473' name='L473'></a>   473 <em class='comment'>                 * Check to see if there is a current selection.</em>
<a id='L474' name='L474'></a>   474 <em class='comment'>                 */</em>
<a id='L475' name='L475'></a>   475                 <strong class='reserved'>if</strong> (cur_s != <a href='../D/4485.html' title='Multiple defined in 11 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L476' name='L476'></a>   476                     <em class='comment'>/*</em>
<a id='L477' name='L477'></a>   477 <em class='comment'>                     * Set the selection number to the current selection.</em>
<a id='L478' name='L478'></a>   478 <em class='comment'>                     */</em>
<a id='L479' name='L479'></a>   479                     *s_num = cur_s-&gt;serial;
<a id='L480' name='L480'></a>   480                     <em class='comment'>/*</em>
<a id='L481' name='L481'></a>   481 <em class='comment'>                     * If the current selection was activated then</em>
<a id='L482' name='L482'></a>   482 <em class='comment'>                     * we have a valid selection otherwise we have</em>
<a id='L483' name='L483'></a>   483 <em class='comment'>                     * an inactive selection.</em>
<a id='L484' name='L484'></a>   484 <em class='comment'>                     */</em>
<a id='L485' name='L485'></a>   485                     <strong class='reserved'>if</strong> (cur_s-&gt;activated) <em class='brace'>{</em>
<a id='L486' name='L486'></a>   486                         *data = cur_s-&gt;data;
<a id='L487' name='L487'></a>   487                         ret_val = <a href='../D/7169.html' title='Multiple defined in 2 places.'>XM_SUCCESS</a>;
<a id='L488' name='L488'></a>   488                     <em class='brace'>}</em>
<a id='L489' name='L489'></a>   489                     <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L490' name='L490'></a>   490                         ret_val = <a href='../D/7166.html' title='Multiple defined in 2 places.'>XM_IA_SELECT</a>;
<a id='L491' name='L491'></a>   491                     <em class='brace'>}</em>
<a id='L492' name='L492'></a>   492                 <em class='brace'>}</em>
<a id='L493' name='L493'></a>   493                 <strong class='reserved'>else</strong> <em class='brace'>{</em>
<a id='L494' name='L494'></a>   494                     <em class='comment'>/*</em>
<a id='L495' name='L495'></a>   495 <em class='comment'>                     * No selection was current.</em>
<a id='L496' name='L496'></a>   496 <em class='comment'>                     */</em>
<a id='L497' name='L497'></a>   497                     ret_val = <a href='../D/7167.html' title='Multiple defined in 2 places.'>XM_NO_SELECT</a>;
<a id='L498' name='L498'></a>   498                 <em class='brace'>}</em>
<a id='L499' name='L499'></a>   499                 <a href='../S/4023.html#L63' title='Defined at 63 in lwlib/lwlib-Xm.c.'>selection</a> = True;
<a id='L500' name='L500'></a>   500                 <strong class='reserved'>break</strong>;
<a id='L501' name='L501'></a>   501         <strong class='reserved'>case</strong> KeyPress:
<a id='L502' name='L502'></a>   502         <strong class='reserved'>case</strong> KeyRelease:
<a id='L503' name='L503'></a>   503                 keysym = XLookupKeysym (&amp;event.xkey, 0);
<a id='L504' name='L504'></a>   504 
<a id='L505' name='L505'></a>   505                 <em class='comment'>/* Pop down on C-g and Escape.  */</em>
<a id='L506' name='L506'></a>   506                 <strong class='reserved'>if</strong> ((keysym == XK_g &amp;&amp; (event.xkey.state &amp; ControlMask) != 0)
<a id='L507' name='L507'></a>   507                     || keysym == XK_Escape) <em class='comment'>/* Any escape, ignore modifiers.  */</em>
<a id='L508' name='L508'></a>   508                   <em class='brace'>{</em>
<a id='L509' name='L509'></a>   509                     ret_val = <a href='../D/7167.html' title='Multiple defined in 2 places.'>XM_NO_SELECT</a>;
<a id='L510' name='L510'></a>   510                     <a href='../S/4023.html#L63' title='Defined at 63 in lwlib/lwlib-Xm.c.'>selection</a> = True;
<a id='L511' name='L511'></a>   511                   <em class='brace'>}</em>
<a id='L512' name='L512'></a>   512                <strong class='reserved'>break</strong>;
<a id='L513' name='L513'></a>   513             <strong class='reserved'>default</strong>:
<a id='L514' name='L514'></a>   514                 <em class='comment'>/*</em>
<a id='L515' name='L515'></a>   515 <em class='comment'>                 * If AEQ mode is enabled then queue the event.</em>
<a id='L516' name='L516'></a>   516 <em class='comment'>                 */</em>
<a id='L517' name='L517'></a>   517                 <strong class='reserved'>if</strong> (menu-&gt;aeq) <em class='brace'>{</em>
<a id='L518' name='L518'></a>   518                     feq_tmp = (<a href='../S/3769.html#L180' title='Defined at 180 in oldXMenu/Activate.c.'>XMEventQue</a> *)<a href='../D/14196.html' title='Multiple defined in 19 places.'>malloc</a>(<strong class='reserved'>sizeof</strong>(<a href='../S/3769.html#L180' title='Defined at 180 in oldXMenu/Activate.c.'>XMEventQue</a>));
<a id='L519' name='L519'></a>   519                     <strong class='reserved'>if</strong> (feq_tmp == <a href='../D/4485.html' title='Multiple defined in 11 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L520' name='L520'></a>   520                         _XMErrorCode = <a href='../S/3790.html#L61' title='Defined at 61 in oldXMenu/XMenu.h.'>XME_CALLOC</a>;
<a id='L521' name='L521'></a>   521                         <strong class='reserved'>return</strong>(<a href='../D/7165.html' title='Multiple defined in 2 places.'>XM_FAILURE</a>);
<a id='L522' name='L522'></a>   522                     <em class='brace'>}</em>
<a id='L523' name='L523'></a>   523                     feq_tmp-&gt;event = event;
<a id='L524' name='L524'></a>   524                     feq_tmp-&gt;next = feq;
<a id='L525' name='L525'></a>   525                     feq = feq_tmp;
<a id='L526' name='L526'></a>   526                 <em class='brace'>}</em>
<a id='L527' name='L527'></a>   527                 <strong class='reserved'>else</strong> <strong class='reserved'>if</strong> (_XMEventHandler) (*_XMEventHandler)(&amp;event);
<a id='L528' name='L528'></a>   528                 <strong class='reserved'>break</strong>;
<a id='L529' name='L529'></a>   529 <em class='sharp'>#ifdef</em> HAVE_XINPUT2
<a id='L530' name='L530'></a>   530         <strong class='reserved'>case</strong> GenericEvent:
<a id='L531' name='L531'></a>   531             <strong class='reserved'>if</strong> (translate_func)
<a id='L532' name='L532'></a>   532               translate_func (&amp;event);
<a id='L533' name='L533'></a>   533 <em class='sharp'>#endif</em>
<a id='L534' name='L534'></a>   534         <em class='brace'>}</em>
<a id='L535' name='L535'></a>   535         <em class='comment'>/*</em>
<a id='L536' name='L536'></a>   536 <em class='comment'>         * If a selection has been made, break out of the event loop.</em>
<a id='L537' name='L537'></a>   537 <em class='comment'>         */</em>
<a id='L538' name='L538'></a>   538         <strong class='reserved'>if</strong> (<a href='../S/4023.html#L63' title='Defined at 63 in lwlib/lwlib-Xm.c.'>selection</a> == True) <strong class='reserved'>break</strong>;
<a id='L539' name='L539'></a>   539     <em class='brace'>}</em>
<a id='L540' name='L540'></a>   540 
<a id='L541' name='L541'></a>   541     <em class='comment'>/*</em>
<a id='L542' name='L542'></a>   542 <em class='comment'>     * Unmap the menu.</em>
<a id='L543' name='L543'></a>   543 <em class='comment'>     */</em>
<a id='L544' name='L544'></a>   544     <strong class='reserved'>for</strong> ( p_ptr = menu-&gt;p_list-&gt;next;
<a id='L545' name='L545'></a>   545          p_ptr != menu-&gt;p_list;
<a id='L546' name='L546'></a>   546          p_ptr = p_ptr-&gt;next)
<a id='L547' name='L547'></a>   547       <em class='brace'>{</em>
<a id='L548' name='L548'></a>   548           XUnmapWindow(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>, p_ptr-&gt;<a href='../S/314.html#L100' title='Defined at 100 in src/window.h.'>window</a>);
<a id='L549' name='L549'></a>   549       <em class='brace'>}</em>
<a id='L550' name='L550'></a>   550 
<a id='L551' name='L551'></a>   551     <em class='comment'>/*</em>
<a id='L552' name='L552'></a>   552 <em class='comment'>     * Ungrab the mouse.</em>
<a id='L553' name='L553'></a>   553 <em class='comment'>     */</em>
<a id='L554' name='L554'></a>   554     XUngrabPointer(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>, CurrentTime);
<a id='L555' name='L555'></a>   555     XUngrabKeyboard(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>, CurrentTime);
<a id='L556' name='L556'></a>   556 
<a id='L557' name='L557'></a>   557     <em class='comment'>/*</em>
<a id='L558' name='L558'></a>   558 <em class='comment'>     * Restore bits under where the menu was if we managed</em>
<a id='L559' name='L559'></a>   559 <em class='comment'>     * to save them and free the pixmap.</em>
<a id='L560' name='L560'></a>   560 <em class='comment'>     */</em>
<a id='L561' name='L561'></a>   561 
<a id='L562' name='L562'></a>   562     <em class='comment'>/*</em>
<a id='L563' name='L563'></a>   563 <em class='comment'>     * If there is a current selection deactivate it.</em>
<a id='L564' name='L564'></a>   564 <em class='comment'>     */</em>
<a id='L565' name='L565'></a>   565     <strong class='reserved'>if</strong> (cur_s != <a href='../D/4485.html' title='Multiple defined in 11 places.'>NULL</a>) cur_s-&gt;activated = 0;
<a id='L566' name='L566'></a>   566 
<a id='L567' name='L567'></a>   567     <em class='comment'>/*</em>
<a id='L568' name='L568'></a>   568 <em class='comment'>     * Deactivate the current pane.</em>
<a id='L569' name='L569'></a>   569 <em class='comment'>     */</em>
<a id='L570' name='L570'></a>   570     cur_p-&gt;activated = 0;
<a id='L571' name='L571'></a>   571     XSetWindowBackgroundPixmap(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>, cur_p-&gt;<a href='../S/314.html#L100' title='Defined at 100 in src/window.h.'>window</a>, menu-&gt;inact_pixmap);
<a id='L572' name='L572'></a>   572 
<a id='L573' name='L573'></a>   573     <em class='comment'>/*</em>
<a id='L574' name='L574'></a>   574 <em class='comment'>     * Synchronize the X buffers and the X event queue.</em>
<a id='L575' name='L575'></a>   575 <em class='comment'>     */</em>
<a id='L576' name='L576'></a>   576     <a href='../D/7282.html' title='Multiple defined in 3 places.'>XSync</a>(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>, 0);
<a id='L577' name='L577'></a>   577 
<a id='L578' name='L578'></a>   578     <em class='comment'>/*</em>
<a id='L579' name='L579'></a>   579 <em class='comment'>     * Dispatch any events remaining on the queue.</em>
<a id='L580' name='L580'></a>   580 <em class='comment'>     */</em>
<a id='L581' name='L581'></a>   581     <strong class='reserved'>while</strong> (QLength(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>)) <em class='brace'>{</em>
<a id='L582' name='L582'></a>   582         <em class='comment'>/*</em>
<a id='L583' name='L583'></a>   583 <em class='comment'>         * Fetch the next event.</em>
<a id='L584' name='L584'></a>   584 <em class='comment'>         */</em>
<a id='L585' name='L585'></a>   585         XNextEvent(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>, &amp;event);
<a id='L586' name='L586'></a>   586 
<a id='L587' name='L587'></a>   587         <em class='comment'>/*</em>
<a id='L588' name='L588'></a>   588 <em class='comment'>         * Discard any events left on the queue that belong to XMenu.</em>
<a id='L589' name='L589'></a>   589 <em class='comment'>         * All others are held and then returned to the event queue.</em>
<a id='L590' name='L590'></a>   590 <em class='comment'>         */</em>
<a id='L591' name='L591'></a>   591         <strong class='reserved'>switch</strong> (event.type) <em class='brace'>{</em>
<a id='L592' name='L592'></a>   592             <strong class='reserved'>case</strong> Expose:
<a id='L593' name='L593'></a>   593             <strong class='reserved'>case</strong> EnterNotify:
<a id='L594' name='L594'></a>   594             <strong class='reserved'>case</strong> LeaveNotify:
<a id='L595' name='L595'></a>   595             <strong class='reserved'>case</strong> ButtonPress:
<a id='L596' name='L596'></a>   596             <strong class='reserved'>case</strong> ButtonRelease:
<a id='L597' name='L597'></a>   597                 <em class='comment'>/*</em>
<a id='L598' name='L598'></a>   598 <em class='comment'>                 * Does this event belong to one of XMenu's windows?</em>
<a id='L599' name='L599'></a>   599 <em class='comment'>                 * If so, discard it and process the next event.</em>
<a id='L600' name='L600'></a>   600 <em class='comment'>                 * If not fall through and treat it as a foreign event.</em>
<a id='L601' name='L601'></a>   601 <em class='comment'>                 */</em>
<a id='L602' name='L602'></a>   602                 event_xmp = (<a href='../S/3790.html#L137' title='Defined at 137 in oldXMenu/XMenu.h.'>XMPane</a> *)<a href='../S/3763.html#L39' title='Defined at 39 in oldXMenu/XLookAssoc.c.'>XLookUpAssoc</a>(
<a id='L603' name='L603'></a>   603                                                    <a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>,
<a id='L604' name='L604'></a>   604                                                    menu-&gt;assoc_tab,
<a id='L605' name='L605'></a>   605                                                    event.xbutton.<a href='../S/314.html#L100' title='Defined at 100 in src/window.h.'>window</a>
<a id='L606' name='L606'></a>   606                                                    );
<a id='L607' name='L607'></a>   607                 <strong class='reserved'>if</strong> (event_xmp != <a href='../D/4485.html' title='Multiple defined in 11 places.'>NULL</a>) <strong class='reserved'>continue</strong>;
<a id='L608' name='L608'></a>   608                 <a href='../D/2019.html' title='Multiple defined in 3 places.'>FALLTHROUGH</a>;
<a id='L609' name='L609'></a>   609             <strong class='reserved'>default</strong>:
<a id='L610' name='L610'></a>   610                 <em class='comment'>/*</em>
<a id='L611' name='L611'></a>   611 <em class='comment'>                 * This is a foreign event.</em>
<a id='L612' name='L612'></a>   612 <em class='comment'>                 * Queue it for later return to the X event queue.</em>
<a id='L613' name='L613'></a>   613 <em class='comment'>                 */</em>
<a id='L614' name='L614'></a>   614                 feq_tmp = (<a href='../S/3769.html#L180' title='Defined at 180 in oldXMenu/Activate.c.'>XMEventQue</a> *)<a href='../D/14196.html' title='Multiple defined in 19 places.'>malloc</a>(<strong class='reserved'>sizeof</strong>(<a href='../S/3769.html#L180' title='Defined at 180 in oldXMenu/Activate.c.'>XMEventQue</a>));
<a id='L615' name='L615'></a>   615                 <strong class='reserved'>if</strong> (feq_tmp == <a href='../D/4485.html' title='Multiple defined in 11 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L616' name='L616'></a>   616                     _XMErrorCode = <a href='../S/3790.html#L61' title='Defined at 61 in oldXMenu/XMenu.h.'>XME_CALLOC</a>;
<a id='L617' name='L617'></a>   617                     <strong class='reserved'>return</strong>(<a href='../D/7165.html' title='Multiple defined in 2 places.'>XM_FAILURE</a>);
<a id='L618' name='L618'></a>   618                 <em class='brace'>}</em>
<a id='L619' name='L619'></a>   619                 feq_tmp-&gt;event = event;
<a id='L620' name='L620'></a>   620                 feq_tmp-&gt;next = feq;
<a id='L621' name='L621'></a>   621                 feq = feq_tmp;
<a id='L622' name='L622'></a>   622             <em class='brace'>}</em>
<a id='L623' name='L623'></a>   623     <em class='brace'>}</em>
<a id='L624' name='L624'></a>   624     <em class='comment'>/*</em>
<a id='L625' name='L625'></a>   625 <em class='comment'>     * Return any foreign events that were queued to the X event queue.</em>
<a id='L626' name='L626'></a>   626 <em class='comment'>     */</em>
<a id='L627' name='L627'></a>   627     <strong class='reserved'>while</strong> (feq != <a href='../D/4485.html' title='Multiple defined in 11 places.'>NULL</a>) <em class='brace'>{</em>
<a id='L628' name='L628'></a>   628         feq_tmp = feq;
<a id='L629' name='L629'></a>   629         XPutBackEvent(<a href='../D/10539.html' title='Multiple defined in 4 places.'>display</a>, &amp;feq_tmp-&gt;event);
<a id='L630' name='L630'></a>   630         feq = feq_tmp-&gt;next;
<a id='L631' name='L631'></a>   631         <a href='../D/11743.html' title='Multiple defined in 19 places.'>free</a>((<strong class='reserved'>char</strong> *)feq_tmp);
<a id='L632' name='L632'></a>   632     <em class='brace'>}</em>
<a id='L633' name='L633'></a>   633 
<a id='L634' name='L634'></a>   634     wait_func = 0;
<a id='L635' name='L635'></a>   635 
<a id='L636' name='L636'></a>   636     <em class='comment'>/*</em>
<a id='L637' name='L637'></a>   637 <em class='comment'>     * Return successfully.</em>
<a id='L638' name='L638'></a>   638 <em class='comment'>     */</em>
<a id='L639' name='L639'></a>   639     _XMErrorCode = <a href='../S/3790.html#L53' title='Defined at 53 in oldXMenu/XMenu.h.'>XME_NO_ERROR</a>;
<a id='L640' name='L640'></a>   640     <strong class='reserved'>return</strong>(ret_val);
<a id='L641' name='L641'></a>   641 
<a id='L642' name='L642'></a>   642 <em class='brace'>}</em>
</pre>
<hr />
<a id='BOTTOM' name='BOTTOM'></a>
<em class='comment'>/* [&lt;][&gt;]<a href='#L127'>[^]</a><a href='#L140'>[v]</a><a href='#TOP'>[top]</a>[bottom]<a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</em>
</body>
</html>
