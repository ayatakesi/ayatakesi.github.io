<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- This is the GNU Emacs Manual,
updated for Emacs version 26.2.

Copyright (C) 2016-2019 ayatakesi
<ayanokoji.takesi@gmail.com>
Copyright (C) 1985-1987, 1993-2019
Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document under
the terms of the GNU Free Documentation License, Version 1.3 or any later
version published by the Free Software Foundation; with the Invariant
Sections being "The GNU Manifesto," "Distribution" and "GNU GENERAL
PUBLIC LICENSE," with the Front-Cover Texts being "A GNU Manual," and
with the Back-Cover Texts as in (a) below.  A copy of the license is
included in the section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and modify
this GNU manual.  Buying copies from the FSF supports it in developing GNU
and promoting software freedom." -->
<!-- Created by GNU Texinfo 6.1, http://www.gnu.org/software/texinfo/ -->
<head>
<title>GNU Emacs Manual
(Japanese Translation): Basic Keyboard Macro</title>

<meta name="description" content="GNU Emacs Manual
(Japanese Translation): Basic Keyboard Macro">
<meta name="keywords" content="GNU Emacs Manual
(Japanese Translation): Basic Keyboard Macro">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="index.html#Top" rel="start" title="Top">
<link href="Key-Index.html#Key-Index" rel="index" title="Key Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Keyboard-Macros.html#Keyboard-Macros" rel="up" title="Keyboard Macros">
<link href="Keyboard-Macro-Ring.html#Keyboard-Macro-Ring" rel="next" title="Keyboard Macro Ring">
<link href="Keyboard-Macros.html#Keyboard-Macros" rel="prev" title="Keyboard Macros">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en">
<a name="Basic-Keyboard-Macro"></a>
<div class="header">
<p>
Next: <a href="Keyboard-Macro-Ring.html#Keyboard-Macro-Ring" accesskey="n" rel="next">Keyboard Macro Ring</a>, Up: <a href="Keyboard-Macros.html#Keyboard-Macros" accesskey="u" rel="up">Keyboard Macros</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Key-Index.html#Key-Index" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<a name="Ji-Ben-De-naShi-iFang-"></a>
<h3 class="section">17.1 基本的な使い方</h3>

<dl compact="compact">
<dt><kbd><span class="key">F3</span></kbd></dt>
<dt><kbd>C-x (</kbd></dt>
<dd><p>キーボードマクロの定義を開始します(<code>kmacro-start-macro-or-insert-counter</code>)。
</p></dd>
<dt><kbd><span class="key">F4</span></kbd></dt>
<dt><kbd>C-x e</kbd></dt>
<dd><p>キーボードマクロを定義しているときは定義を終了します。それ以外の場合は一番最近のキーボードマクロを実行します(<code>kmacro-end-or-call-macro</code>)。
</p></dd>
<dt><kbd>C-u <span class="key">F3</span></kbd></dt>
<dt><kbd>C-u C-x (</kbd></dt>
<dd><p>最後のキーボードマクロを再実行してから、キーをマクロ定義に追加します。
</p></dd>
<dt><kbd>C-u C-u <span class="key">F3</span></kbd></dt>
<dt><kbd>C-u C-u C-x (</kbd></dt>
<dd><p>最後のキーボードマクロを再実行せずに、キーをマクロ定義に追加します。
</p></dd>
<dt><kbd>C-x C-k r</kbd></dt>
<dd><p>リージョンの中の各行の行頭にたいして、最後のキーボードマクロを実行します(<code>apply-macro-to-region-lines</code>)。
</p></dd>
</dl>

<a name="index-F3"></a>
<a name="index-F4"></a>
<a name="index-kmacro_002dstart_002dmacro_002dor_002dinsert_002dcounter"></a>
<a name="index-kmacro_002dend_002dor_002dcall_002dmacro"></a>
<a name="index-kmacro_002dend_002dand_002dcall_002dmacro"></a>
<p>キーボードマクロの定義を開始するには、<tt class="key">F3</tt>をタイプします。それからはキーを入力して実行を続けますが、それは同時にマクロ定義の一部になります。その間は、モードラインに&lsquo;<samp>Def</samp>&rsquo;が表示されて、マクロの定義中であることを示します。終了するときは<tt class="key">F4</tt>
(<code>kmacro-end-or-call-macro</code>)をタイプして、定義を終了します。たとえば、
</p>
<div class="example">
<pre class="example"><span class="key">F3</span> M-f foo <span class="key">F4</span>
</pre></div>

<p>これは1単語前方に移動してから、&lsquo;<samp>foo</samp>&rsquo;を挿入するマクロを定義します。<tt class="key">F3</tt>と<tt class="key">F4</tt>は、マクロの一部とはならないことに注意してください。
</p>
<p>マクロを定義した後は、<tt class="key">F4</tt>でそれを呼び出すことができます。上記の例では、それは<kbd>M-f foo</kbd>
againをタイプしたのと同じ効果をもちます(<tt class="key">F4</tt>コマンドの2つの役割に注意してください。これはマクロを定義しているときはマクロの定義を終了し、そうでないときは最後のマクロを呼び出します)。<tt class="key">F4</tt>に数引数&lsquo;<samp>n</samp>&rsquo;を与えることもできます。これはマクロを&lsquo;<samp>n</samp>&rsquo;回呼び出すことを意味します。引数に0を与えると、エラーになるか、<kbd>C-g</kbd>(MS-DOSでは<kbd>C-<span class="key">BREAK</span></kbd>)をタイプするまで、マクロを永久に繰り返します。
</p>
<p>上記の例は、キーボードマクロを使った便利なトリックをデモンストレイトする例です。テキストの一定間隔の位置にたいして繰り返し操作を行いたいときは、マクロの一部に移動コマンドを含めます。この例ではマクロの繰り返しにより、連続する単語の後ろに文字列&lsquo;<samp>foo</samp>&rsquo;を挿入していきます。
</p>
<p>キーボードマクロの定義を終了した後でも、<kbd>C-u
<span class="key">F3</span></kbd>をタイプすることにより、マクロの定義にキーストロークを追加できます。これは<tt class="key">F3</tt>に続けてマクロの定義を再タイプするのと同じです。結果として、そのマクロの以前の定義が再実行されることになります。変数<code>kmacro-execute-before-append</code>を<code>nil</code>に変更すると、既存のマクロにキーストロークが追加されるまでは実行されません(デフォルトは<code>t</code>)。最後に実行したキーボードマクロを再実行することなく、定義の最後にキーストロークを追加するには、<kbd>C-u
C-u <span class="key">F3</span></kbd>をタイプしてください。
</p>
<p>コマンドがミニバッファーから引数を読みとる場合、ミニバッファーにたいする入力は、コマンドと一緒にマクロの一部となります。したがってマクロを再生すると、そのコマンドの引数は入力されたのと同じになります。たとえば、
</p>
<div class="example">
<pre class="example"><span class="key">F3</span> C-a C-k C-x b foo <span class="key">RET</span> C-y C-x b <span class="key">RET</span> <span class="key">F4</span>
</pre></div>

<p>これはカレント行をkillして、バッファー&lsquo;<samp>foo</samp>&rsquo;にそれをyankした後、元のバッファーに戻ります。
</p>
<p>ほとんどのキーボードコマンドは、キーボードマクロの定義で普通に機能しますが、いくつか例外があります。<kbd>C-g</kbd>
(<code>keyboard-quit</code>)をタイプすると、キーボードマクロの定義が終了します。<kbd>C-M-c</kbd>
(<code>exit-recursive-edit</code>)は信頼できません。これはマクロの中で再帰編集(recursive
edit)を開始したときは期待通りに再帰編集から抜け出しますが、キーボードマクロの呼び出し前に開始された再帰編集を抜け出すには、キーボードマクロからも抜け出す必要があります。同様に、マウスイベントもキーボードマクロで使用できますが。信頼はできません。マクロによりマウスイベントが再生されるときは、マクロを定義したときのマウス位置が使用されます。この効果は予測が困難です。
</p>
<a name="index-apply_002dmacro_002dto_002dregion_002dlines"></a>
<a name="index-C_002dx-C_002dk-r"></a>
<p>コマンド<kbd>C-x C-k r</kbd>
(<code>apply-macro-to-region-lines</code>)は、リージョン内の各行のにたいして、最後に定義されたキーボードマクロを繰り返します。これは1行ずつポイントをリージョン内の行頭に移動してからマクロを実行します。
</p>
<a name="index-C_002dx-_0028"></a>
<a name="index-C_002dx-_0029"></a>
<a name="index-C_002dx-e"></a>
<a name="index-kmacro_002dstart_002dmacro"></a>
<a name="index-kmacro_002dend_002dmacro"></a>
<p>上記で説明した<tt class="key">F3</tt>と<tt class="key">F4</tt>に加えて、Emacsはキーボードマクロを定義したり実行するための、古いキーバインドもサポートします。<tt class="key">F3</tt>と同様にマクロ定義を開始するには、<kbd>C-x
(</kbd>
(<code>kmacro-start-macro</code>)とタイプします。プレフィクス引数を指定すると、最後のキーボードマクロの定義に追加します。マクロ定義を終了するには<kbd>C-x
)</kbd> (<code>kmacro-end-macro</code>)とタイプします。一番最近のマクロを実行するには、<kbd>C-x e</kbd>
(<code>kmacro-end-and-call-macro</code>)とタイプします。マクロ定義中に<kbd>C-x
e</kbd>を入力すると、マクロ定義を終了してからすぐに実行されます。<kbd>C-x
e</kbd>をタイプした後すぐに<kbd>e</kbd>をタイプすることにより、そのマクロを１回以上繰り返すことができます。(マクロの実行に使用されるときの)<tt class="key">F4</tt>と同様、<kbd>C-x
e</kbd>には繰り返し回数を引数指定できます。
</p>
<p><kbd>C-x
)</kbd>に、繰り返し回数を引数として与えることができます。これはマクロを定義した後、すぐにマクロが繰り返されることを意味します。マクロの定義は、定義することによりマクロが実行されるので、最初の1回として数えられます。したがって<kbd>C-u
4 C-x )</kbd>は、マクロを3回すぐに追加実行します。
</p>



</body>
</html>
