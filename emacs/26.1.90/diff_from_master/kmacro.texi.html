<!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><a name="line1"><font color="#000000">001:</font></a> <i><font color="#9A1900">@c This is part of the Emacs manual.</font></i>
<a name="line2"><font color="#000000">002:</font></a> <i><font color="#9A1900">@c Copyright (C) 1985-1987, 1993-1995, 1997, 2000-2019 Free Software</font></i>
<a name="line3"><font color="#000000">003:</font></a> <i><font color="#9A1900">@c Foundation, Inc.</font></i>
<a name="line4"><font color="#000000">004:</font></a> <i><font color="#9A1900">@c See file emacs.texi for copying conditions.</font></i>
<a name="line5"><font color="#000000">005:</font></a> <b><font color="#0000FF">@node</font></b> Keyboard Macros
<a name="line6"><font color="#000000">006:</font></a> <i><font color="#9A1900">@chapter Keyboard Macros</font></i>
<a name="line7"><font color="#000000">007:</font></a> <i><font color="#9A1900">@cindex defining keyboard macros</font></i>
<a name="line8"><font color="#000000">008:</font></a> <i><font color="#9A1900">@cindex keyboard macro</font></i>
<a name="line9"><font color="#000000">009:</font></a> 
<a name="line10"><font color="#000000">010:</font></a>   In this chapter we describe how to record a sequence of editing
<a name="line11"><font color="#000000">011:</font></a> commands so you can repeat it conveniently later.
<a name="line12"><font color="#000000">012:</font></a> 
<a name="line13"><font color="#000000">013:</font></a>   A <b><font color="#0000FF">@dfn</font></b><font color="#009900">{keyboard macro}</font> is a command defined by an Emacs user to stand for
<a name="line14"><font color="#000000">014:</font></a> another sequence of keys.  For example, if you discover that you are
<a name="line15"><font color="#000000">015:</font></a> about to type <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-n M-d C-d}</font> forty times, you can speed your work by
<a name="line16"><font color="#000000">016:</font></a> defining a keyboard macro to do <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-n M-d C-d}</font>, and then executing
<a name="line17"><font color="#000000">017:</font></a> it 39 more times.
<a name="line18"><font color="#000000">018:</font></a> 
<a name="line19"><font color="#000000">019:</font></a>   You define a keyboard macro by executing and recording the commands
<a name="line20"><font color="#000000">020:</font></a> which are its definition.  Put differently, as you define a keyboard
<a name="line21"><font color="#000000">021:</font></a> macro, the definition is being executed for the first time.  This way,
<a name="line22"><font color="#000000">022:</font></a> you can see the effects of your commands, so that you don't have to
<a name="line23"><font color="#000000">023:</font></a> figure them out in your head.  When you close the definition, the
<a name="line24"><font color="#000000">024:</font></a> keyboard macro is defined and also has been, in effect, executed once.
<a name="line25"><font color="#000000">025:</font></a> You can then do the whole thing over again by invoking the macro.
<a name="line26"><font color="#000000">026:</font></a> 
<a name="line27"><font color="#000000">027:</font></a>   Keyboard macros differ from ordinary Emacs commands in that they are
<a name="line28"><font color="#000000">028:</font></a> written in the Emacs command language rather than in Lisp.  This makes it
<a name="line29"><font color="#000000">029:</font></a> easier for the novice to write them, and makes them more convenient as
<a name="line30"><font color="#000000">030:</font></a> temporary hacks.  However, the Emacs command language is not powerful
<a name="line31"><font color="#000000">031:</font></a> enough as a programming language to be useful for writing anything
<a name="line32"><font color="#000000">032:</font></a> intelligent or general.  For such things, Lisp must be used.
<a name="line33"><font color="#000000">033:</font></a> 
<a name="line34"><font color="#000000">034:</font></a> <b><font color="#000080">@menu</font></b>
<a name="line35"><font color="#000000">035:</font></a> <font color="#FF0000">* Basic Keyboard Macro::</font>     Defining and running keyboard macros.
<a name="line36"><font color="#000000">036:</font></a> <font color="#FF0000">* Keyboard Macro Ring::</font>      Where previous keyboard macros are saved.
<a name="line37"><font color="#000000">037:</font></a> <font color="#FF0000">* Keyboard Macro Counter::</font>   Inserting incrementing numbers in macros.
<a name="line38"><font color="#000000">038:</font></a> <font color="#FF0000">* Keyboard Macro Query::</font>     Making keyboard macros do different things each
<a name="line39"><font color="#000000">039:</font></a>                                time.
<a name="line40"><font color="#000000">040:</font></a> <font color="#FF0000">* Save Keyboard Macro::</font>      Giving keyboard macros names; saving them in
<a name="line41"><font color="#000000">041:</font></a>                                files.
<a name="line42"><font color="#000000">042:</font></a> <font color="#FF0000">* Edit Keyboard Macro::</font>      Editing keyboard macros.
<a name="line43"><font color="#000000">043:</font></a> <font color="#FF0000">* Keyboard Macro Step-Edit::</font> Interactively executing and editing a keyboard
<a name="line44"><font color="#000000">044:</font></a>                                macro.
<a name="line45"><font color="#000000">045:</font></a> <b><font color="#000080">@end menu</font></b>
<a name="line46"><font color="#000000">046:</font></a> 
<a name="line47"><font color="#000000">047:</font></a> <b><font color="#0000FF">@node</font></b> Basic Keyboard Macro
<a name="line48"><font color="#000000">048:</font></a> <b><font color="#0000FF">@section</font></b> Basic Use
<a name="line49"><font color="#000000">049:</font></a> 
<a name="line50"><font color="#000000">050:</font></a> <b><font color="#0000FF">@table</font></b> <b><font color="#0000FF">@kbd</font></b>
<a name="line51"><font color="#000000">051:</font></a> <b><font color="#0000FF">@item</font></b> <b><font color="#0000FF">@key</font></b><font color="#009900">{F3}</font>
<a name="line52"><font color="#000000">052:</font></a> <b><font color="#0000FF">@itemx</font></b> C-x (
<a name="line53"><font color="#000000">053:</font></a> Start defining a keyboard macro
<a name="line54"><font color="#000000">054:</font></a> (<b><font color="#0000FF">@code</font></b><font color="#009900">{kmacro-start-macro-or-insert-counter}</font>).
<a name="line55"><font color="#000000">055:</font></a> <b><font color="#0000FF">@item</font></b> <b><font color="#0000FF">@key</font></b><font color="#009900">{F4}</font>
<a name="line56"><font color="#000000">056:</font></a> <b><font color="#0000FF">@itemx</font></b> C-x e
<a name="line57"><font color="#000000">057:</font></a> If a keyboard macro is being defined, end the definition; otherwise,
<a name="line58"><font color="#000000">058:</font></a> execute the most recent keyboard macro
<a name="line59"><font color="#000000">059:</font></a> (<b><font color="#0000FF">@code</font></b><font color="#009900">{kmacro-end-or-call-macro}</font>).
<a name="line60"><font color="#000000">060:</font></a> <b><font color="#0000FF">@item</font></b> C-u <b><font color="#0000FF">@key</font></b><font color="#009900">{F3}</font>
<a name="line61"><font color="#000000">061:</font></a> <b><font color="#0000FF">@itemx</font></b> C-u C-x (
<a name="line62"><font color="#000000">062:</font></a> Re-execute last keyboard macro, then append keys to its definition.
<a name="line63"><font color="#000000">063:</font></a> <b><font color="#0000FF">@item</font></b> C-u C-u <b><font color="#0000FF">@key</font></b><font color="#009900">{F3}</font>
<a name="line64"><font color="#000000">064:</font></a> <b><font color="#0000FF">@itemx</font></b> C-u C-u C-x (
<a name="line65"><font color="#000000">065:</font></a> Append keys to the last keyboard macro without re-executing it.
<a name="line66"><font color="#000000">066:</font></a> <b><font color="#0000FF">@item</font></b> C-x C-k r
<a name="line67"><font color="#000000">067:</font></a> Run the last keyboard macro on each line that begins in the region
<a name="line68"><font color="#000000">068:</font></a> (<b><font color="#0000FF">@code</font></b><font color="#009900">{apply-macro-to-region-lines}</font>).
<a name="line69"><font color="#000000">069:</font></a> <b><font color="#0000FF">@end table</font></b>
<a name="line70"><font color="#000000">070:</font></a> 
<a name="line71"><font color="#000000">071:</font></a> <b><font color="#0000FF">@kindex</font></b> F3
<a name="line72"><font color="#000000">072:</font></a> <b><font color="#0000FF">@kindex</font></b> F4
<a name="line73"><font color="#000000">073:</font></a> <b><font color="#0000FF">@findex</font></b> kmacro-start-macro-or-insert-counter
<a name="line74"><font color="#000000">074:</font></a> <b><font color="#0000FF">@findex</font></b> kmacro-end-or-call-macro
<a name="line75"><font color="#000000">075:</font></a> <b><font color="#0000FF">@findex</font></b> kmacro-end-and-call-macro
<a name="line76"><font color="#000000">076:</font></a>   To start defining a keyboard macro, type <b><font color="#0000FF">@key</font></b><font color="#009900">{F3}</font>.  From then on,
<a name="line77"><font color="#000000">077:</font></a> your keys continue to be executed, but also become part of the
<a name="line78"><font color="#000000">078:</font></a> definition of the macro.  <b><font color="#0000FF">@samp</font></b><font color="#009900">{Def}</font> appears in the mode line to
<a name="line79"><font color="#000000">079:</font></a> remind you of what is going on.  When you are finished, type <b><font color="#0000FF">@key</font></b><font color="#009900">{F4}</font>
<a name="line80"><font color="#000000">080:</font></a> (<b><font color="#0000FF">@code</font></b><font color="#009900">{kmacro-end-or-call-macro}</font>) to terminate the definition.  For
<a name="line81"><font color="#000000">081:</font></a> example,
<a name="line82"><font color="#000000">082:</font></a> 
<a name="line83"><font color="#000000">083:</font></a> <b><font color="#0000FF">@example</font></b>
<a name="line84"><font color="#000000">084:</font></a> <b><font color="#0000FF">@key</font></b><font color="#009900">{F3}</font> M-f foo <b><font color="#0000FF">@key</font></b><font color="#009900">{F4}</font>
<a name="line85"><font color="#000000">085:</font></a> <b><font color="#0000FF">@end example</font></b>
<a name="line86"><font color="#000000">086:</font></a> 
<a name="line87"><font color="#000000">087:</font></a> <b><font color="#0000FF">@noindent</font></b>
<a name="line88"><font color="#000000">088:</font></a> defines a macro to move forward a word and then insert <b><font color="#0000FF">@samp</font></b><font color="#009900">{foo}</font>.
<a name="line89"><font color="#000000">089:</font></a> Note that <b><font color="#0000FF">@key</font></b><font color="#009900">{F3}</font> and <b><font color="#0000FF">@key</font></b><font color="#009900">{F4}</font> do not become part of the macro.
<a name="line90"><font color="#000000">090:</font></a> 
<a name="line91"><font color="#000000">091:</font></a>   After defining the macro, you can call it with <b><font color="#0000FF">@key</font></b><font color="#009900">{F4}</font>.  For the
<a name="line92"><font color="#000000">092:</font></a> above example, this has the same effect as typing <b><font color="#0000FF">@kbd</font></b><font color="#009900">{M-f foo}</font> again.
<a name="line93"><font color="#000000">093:</font></a> (Note the two roles of the <b><font color="#0000FF">@key</font></b><font color="#009900">{F4}</font> command: it ends the macro if you
<a name="line94"><font color="#000000">094:</font></a> are in the process of defining one, or calls the last macro
<a name="line95"><font color="#000000">095:</font></a> otherwise.)  You can also supply <b><font color="#0000FF">@key</font></b><font color="#009900">{F4}</font> with a numeric prefix
<a name="line96"><font color="#000000">096:</font></a> argument <b><font color="#0000FF">@samp</font></b><font color="#009900">{n}</font>, which means to invoke the macro <b><font color="#0000FF">@samp</font></b><font color="#009900">{n}</font> times.  An
<a name="line97"><font color="#000000">097:</font></a> argument of zero repeats the macro indefinitely, until it gets an
<a name="line98"><font color="#000000">098:</font></a> error or you type <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-g}</font> (or, on MS-DOS, <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-@key{BREAK}}</font>).
<a name="line99"><font color="#000000">099:</font></a> 
<a name="line100"><font color="#000000">100:</font></a>   The above example demonstrates a handy trick that you can employ
<a name="line101"><font color="#000000">101:</font></a> with keyboard macros: if you wish to repeat an operation at regularly
<a name="line102"><font color="#000000">102:</font></a> spaced places in the text, include a motion command as part of the
<a name="line103"><font color="#000000">103:</font></a> macro.  In this case, repeating the macro inserts the string
<a name="line104"><font color="#000000">104:</font></a> <b><font color="#0000FF">@samp</font></b><font color="#009900">{foo}</font> after each successive word.
<a name="line105"><font color="#000000">105:</font></a> 
<a name="line106"><font color="#000000">106:</font></a>   After terminating the definition of a keyboard macro, you can append
<a name="line107"><font color="#000000">107:</font></a> more keystrokes to its definition by typing <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-u @key{F3}}</font>.  This
<a name="line108"><font color="#000000">108:</font></a> is equivalent to plain <b><font color="#0000FF">@key</font></b><font color="#009900">{F3}</font> followed by retyping the whole
<a name="line109"><font color="#000000">109:</font></a> definition so far.  As a consequence, it re-executes the macro as
<a name="line110"><font color="#000000">110:</font></a> previously defined.  If you change the variable
<a name="line111"><font color="#000000">111:</font></a> <i><font color="#9A1900">@code{kmacro-execute-before-append} to @code{nil}, the existing macro</font></i>
<a name="line112"><font color="#000000">112:</font></a> will not be re-executed before appending to it (the default is
<a name="line113"><font color="#000000">113:</font></a> <i><font color="#9A1900">@code{t}).  You can also add to the end of the definition of the last</font></i>
<a name="line114"><font color="#000000">114:</font></a> keyboard macro without re-executing it by typing <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-u C-u</font>
<a name="line115"><font color="#000000">115:</font></a> <font color="#009900">@key{F3}}</font>.
<a name="line116"><font color="#000000">116:</font></a> 
<a name="line117"><font color="#000000">117:</font></a>   When a command reads an argument with the minibuffer, your
<a name="line118"><font color="#000000">118:</font></a> minibuffer input becomes part of the macro along with the command.  So
<a name="line119"><font color="#000000">119:</font></a> when you replay the macro, the command gets the same argument as when
<a name="line120"><font color="#000000">120:</font></a> you entered the macro.  For example,
<a name="line121"><font color="#000000">121:</font></a> 
<a name="line122"><font color="#000000">122:</font></a> <b><font color="#0000FF">@example</font></b>
<a name="line123"><font color="#000000">123:</font></a> <b><font color="#0000FF">@key</font></b><font color="#009900">{F3}</font> C-a C-k C-x b foo <b><font color="#0000FF">@key</font></b><font color="#009900">{RET}</font> C-y C-x b <b><font color="#0000FF">@key</font></b><font color="#009900">{RET}</font> <b><font color="#0000FF">@key</font></b><font color="#009900">{F4}</font>
<a name="line124"><font color="#000000">124:</font></a> <b><font color="#0000FF">@end example</font></b>
<a name="line125"><font color="#000000">125:</font></a> 
<a name="line126"><font color="#000000">126:</font></a> <b><font color="#0000FF">@noindent</font></b>
<a name="line127"><font color="#000000">127:</font></a> defines a macro that kills the current line, yanks it into the buffer
<a name="line128"><font color="#000000">128:</font></a> <b><font color="#0000FF">@samp</font></b><font color="#009900">{foo}</font>, then returns to the original buffer.
<a name="line129"><font color="#000000">129:</font></a> 
<a name="line130"><font color="#000000">130:</font></a>   Most keyboard commands work as usual in a keyboard macro definition,
<a name="line131"><font color="#000000">131:</font></a> with some exceptions.  Typing <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-g}</font> (<b><font color="#0000FF">@code</font></b><font color="#009900">{keyboard-quit}</font>) quits
<a name="line132"><font color="#000000">132:</font></a> the keyboard macro definition.  Typing <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-M-c}</font>
<a name="line133"><font color="#000000">133:</font></a> (<b><font color="#0000FF">@code</font></b><font color="#009900">{exit-recursive-edit}</font>) can be unreliable: it works as you'd
<a name="line134"><font color="#000000">134:</font></a> expect if exiting a recursive edit that started within the macro, but
<a name="line135"><font color="#000000">135:</font></a> if it exits a recursive edit that started before you invoked the
<a name="line136"><font color="#000000">136:</font></a> keyboard macro, it also necessarily exits the keyboard macro too.
<a name="line137"><font color="#000000">137:</font></a> Mouse events are also unreliable, even though you can use them in a
<a name="line138"><font color="#000000">138:</font></a> keyboard macro: when the macro replays the mouse event, it uses the
<a name="line139"><font color="#000000">139:</font></a> original mouse position of that event, the position that the mouse had
<a name="line140"><font color="#000000">140:</font></a> while you were defining the macro.  The effect of this may be hard to
<a name="line141"><font color="#000000">141:</font></a> predict.
<a name="line142"><font color="#000000">142:</font></a> 
<a name="line143"><font color="#000000">143:</font></a> <b><font color="#0000FF">@findex</font></b> apply-macro-to-region-lines
<a name="line144"><font color="#000000">144:</font></a> <b><font color="#0000FF">@kindex</font></b> C-x C-k r
<a name="line145"><font color="#000000">145:</font></a>   The command <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x C-k r}</font> (<b><font color="#0000FF">@code</font></b><font color="#009900">{apply-macro-to-region-lines}</font>)
<a name="line146"><font color="#000000">146:</font></a> repeats the last defined keyboard macro on each line that begins in
<a name="line147"><font color="#000000">147:</font></a> the region.  It does this line by line, by moving point to the
<a name="line148"><font color="#000000">148:</font></a> beginning of the line and then executing the macro.
<a name="line149"><font color="#000000">149:</font></a> 
<a name="line150"><font color="#000000">150:</font></a> <b><font color="#0000FF">@kindex</font></b> C-x (
<a name="line151"><font color="#000000">151:</font></a> <b><font color="#0000FF">@kindex</font></b> C-x )
<a name="line152"><font color="#000000">152:</font></a> <b><font color="#0000FF">@kindex</font></b> C-x e
<a name="line153"><font color="#000000">153:</font></a> <b><font color="#0000FF">@findex</font></b> kmacro-start-macro
<a name="line154"><font color="#000000">154:</font></a> <b><font color="#0000FF">@findex</font></b> kmacro-end-macro
<a name="line155"><font color="#000000">155:</font></a>   In addition to the <b><font color="#0000FF">@key</font></b><font color="#009900">{F3}</font> and <b><font color="#0000FF">@key</font></b><font color="#009900">{F4}</font> commands described above,
<a name="line156"><font color="#000000">156:</font></a> Emacs also supports an older set of key bindings for defining and
<a name="line157"><font color="#000000">157:</font></a> executing keyboard macros.  To begin a macro definition, type <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x</font>
<a name="line158"><font color="#000000">158:</font></a> <font color="#009900">(}</font> (<b><font color="#0000FF">@code</font></b><font color="#009900">{kmacro-start-macro}</font>); as with <b><font color="#0000FF">@key</font></b><font color="#009900">{F3}</font>, a prefix argument
<a name="line159"><font color="#000000">159:</font></a> appends this definition to the last keyboard macro.  To end a macro
<a name="line160"><font color="#000000">160:</font></a> definition, type <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x )}</font> (<b><font color="#0000FF">@code</font></b><font color="#009900">{kmacro-end-macro}</font>).  To execute
<a name="line161"><font color="#000000">161:</font></a> the most recent macro, type <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x e}</font>
<a name="line162"><font color="#000000">162:</font></a> (<b><font color="#0000FF">@code</font></b><font color="#009900">{kmacro-end-and-call-macro}</font>).  If you enter <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x e}</font> while
<a name="line163"><font color="#000000">163:</font></a> defining a macro, the macro is terminated and executed immediately.
<a name="line164"><font color="#000000">164:</font></a> Immediately after typing <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x e}</font>, you can type <b><font color="#0000FF">@kbd</font></b><font color="#009900">{e}</font> repeatedly
<a name="line165"><font color="#000000">165:</font></a> to immediately repeat the macro one or more times.  You can also give
<a name="line166"><font color="#000000">166:</font></a> <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x e}</font> a repeat argument, just like <b><font color="#0000FF">@key</font></b><font color="#009900">{F4}</font> (when it is used to
<a name="line167"><font color="#000000">167:</font></a> execute a macro).
<a name="line168"><font color="#000000">168:</font></a> 
<a name="line169"><font color="#000000">169:</font></a>   <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x )}</font> can be given a repeat count as an argument.  This means
<a name="line170"><font color="#000000">170:</font></a> to repeat the macro right after defining it.  The macro definition
<a name="line171"><font color="#000000">171:</font></a> itself counts as the first repetition, since it is executed as you
<a name="line172"><font color="#000000">172:</font></a> define it, so <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-u 4 C-x )}</font> executes the macro immediately 3
<a name="line173"><font color="#000000">173:</font></a> additional times.
<a name="line174"><font color="#000000">174:</font></a> 
<a name="line175"><font color="#000000">175:</font></a> <b><font color="#0000FF">@node</font></b> Keyboard Macro Ring
<a name="line176"><font color="#000000">176:</font></a> <b><font color="#0000FF">@section</font></b> The Keyboard Macro Ring
<a name="line177"><font color="#000000">177:</font></a> 
<a name="line178"><font color="#000000">178:</font></a>   All defined keyboard macros are recorded in the <b><font color="#0000FF">@dfn</font></b><font color="#009900">{keyboard macro</font>
<a name="line179"><font color="#000000">179:</font></a> <font color="#009900">ring}</font>.  There is only one keyboard macro ring, shared by all buffers.
<a name="line180"><font color="#000000">180:</font></a> 
<a name="line181"><font color="#000000">181:</font></a> <b><font color="#0000FF">@table</font></b> <b><font color="#0000FF">@kbd</font></b>
<a name="line182"><font color="#000000">182:</font></a> <b><font color="#0000FF">@item</font></b> C-x C-k C-k
<a name="line183"><font color="#000000">183:</font></a> Execute the keyboard macro at the head of the ring (<b><font color="#0000FF">@code</font></b><font color="#009900">{kmacro-end-or-call-macro-repeat}</font>).
<a name="line184"><font color="#000000">184:</font></a> <b><font color="#0000FF">@item</font></b> C-x C-k C-n
<a name="line185"><font color="#000000">185:</font></a> Rotate the keyboard macro ring to the next macro (defined earlier)
<a name="line186"><font color="#000000">186:</font></a> (<b><font color="#0000FF">@code</font></b><font color="#009900">{kmacro-cycle-ring-next}</font>).
<a name="line187"><font color="#000000">187:</font></a> <b><font color="#0000FF">@item</font></b> C-x C-k C-p
<a name="line188"><font color="#000000">188:</font></a> Rotate the keyboard macro ring to the previous macro (defined later)
<a name="line189"><font color="#000000">189:</font></a> (<b><font color="#0000FF">@code</font></b><font color="#009900">{kmacro-cycle-ring-previous}</font>).
<a name="line190"><font color="#000000">190:</font></a> <b><font color="#0000FF">@end table</font></b>
<a name="line191"><font color="#000000">191:</font></a> 
<a name="line192"><font color="#000000">192:</font></a>   All commands which operate on the keyboard macro ring use the
<a name="line193"><font color="#000000">193:</font></a> same <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x C-k}</font> prefix.  Most of these commands can be executed and
<a name="line194"><font color="#000000">194:</font></a> repeated immediately after each other without repeating the <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x</font>
<a name="line195"><font color="#000000">195:</font></a> <font color="#009900">C-k}</font> prefix.  For example,
<a name="line196"><font color="#000000">196:</font></a> 
<a name="line197"><font color="#000000">197:</font></a> <b><font color="#0000FF">@example</font></b>
<a name="line198"><font color="#000000">198:</font></a> C-x C-k C-p C-p C-k C-k C-k C-n C-n C-k C-p C-k C-d
<a name="line199"><font color="#000000">199:</font></a> <b><font color="#0000FF">@end example</font></b>
<a name="line200"><font color="#000000">200:</font></a> 
<a name="line201"><font color="#000000">201:</font></a> <b><font color="#0000FF">@noindent</font></b>
<a name="line202"><font color="#000000">202:</font></a> will rotate the keyboard macro ring to the second-previous macro,
<a name="line203"><font color="#000000">203:</font></a> execute the resulting head macro three times, rotate back to the
<a name="line204"><font color="#000000">204:</font></a> original head macro, execute that once, rotate to the previous
<a name="line205"><font color="#000000">205:</font></a> macro, execute that, and finally delete it from the macro ring.
<a name="line206"><font color="#000000">206:</font></a> 
<a name="line207"><font color="#000000">207:</font></a> <b><font color="#0000FF">@findex</font></b> kmacro-end-or-call-macro-repeat
<a name="line208"><font color="#000000">208:</font></a> <b><font color="#0000FF">@kindex</font></b> C-x C-k C-k
<a name="line209"><font color="#000000">209:</font></a>   The command <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x C-k C-k}</font> (<b><font color="#0000FF">@code</font></b><font color="#009900">{kmacro-end-or-call-macro-repeat}</font>)
<a name="line210"><font color="#000000">210:</font></a> executes the keyboard macro at the head of the macro ring.  You can
<a name="line211"><font color="#000000">211:</font></a> repeat the macro immediately by typing another <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-k}</font>, or you can
<a name="line212"><font color="#000000">212:</font></a> rotate the macro ring immediately by typing <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-n}</font> or <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-p}</font>.
<a name="line213"><font color="#000000">213:</font></a> 
<a name="line214"><font color="#000000">214:</font></a>   When a keyboard macro is being defined, <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x C-k C-k}</font> behaves
<a name="line215"><font color="#000000">215:</font></a> like <b><font color="#0000FF">@key</font></b><font color="#009900">{F4}</font> except that, immediately afterward, you can use most key
<a name="line216"><font color="#000000">216:</font></a> bindings of this section without the <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x C-k}</font> prefix.  For
<a name="line217"><font color="#000000">217:</font></a> instance, another <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-k}</font> will re-execute the macro.
<a name="line218"><font color="#000000">218:</font></a> 
<a name="line219"><font color="#000000">219:</font></a> <b><font color="#0000FF">@findex</font></b> kmacro-cycle-ring-next
<a name="line220"><font color="#000000">220:</font></a> <b><font color="#0000FF">@kindex</font></b> C-x C-k C-n
<a name="line221"><font color="#000000">221:</font></a> <b><font color="#0000FF">@findex</font></b> kmacro-cycle-ring-previous
<a name="line222"><font color="#000000">222:</font></a> <b><font color="#0000FF">@kindex</font></b> C-x C-k C-p
<a name="line223"><font color="#000000">223:</font></a>   The commands <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x C-k C-n}</font> (<b><font color="#0000FF">@code</font></b><font color="#009900">{kmacro-cycle-ring-next}</font>) and
<a name="line224"><font color="#000000">224:</font></a> <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x C-k C-p}</font> (<b><font color="#0000FF">@code</font></b><font color="#009900">{kmacro-cycle-ring-previous}</font>) rotate the
<a name="line225"><font color="#000000">225:</font></a> macro ring, bringing the next or previous keyboard macro to the head
<a name="line226"><font color="#000000">226:</font></a> of the macro ring.  The definition of the new head macro is displayed
<a name="line227"><font color="#000000">227:</font></a> in the echo area.  You can continue to rotate the macro ring
<a name="line228"><font color="#000000">228:</font></a> immediately by repeating just <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-n}</font> and <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-p}</font> until the
<a name="line229"><font color="#000000">229:</font></a> desired macro is at the head of the ring.  To execute the new macro
<a name="line230"><font color="#000000">230:</font></a> ring head immediately, just type <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-k}</font>.
<a name="line231"><font color="#000000">231:</font></a> 
<a name="line232"><font color="#000000">232:</font></a>   Note that Emacs treats the head of the macro ring as the last
<a name="line233"><font color="#000000">233:</font></a> defined keyboard macro.  For instance, <b><font color="#0000FF">@key</font></b><font color="#009900">{F4}</font> will execute that
<a name="line234"><font color="#000000">234:</font></a> macro, and <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x C-k n}</font> will give it a name.
<a name="line235"><font color="#000000">235:</font></a> 
<a name="line236"><font color="#000000">236:</font></a> <b><font color="#0000FF">@vindex</font></b> kmacro-ring-max
<a name="line237"><font color="#000000">237:</font></a>   The maximum number of macros stored in the keyboard macro ring is
<a name="line238"><font color="#000000">238:</font></a> determined by the customizable variable <b><font color="#0000FF">@code</font></b><font color="#009900">{kmacro-ring-max}</font>.
<a name="line239"><font color="#000000">239:</font></a> 
<a name="line240"><font color="#000000">240:</font></a> <b><font color="#0000FF">@node</font></b> Keyboard Macro Counter
<a name="line241"><font color="#000000">241:</font></a> <b><font color="#0000FF">@section</font></b> The Keyboard Macro Counter
<a name="line242"><font color="#000000">242:</font></a> 
<a name="line243"><font color="#000000">243:</font></a>   Each keyboard macro has an associated counter, which is initialized
<a name="line244"><font color="#000000">244:</font></a> to 0 when you start defining the macro.  This counter allows you to
<a name="line245"><font color="#000000">245:</font></a> insert a number into the buffer that depends on the number of times
<a name="line246"><font color="#000000">246:</font></a> the macro has been called.  The counter is incremented each time its
<a name="line247"><font color="#000000">247:</font></a> value is inserted into the buffer.
<a name="line248"><font color="#000000">248:</font></a> 
<a name="line249"><font color="#000000">249:</font></a> <b><font color="#0000FF">@table</font></b> <b><font color="#0000FF">@kbd</font></b>
<a name="line250"><font color="#000000">250:</font></a> <b><font color="#0000FF">@item</font></b> <b><font color="#0000FF">@key</font></b><font color="#009900">{F3}</font>
<a name="line251"><font color="#000000">251:</font></a> In a keyboard macro definition, insert the keyboard macro counter
<a name="line252"><font color="#000000">252:</font></a> value in the buffer (<b><font color="#0000FF">@code</font></b><font color="#009900">{kmacro-start-macro-or-insert-counter}</font>).
<a name="line253"><font color="#000000">253:</font></a> <b><font color="#0000FF">@item</font></b> C-x C-k C-i
<a name="line254"><font color="#000000">254:</font></a> Insert the keyboard macro counter value in the buffer
<a name="line255"><font color="#000000">255:</font></a> (<b><font color="#0000FF">@code</font></b><font color="#009900">{kmacro-insert-counter}</font>).
<a name="line256"><font color="#000000">256:</font></a> <b><font color="#0000FF">@item</font></b> C-x C-k C-c
<a name="line257"><font color="#000000">257:</font></a> Set the keyboard macro counter (<b><font color="#0000FF">@code</font></b><font color="#009900">{kmacro-set-counter}</font>).
<a name="line258"><font color="#000000">258:</font></a> <b><font color="#0000FF">@item</font></b> C-x C-k C-a
<a name="line259"><font color="#000000">259:</font></a> Add the prefix arg to the keyboard macro counter (<b><font color="#0000FF">@code</font></b><font color="#009900">{kmacro-add-counter}</font>).
<a name="line260"><font color="#000000">260:</font></a> <b><font color="#0000FF">@item</font></b> C-x C-k C-f
<a name="line261"><font color="#000000">261:</font></a> Specify the format for inserting the keyboard macro counter
<a name="line262"><font color="#000000">262:</font></a> (<b><font color="#0000FF">@code</font></b><font color="#009900">{kmacro-set-format}</font>).
<a name="line263"><font color="#000000">263:</font></a> <b><font color="#0000FF">@end table</font></b>
<a name="line264"><font color="#000000">264:</font></a> 
<a name="line265"><font color="#000000">265:</font></a> <b><font color="#0000FF">@findex</font></b> kmacro-insert-counter
<a name="line266"><font color="#000000">266:</font></a> <b><font color="#0000FF">@kindex</font></b> C-x C-k C-i
<a name="line267"><font color="#000000">267:</font></a>   When you are defining a keyboard macro, the command <b><font color="#0000FF">@key</font></b><font color="#009900">{F3}</font>
<a name="line268"><font color="#000000">268:</font></a> (<b><font color="#0000FF">@code</font></b><font color="#009900">{kmacro-start-macro-or-insert-counter}</font>) inserts the current
<a name="line269"><font color="#000000">269:</font></a> value of the keyboard macro's counter into the buffer, and increments
<a name="line270"><font color="#000000">270:</font></a> the counter by 1.  (If you are not defining a macro, <b><font color="#0000FF">@key</font></b><font color="#009900">{F3}</font> begins a
<a name="line271"><font color="#000000">271:</font></a> macro definition instead.  <b><font color="#0000FF">@xref</font></b><font color="#FF0000">{</font><font color="#FF0000">Basic Keyboard Macro</font><font color="#FF0000">}</font>.)  You can use
<a name="line272"><font color="#000000">272:</font></a> a numeric prefix argument to specify a different increment.  If you
<a name="line273"><font color="#000000">273:</font></a> just specify a <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-u}</font> prefix, that is the same as an increment of
<a name="line274"><font color="#000000">274:</font></a> zero: it inserts the current counter value without changing it.
<a name="line275"><font color="#000000">275:</font></a> 
<a name="line276"><font color="#000000">276:</font></a>   As an example, let us show how the keyboard macro counter can be
<a name="line277"><font color="#000000">277:</font></a> used to build a numbered list.  Consider the following key sequence:
<a name="line278"><font color="#000000">278:</font></a> 
<a name="line279"><font color="#000000">279:</font></a> <b><font color="#0000FF">@example</font></b>
<a name="line280"><font color="#000000">280:</font></a> <b><font color="#0000FF">@key</font></b><font color="#009900">{F3}</font> C-a <b><font color="#0000FF">@key</font></b><font color="#009900">{F3}</font> . <b><font color="#0000FF">@key</font></b><font color="#009900">{SPC}</font> <b><font color="#0000FF">@key</font></b><font color="#009900">{F4}</font>
<a name="line281"><font color="#000000">281:</font></a> <b><font color="#0000FF">@end example</font></b>
<a name="line282"><font color="#000000">282:</font></a> 
<a name="line283"><font color="#000000">283:</font></a> <b><font color="#0000FF">@noindent</font></b>
<a name="line284"><font color="#000000">284:</font></a> As part of this keyboard macro definition, the string <b><font color="#0000FF">@samp</font></b><font color="#009900">{0. }</font> was
<a name="line285"><font color="#000000">285:</font></a> inserted into the beginning of the current line.  If you now move
<a name="line286"><font color="#000000">286:</font></a> somewhere else in the buffer and type <b><font color="#0000FF">@key</font></b><font color="#009900">{F4}</font> to invoke the macro,
<a name="line287"><font color="#000000">287:</font></a> the string <b><font color="#0000FF">@samp</font></b><font color="#009900">{1. }</font> is inserted at the beginning of that line.
<a name="line288"><font color="#000000">288:</font></a> Subsequent invocations insert <b><font color="#0000FF">@samp</font></b><font color="#009900">{2. }</font>, <b><font color="#0000FF">@samp</font></b><font color="#009900">{3. }</font>, and so forth.
<a name="line289"><font color="#000000">289:</font></a> 
<a name="line290"><font color="#000000">290:</font></a>   The command <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x C-k C-i}</font> (<b><font color="#0000FF">@code</font></b><font color="#009900">{kmacro-insert-counter}</font>) does
<a name="line291"><font color="#000000">291:</font></a> the same thing as <b><font color="#0000FF">@key</font></b><font color="#009900">{F3}</font>, but it can be used outside a keyboard
<a name="line292"><font color="#000000">292:</font></a> macro definition.  When no keyboard macro is being defined or
<a name="line293"><font color="#000000">293:</font></a> executed, it inserts and increments the counter of the macro at the
<a name="line294"><font color="#000000">294:</font></a> head of the keyboard macro ring.
<a name="line295"><font color="#000000">295:</font></a> 
<a name="line296"><font color="#000000">296:</font></a> <b><font color="#0000FF">@findex</font></b> kmacro-set-counter
<a name="line297"><font color="#000000">297:</font></a> <b><font color="#0000FF">@kindex</font></b> C-x C-k C-c
<a name="line298"><font color="#000000">298:</font></a>   The command <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x C-k C-c}</font> (<b><font color="#0000FF">@code</font></b><font color="#009900">{kmacro-set-counter}</font>) sets the
<a name="line299"><font color="#000000">299:</font></a> current macro counter to the value of the numeric argument.  If you use
<a name="line300"><font color="#000000">300:</font></a> it inside the macro, it operates on each repetition of the macro.  If
<a name="line301"><font color="#000000">301:</font></a> you specify just <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-u}</font> as the prefix, while executing the macro,
<a name="line302"><font color="#000000">302:</font></a> that resets the counter to the value it had at the beginning of the
<a name="line303"><font color="#000000">303:</font></a> current repetition of the macro (undoing any increments so far in this
<a name="line304"><font color="#000000">304:</font></a> repetition).
<a name="line305"><font color="#000000">305:</font></a> 
<a name="line306"><font color="#000000">306:</font></a> <b><font color="#0000FF">@findex</font></b> kmacro-add-counter
<a name="line307"><font color="#000000">307:</font></a> <b><font color="#0000FF">@kindex</font></b> C-x C-k C-a
<a name="line308"><font color="#000000">308:</font></a>   The command <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x C-k C-a}</font> (<b><font color="#0000FF">@code</font></b><font color="#009900">{kmacro-add-counter}</font>) adds the
<a name="line309"><font color="#000000">309:</font></a> prefix argument to the current macro counter.  With just <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-u}</font> as
<a name="line310"><font color="#000000">310:</font></a> argument, it resets the counter to the last value inserted by any
<a name="line311"><font color="#000000">311:</font></a> keyboard macro.  (Normally, when you use this, the last insertion
<a name="line312"><font color="#000000">312:</font></a> will be in the same macro and it will be the same counter.)
<a name="line313"><font color="#000000">313:</font></a> 
<a name="line314"><font color="#000000">314:</font></a> <b><font color="#0000FF">@findex</font></b> kmacro-set-format
<a name="line315"><font color="#000000">315:</font></a> <b><font color="#0000FF">@kindex</font></b> C-x C-k C-f
<a name="line316"><font color="#000000">316:</font></a>   The command <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x C-k C-f}</font> (<b><font color="#0000FF">@code</font></b><font color="#009900">{kmacro-set-format}</font>) prompts for
<a name="line317"><font color="#000000">317:</font></a> the format to use when inserting the macro counter.  The default
<a name="line318"><font color="#000000">318:</font></a> format is <b><font color="#0000FF">@samp</font></b><font color="#009900">{%d}</font>, which means to insert the number in decimal
<a name="line319"><font color="#000000">319:</font></a> without any padding.  You can exit with empty minibuffer to reset the
<a name="line320"><font color="#000000">320:</font></a> format to this default.  You can specify any format string that the
<a name="line321"><font color="#000000">321:</font></a> <i><font color="#9A1900">@code{format} function accepts and that makes sense with a single</font></i>
<a name="line322"><font color="#000000">322:</font></a> integer extra argument (<b><font color="#0000FF">@pxref</font></b><font color="#FF0000">{</font><font color="#FF0000">Formatting Strings,,, elisp, The Emacs</font>
<a name="line323"><font color="#000000">323:</font></a> <font color="#FF0000">Lisp Reference Manual</font><font color="#FF0000">}</font>).  Do not put the format string inside double
<a name="line324"><font color="#000000">324:</font></a> quotes when you insert it in the minibuffer.
<a name="line325"><font color="#000000">325:</font></a> 
<a name="line326"><font color="#000000">326:</font></a>   If you use this command while no keyboard macro is being defined or
<a name="line327"><font color="#000000">327:</font></a> executed, the new format affects all subsequent macro definitions.
<a name="line328"><font color="#000000">328:</font></a> Existing macros continue to use the format in effect when they were
<a name="line329"><font color="#000000">329:</font></a> defined.  If you set the format while defining a keyboard macro, this
<a name="line330"><font color="#000000">330:</font></a> affects the macro being defined from that point on, but it does not
<a name="line331"><font color="#000000">331:</font></a> affect subsequent macros.  Execution of the macro will, at each step,
<a name="line332"><font color="#000000">332:</font></a> use the format in effect at that step during its definition.  Changes
<a name="line333"><font color="#000000">333:</font></a> to the macro format during execution of a macro, like the
<a name="line334"><font color="#000000">334:</font></a> corresponding changes during its definition, have no effect on
<a name="line335"><font color="#000000">335:</font></a> subsequent macros.
<a name="line336"><font color="#000000">336:</font></a> 
<a name="line337"><font color="#000000">337:</font></a>   The format set by <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x C-k C-f}</font> does not affect insertion of
<a name="line338"><font color="#000000">338:</font></a> numbers stored in registers.
<a name="line339"><font color="#000000">339:</font></a> 
<a name="line340"><font color="#000000">340:</font></a>   If you use a register as a counter, incrementing it on each
<a name="line341"><font color="#000000">341:</font></a> repetition of the macro, that accomplishes the same thing as a
<a name="line342"><font color="#000000">342:</font></a> keyboard macro counter.  <b><font color="#0000FF">@xref</font></b><font color="#FF0000">{</font><font color="#FF0000">Number Registers</font><font color="#FF0000">}</font>.  For most purposes,
<a name="line343"><font color="#000000">343:</font></a> it is simpler to use a keyboard macro counter.
<a name="line344"><font color="#000000">344:</font></a> 
<a name="line345"><font color="#000000">345:</font></a> <b><font color="#0000FF">@node</font></b> Keyboard Macro Query
<a name="line346"><font color="#000000">346:</font></a> <b><font color="#0000FF">@section</font></b> Executing Macros with Variations
<a name="line347"><font color="#000000">347:</font></a> 
<a name="line348"><font color="#000000">348:</font></a>   In a keyboard macro, you can create an effect similar to that of
<a name="line349"><font color="#000000">349:</font></a> <i><font color="#9A1900">@code{query-replace}, in that the macro asks you each time around</font></i>
<a name="line350"><font color="#000000">350:</font></a> whether to make a change.
<a name="line351"><font color="#000000">351:</font></a> 
<a name="line352"><font color="#000000">352:</font></a> <b><font color="#0000FF">@table</font></b> <b><font color="#0000FF">@kbd</font></b>
<a name="line353"><font color="#000000">353:</font></a> <b><font color="#0000FF">@item</font></b> C-x q
<a name="line354"><font color="#000000">354:</font></a> When this point is reached during macro execution, ask for confirmation
<a name="line355"><font color="#000000">355:</font></a> (<b><font color="#0000FF">@code</font></b><font color="#009900">{kbd-macro-query}</font>).
<a name="line356"><font color="#000000">356:</font></a> <b><font color="#0000FF">@end table</font></b>
<a name="line357"><font color="#000000">357:</font></a> 
<a name="line358"><font color="#000000">358:</font></a> <b><font color="#0000FF">@kindex</font></b> C-x q
<a name="line359"><font color="#000000">359:</font></a> <b><font color="#0000FF">@findex</font></b> kbd-macro-query
<a name="line360"><font color="#000000">360:</font></a>   While defining the macro, type <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x q}</font> at the point where you
<a name="line361"><font color="#000000">361:</font></a> want the query to occur.  During macro definition, the <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x q}</font>
<a name="line362"><font color="#000000">362:</font></a> does nothing, but when you run the macro later, <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x q}</font> asks you
<a name="line363"><font color="#000000">363:</font></a> interactively whether to continue.
<a name="line364"><font color="#000000">364:</font></a> 
<a name="line365"><font color="#000000">365:</font></a>   The valid responses when <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x q}</font> asks are:
<a name="line366"><font color="#000000">366:</font></a> 
<a name="line367"><font color="#000000">367:</font></a> <b><font color="#0000FF">@table</font></b> <b><font color="#0000FF">@asis</font></b>
<a name="line368"><font color="#000000">368:</font></a> <b><font color="#0000FF">@item</font></b> <b><font color="#0000FF">@key</font></b><font color="#009900">{SPC}</font> (or <b><font color="#0000FF">@kbd</font></b><font color="#009900">{y}</font>)
<a name="line369"><font color="#000000">369:</font></a> Continue executing the keyboard macro.
<a name="line370"><font color="#000000">370:</font></a> 
<a name="line371"><font color="#000000">371:</font></a> <b><font color="#0000FF">@item</font></b> <b><font color="#0000FF">@key</font></b><font color="#009900">{DEL}</font> (or <b><font color="#0000FF">@kbd</font></b><font color="#009900">{n}</font>)
<a name="line372"><font color="#000000">372:</font></a> Skip the remainder of this repetition of the macro, and start right
<a name="line373"><font color="#000000">373:</font></a> away with the next repetition.
<a name="line374"><font color="#000000">374:</font></a> 
<a name="line375"><font color="#000000">375:</font></a> <b><font color="#0000FF">@item</font></b> <b><font color="#0000FF">@key</font></b><font color="#009900">{RET}</font> (or <b><font color="#0000FF">@kbd</font></b><font color="#009900">{q}</font>)
<a name="line376"><font color="#000000">376:</font></a> Skip the remainder of this repetition and cancel further repetitions.
<a name="line377"><font color="#000000">377:</font></a> 
<a name="line378"><font color="#000000">378:</font></a> <b><font color="#0000FF">@item</font></b> <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-r}</font>
<a name="line379"><font color="#000000">379:</font></a> Enter a recursive editing level, in which you can perform editing
<a name="line380"><font color="#000000">380:</font></a> which is not part of the macro.  When you exit the recursive edit
<a name="line381"><font color="#000000">381:</font></a> using <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-M-c}</font>, you are asked again how to continue with the
<a name="line382"><font color="#000000">382:</font></a> keyboard macro.  If you type a <b><font color="#0000FF">@key</font></b><font color="#009900">{SPC}</font> at this time, the rest of the
<a name="line383"><font color="#000000">383:</font></a> macro definition is executed.  It is up to you to leave point and the
<a name="line384"><font color="#000000">384:</font></a> text in a state such that the rest of the macro will do what you want.
<a name="line385"><font color="#000000">385:</font></a> <b><font color="#0000FF">@end table</font></b>
<a name="line386"><font color="#000000">386:</font></a> 
<a name="line387"><font color="#000000">387:</font></a>   <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-u C-x q}</font>, which is <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x q}</font> with a numeric argument,
<a name="line388"><font color="#000000">388:</font></a> performs a completely different function.  It enters a recursive edit
<a name="line389"><font color="#000000">389:</font></a> reading input from the keyboard, both when you type it during the
<a name="line390"><font color="#000000">390:</font></a> definition of the macro, and when it is executed from the macro.  During
<a name="line391"><font color="#000000">391:</font></a> definition, the editing you do inside the recursive edit does not become
<a name="line392"><font color="#000000">392:</font></a> part of the macro.  During macro execution, the recursive edit gives you
<a name="line393"><font color="#000000">393:</font></a> a chance to do some particularized editing on each repetition.
<a name="line394"><font color="#000000">394:</font></a> <b><font color="#0000FF">@xref</font></b><font color="#FF0000">{</font><font color="#FF0000">Recursive Edit</font><font color="#FF0000">}</font>.
<a name="line395"><font color="#000000">395:</font></a> 
<a name="line396"><font color="#000000">396:</font></a> <b><font color="#0000FF">@node</font></b> Save Keyboard Macro
<a name="line397"><font color="#000000">397:</font></a> <b><font color="#0000FF">@section</font></b> Naming and Saving Keyboard Macros
<a name="line398"><font color="#000000">398:</font></a> 
<a name="line399"><font color="#000000">399:</font></a> <b><font color="#0000FF">@table</font></b> <b><font color="#0000FF">@kbd</font></b>
<a name="line400"><font color="#000000">400:</font></a> <b><font color="#0000FF">@item</font></b> C-x C-k n
<a name="line401"><font color="#000000">401:</font></a> Give a command name (for the duration of the Emacs session) to the most
<a name="line402"><font color="#000000">402:</font></a> recently defined keyboard macro (<b><font color="#0000FF">@code</font></b><font color="#009900">{kmacro-name-last-macro}</font>).
<a name="line403"><font color="#000000">403:</font></a> <b><font color="#0000FF">@item</font></b> C-x C-k b
<a name="line404"><font color="#000000">404:</font></a> Bind the most recently defined keyboard macro to a key sequence (for
<a name="line405"><font color="#000000">405:</font></a> the duration of the session) (<b><font color="#0000FF">@code</font></b><font color="#009900">{kmacro-bind-to-key}</font>).
<a name="line406"><font color="#000000">406:</font></a> <b><font color="#0000FF">@item</font></b> M-x insert-kbd-macro
<a name="line407"><font color="#000000">407:</font></a> Insert in the buffer a keyboard macro's definition, as Lisp code.
<a name="line408"><font color="#000000">408:</font></a> <b><font color="#0000FF">@end table</font></b>
<a name="line409"><font color="#000000">409:</font></a> 
<a name="line410"><font color="#000000">410:</font></a> <i><font color="#9A1900">@cindex saving keyboard macros</font></i>
<a name="line411"><font color="#000000">411:</font></a> <b><font color="#0000FF">@findex</font></b> kmacro-name-last-macro
<a name="line412"><font color="#000000">412:</font></a> <b><font color="#0000FF">@kindex</font></b> C-x C-k n
<a name="line413"><font color="#000000">413:</font></a>   If you wish to save a keyboard macro for later use, you can give it
<a name="line414"><font color="#000000">414:</font></a> a name using <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x C-k n}</font> (<b><font color="#0000FF">@code</font></b><font color="#009900">{kmacro-name-last-macro}</font>).
<a name="line415"><font color="#000000">415:</font></a> This reads a name as an argument using the minibuffer and defines that
<a name="line416"><font color="#000000">416:</font></a> name to execute the last keyboard macro, in its current form.  (If you
<a name="line417"><font color="#000000">417:</font></a> later add to the definition of this macro, that does not alter the
<a name="line418"><font color="#000000">418:</font></a> name's definition as a macro.)  The macro name is a Lisp symbol, and
<a name="line419"><font color="#000000">419:</font></a> defining it in this way makes it a valid command name for calling with
<a name="line420"><font color="#000000">420:</font></a> <b><font color="#0000FF">@kbd</font></b><font color="#009900">{M-x}</font> or for binding a key to with <b><font color="#0000FF">@code</font></b><font color="#009900">{global-set-key}</font>
<a name="line421"><font color="#000000">421:</font></a> (<b><font color="#0000FF">@pxref</font></b><font color="#FF0000">{</font><font color="#FF0000">Keymaps</font><font color="#FF0000">}</font>).  If you specify a name that has a prior definition
<a name="line422"><font color="#000000">422:</font></a> other than a keyboard macro, an error message is shown and nothing is
<a name="line423"><font color="#000000">423:</font></a> changed.
<a name="line424"><font color="#000000">424:</font></a> 
<a name="line425"><font color="#000000">425:</font></a> <i><font color="#9A1900">@cindex binding keyboard macros</font></i>
<a name="line426"><font color="#000000">426:</font></a> <b><font color="#0000FF">@findex</font></b> kmacro-bind-to-key
<a name="line427"><font color="#000000">427:</font></a> <b><font color="#0000FF">@kindex</font></b> C-x C-k b
<a name="line428"><font color="#000000">428:</font></a>   You can also bind the last keyboard macro (in its current form) to a
<a name="line429"><font color="#000000">429:</font></a> key, using <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x C-k b}</font> (<b><font color="#0000FF">@code</font></b><font color="#009900">{kmacro-bind-to-key}</font>) followed by the
<a name="line430"><font color="#000000">430:</font></a> key sequence you want to bind.  You can bind to any key sequence in
<a name="line431"><font color="#000000">431:</font></a> the global keymap, but since most key sequences already have other
<a name="line432"><font color="#000000">432:</font></a> bindings, you should select the key sequence carefully.  If you try to
<a name="line433"><font color="#000000">433:</font></a> bind to a key sequence with an existing binding (in any keymap), this
<a name="line434"><font color="#000000">434:</font></a> command asks you for confirmation before replacing the existing binding.
<a name="line435"><font color="#000000">435:</font></a> 
<a name="line436"><font color="#000000">436:</font></a>   To avoid problems caused by overriding existing bindings, the key
<a name="line437"><font color="#000000">437:</font></a> sequences <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x C-k 0}</font> through <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x C-k 9}</font> and <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x C-k A}</font>
<a name="line438"><font color="#000000">438:</font></a> through <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x C-k Z}</font> are reserved for your own keyboard macro
<a name="line439"><font color="#000000">439:</font></a> bindings.  In fact, to bind to one of these key sequences, you only
<a name="line440"><font color="#000000">440:</font></a> need to type the digit or letter rather than the whole key sequences.
<a name="line441"><font color="#000000">441:</font></a> For example,
<a name="line442"><font color="#000000">442:</font></a> 
<a name="line443"><font color="#000000">443:</font></a> <b><font color="#0000FF">@example</font></b>
<a name="line444"><font color="#000000">444:</font></a> C-x C-k b 4
<a name="line445"><font color="#000000">445:</font></a> <b><font color="#0000FF">@end example</font></b>
<a name="line446"><font color="#000000">446:</font></a> 
<a name="line447"><font color="#000000">447:</font></a> <b><font color="#0000FF">@noindent</font></b>
<a name="line448"><font color="#000000">448:</font></a> will bind the last keyboard macro to the key sequence <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x C-k 4}</font>.
<a name="line449"><font color="#000000">449:</font></a> 
<a name="line450"><font color="#000000">450:</font></a> <b><font color="#0000FF">@findex</font></b> insert-kbd-macro
<a name="line451"><font color="#000000">451:</font></a>   Once a macro has a command name, you can save its definition in a file.
<a name="line452"><font color="#000000">452:</font></a> Then it can be used in another editing session.  First, visit the file
<a name="line453"><font color="#000000">453:</font></a> you want to save the definition in.  Then use this command:
<a name="line454"><font color="#000000">454:</font></a> 
<a name="line455"><font color="#000000">455:</font></a> <b><font color="#0000FF">@example</font></b>
<a name="line456"><font color="#000000">456:</font></a> M-x insert-kbd-macro <b><font color="#0000FF">@key</font></b><font color="#009900">{RET}</font> <b><font color="#0000FF">@var</font></b><font color="#009900">{macroname}</font> <b><font color="#0000FF">@key</font></b><font color="#009900">{RET}</font>
<a name="line457"><font color="#000000">457:</font></a> <b><font color="#0000FF">@end example</font></b>
<a name="line458"><font color="#000000">458:</font></a> 
<a name="line459"><font color="#000000">459:</font></a> <b><font color="#0000FF">@noindent</font></b>
<a name="line460"><font color="#000000">460:</font></a> This inserts some Lisp code that, when executed later, will define the
<a name="line461"><font color="#000000">461:</font></a> same macro with the same definition it has now.  (You don't need to
<a name="line462"><font color="#000000">462:</font></a> understand Lisp code to do this, because <b><font color="#0000FF">@code</font></b><font color="#009900">{insert-kbd-macro}</font> writes
<a name="line463"><font color="#000000">463:</font></a> the Lisp code for you.)  Then save the file.  You can load the file
<a name="line464"><font color="#000000">464:</font></a> later with <b><font color="#0000FF">@code</font></b><font color="#009900">{load-file}</font> (<b><font color="#0000FF">@pxref</font></b><font color="#FF0000">{</font><font color="#FF0000">Lisp Libraries</font><font color="#FF0000">}</font>).  If the file you
<a name="line465"><font color="#000000">465:</font></a> save in is your init file <b><font color="#0000FF">@file</font></b><font color="#009900">{~/.emacs}</font> (<b><font color="#0000FF">@pxref</font></b><font color="#FF0000">{</font><font color="#FF0000">Init File</font><font color="#FF0000">}</font>) then the
<a name="line466"><font color="#000000">466:</font></a> macro will be defined each time you run Emacs.
<a name="line467"><font color="#000000">467:</font></a> 
<a name="line468"><font color="#000000">468:</font></a>   If you give <b><font color="#0000FF">@code</font></b><font color="#009900">{insert-kbd-macro}</font> a numeric argument, it makes
<a name="line469"><font color="#000000">469:</font></a> additional Lisp code to record the keys (if any) that you have bound
<a name="line470"><font color="#000000">470:</font></a> to <b><font color="#0000FF">@var</font></b><font color="#009900">{macroname}</font>, so that the macro will be reassigned the same keys
<a name="line471"><font color="#000000">471:</font></a> when you load the file.
<a name="line472"><font color="#000000">472:</font></a> 
<a name="line473"><font color="#000000">473:</font></a> <b><font color="#0000FF">@node</font></b> Edit Keyboard Macro
<a name="line474"><font color="#000000">474:</font></a> <b><font color="#0000FF">@section</font></b> Editing a Keyboard Macro
<a name="line475"><font color="#000000">475:</font></a> 
<a name="line476"><font color="#000000">476:</font></a> <b><font color="#0000FF">@table</font></b> <b><font color="#0000FF">@kbd</font></b>
<a name="line477"><font color="#000000">477:</font></a> <b><font color="#0000FF">@item</font></b> C-x C-k C-e
<a name="line478"><font color="#000000">478:</font></a> Edit the last defined keyboard macro (<b><font color="#0000FF">@code</font></b><font color="#009900">{kmacro-edit-macro}</font>).
<a name="line479"><font color="#000000">479:</font></a> <b><font color="#0000FF">@item</font></b> C-x C-k e <b><font color="#0000FF">@var</font></b><font color="#009900">{name}</font> <b><font color="#0000FF">@key</font></b><font color="#009900">{RET}</font>
<a name="line480"><font color="#000000">480:</font></a> Edit a previously defined keyboard macro <b><font color="#0000FF">@var</font></b><font color="#009900">{name}</font> (<b><font color="#0000FF">@code</font></b><font color="#009900">{edit-kbd-macro}</font>).
<a name="line481"><font color="#000000">481:</font></a> <b><font color="#0000FF">@item</font></b> C-x C-k l
<a name="line482"><font color="#000000">482:</font></a> Edit the last 300 keystrokes as a keyboard macro
<a name="line483"><font color="#000000">483:</font></a> (<b><font color="#0000FF">@code</font></b><font color="#009900">{kmacro-edit-lossage}</font>).
<a name="line484"><font color="#000000">484:</font></a> <b><font color="#0000FF">@end table</font></b>
<a name="line485"><font color="#000000">485:</font></a> 
<a name="line486"><font color="#000000">486:</font></a> <b><font color="#0000FF">@findex</font></b> kmacro-edit-macro
<a name="line487"><font color="#000000">487:</font></a> <b><font color="#0000FF">@kindex</font></b> C-x C-k C-e
<a name="line488"><font color="#000000">488:</font></a> <b><font color="#0000FF">@kindex</font></b> C-x C-k RET
<a name="line489"><font color="#000000">489:</font></a>   You can edit the last keyboard macro by typing <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x C-k C-e}</font> or
<a name="line490"><font color="#000000">490:</font></a> <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x C-k @key{RET}}</font> (<b><font color="#0000FF">@code</font></b><font color="#009900">{kmacro-edit-macro}</font>).  This formats the
<a name="line491"><font color="#000000">491:</font></a> macro definition in a buffer and enters a specialized major mode for
<a name="line492"><font color="#000000">492:</font></a> editing it.  Type <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-h m}</font> once in that buffer to display details
<a name="line493"><font color="#000000">493:</font></a> of how to edit the macro.  When you are finished editing, type
<a name="line494"><font color="#000000">494:</font></a> <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-c C-c}</font>.
<a name="line495"><font color="#000000">495:</font></a> 
<a name="line496"><font color="#000000">496:</font></a> <b><font color="#0000FF">@findex</font></b> edit-kbd-macro
<a name="line497"><font color="#000000">497:</font></a> <b><font color="#0000FF">@kindex</font></b> C-x C-k e
<a name="line498"><font color="#000000">498:</font></a>   You can edit a named keyboard macro or a macro bound to a key by typing
<a name="line499"><font color="#000000">499:</font></a> <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x C-k e}</font> (<b><font color="#0000FF">@code</font></b><font color="#009900">{edit-kbd-macro}</font>).  Follow that with the
<a name="line500"><font color="#000000">500:</font></a> keyboard input that you would use to invoke the macro---<b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x e}</font> or
<a name="line501"><font color="#000000">501:</font></a> <b><font color="#0000FF">@kbd</font></b><font color="#009900">{M-x @var{name}}</font> or some other key sequence.
<a name="line502"><font color="#000000">502:</font></a> 
<a name="line503"><font color="#000000">503:</font></a> <b><font color="#0000FF">@findex</font></b> kmacro-edit-lossage
<a name="line504"><font color="#000000">504:</font></a> <b><font color="#0000FF">@kindex</font></b> C-x C-k l
<a name="line505"><font color="#000000">505:</font></a>   You can edit the last 300 keystrokes as a macro by typing
<a name="line506"><font color="#000000">506:</font></a> <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x C-k l}</font> (<b><font color="#0000FF">@code</font></b><font color="#009900">{kmacro-edit-lossage}</font>).
<a name="line507"><font color="#000000">507:</font></a> 
<a name="line508"><font color="#000000">508:</font></a> <b><font color="#0000FF">@node</font></b> Keyboard Macro Step-Edit
<a name="line509"><font color="#000000">509:</font></a> <b><font color="#0000FF">@section</font></b> Stepwise Editing a Keyboard Macro
<a name="line510"><font color="#000000">510:</font></a> 
<a name="line511"><font color="#000000">511:</font></a> <b><font color="#0000FF">@findex</font></b> kmacro-step-edit-macro
<a name="line512"><font color="#000000">512:</font></a> <b><font color="#0000FF">@kindex</font></b> C-x C-k SPC
<a name="line513"><font color="#000000">513:</font></a>   You can interactively replay and edit the last keyboard
<a name="line514"><font color="#000000">514:</font></a> macro, one command at a time, by typing <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x C-k @key{SPC}}</font>
<a name="line515"><font color="#000000">515:</font></a> (<b><font color="#0000FF">@code</font></b><font color="#009900">{kmacro-step-edit-macro}</font>).  Unless you quit the macro using
<a name="line516"><font color="#000000">516:</font></a> <b><font color="#0000FF">@kbd</font></b><font color="#009900">{q}</font> or <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-g}</font>, the edited macro replaces the last macro on the
<a name="line517"><font color="#000000">517:</font></a> macro ring.
<a name="line518"><font color="#000000">518:</font></a> 
<a name="line519"><font color="#000000">519:</font></a>   This macro editing feature shows the last macro in the minibuffer
<a name="line520"><font color="#000000">520:</font></a> together with the first (or next) command to be executed, and prompts
<a name="line521"><font color="#000000">521:</font></a> you for an action.  You can enter <b><font color="#0000FF">@kbd</font></b><font color="#009900">{?}</font> to get a summary of your
<a name="line522"><font color="#000000">522:</font></a> options.  These actions are available:
<a name="line523"><font color="#000000">523:</font></a> 
<a name="line524"><font color="#000000">524:</font></a> <b><font color="#0000FF">@itemize</font></b> <b><font color="#0000FF">@bullet</font></b><font color="#009900">{}</font>
<a name="line525"><font color="#000000">525:</font></a> <b><font color="#0000FF">@item</font></b>
<a name="line526"><font color="#000000">526:</font></a> <b><font color="#0000FF">@key</font></b><font color="#009900">{SPC}</font> and <b><font color="#0000FF">@kbd</font></b><font color="#009900">{y}</font> execute the current command, and advance to the
<a name="line527"><font color="#000000">527:</font></a> next command in the keyboard macro.
<a name="line528"><font color="#000000">528:</font></a> <b><font color="#0000FF">@item</font></b>
<a name="line529"><font color="#000000">529:</font></a> <b><font color="#0000FF">@kbd</font></b><font color="#009900">{n}</font>, <b><font color="#0000FF">@kbd</font></b><font color="#009900">{d}</font>, and <b><font color="#0000FF">@key</font></b><font color="#009900">{DEL}</font> skip and delete the current command.
<a name="line530"><font color="#000000">530:</font></a> <b><font color="#0000FF">@item</font></b>
<a name="line531"><font color="#000000">531:</font></a> <b><font color="#0000FF">@kbd</font></b><font color="#009900">{f}</font> skips the current command in this execution of the keyboard
<a name="line532"><font color="#000000">532:</font></a> macro, but doesn't delete it from the macro.
<a name="line533"><font color="#000000">533:</font></a> <b><font color="#0000FF">@item</font></b>
<a name="line534"><font color="#000000">534:</font></a> <b><font color="#0000FF">@key</font></b><font color="#009900">{TAB}</font> executes the current command, as well as all similar
<a name="line535"><font color="#000000">535:</font></a> commands immediately following the current command; for example, <b><font color="#0000FF">@key</font></b><font color="#009900">{TAB}</font>
<a name="line536"><font color="#000000">536:</font></a> may be used to insert a sequence of characters (corresponding to a
<a name="line537"><font color="#000000">537:</font></a> sequence of <b><font color="#0000FF">@code</font></b><font color="#009900">{self-insert-command}</font> commands).
<a name="line538"><font color="#000000">538:</font></a> <b><font color="#0000FF">@item</font></b>
<a name="line539"><font color="#000000">539:</font></a> <b><font color="#0000FF">@kbd</font></b><font color="#009900">{c}</font> continues execution (without further editing) until the end of
<a name="line540"><font color="#000000">540:</font></a> the keyboard macro.  If execution terminates normally, the edited
<a name="line541"><font color="#000000">541:</font></a> macro replaces the original keyboard macro.
<a name="line542"><font color="#000000">542:</font></a> <b><font color="#0000FF">@item</font></b>
<a name="line543"><font color="#000000">543:</font></a> <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-k}</font> skips and deletes the rest of the keyboard macro,
<a name="line544"><font color="#000000">544:</font></a> terminates step-editing, and replaces the original keyboard macro
<a name="line545"><font color="#000000">545:</font></a> with the edited macro.
<a name="line546"><font color="#000000">546:</font></a> <b><font color="#0000FF">@item</font></b>
<a name="line547"><font color="#000000">547:</font></a> <b><font color="#0000FF">@kbd</font></b><font color="#009900">{q}</font> and <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-g}</font> cancels the step-editing of the keyboard macro;
<a name="line548"><font color="#000000">548:</font></a> discarding any changes made to the keyboard macro.
<a name="line549"><font color="#000000">549:</font></a> <b><font color="#0000FF">@item</font></b>
<a name="line550"><font color="#000000">550:</font></a> <b><font color="#0000FF">@kbd</font></b><font color="#009900">{i @var{key}@dots{} C-j}</font> reads and executes a series of key sequences (not
<a name="line551"><font color="#000000">551:</font></a> including the final <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-j}</font>), and inserts them before the current
<a name="line552"><font color="#000000">552:</font></a> command in the keyboard macro, without advancing over the current
<a name="line553"><font color="#000000">553:</font></a> command.
<a name="line554"><font color="#000000">554:</font></a> <b><font color="#0000FF">@item</font></b>
<a name="line555"><font color="#000000">555:</font></a> <b><font color="#0000FF">@kbd</font></b><font color="#009900">{I @var{key}@dots{}}</font> reads one key sequence, executes it, and inserts it
<a name="line556"><font color="#000000">556:</font></a> before the current command in the keyboard macro, without advancing
<a name="line557"><font color="#000000">557:</font></a> over the current command.
<a name="line558"><font color="#000000">558:</font></a> <b><font color="#0000FF">@item</font></b>
<a name="line559"><font color="#000000">559:</font></a> <b><font color="#0000FF">@kbd</font></b><font color="#009900">{r @var{key}@dots{} C-j}</font> reads and executes a series of key sequences (not
<a name="line560"><font color="#000000">560:</font></a> including the final <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-j}</font>), and replaces the current command in
<a name="line561"><font color="#000000">561:</font></a> the keyboard macro with them, advancing over the inserted key
<a name="line562"><font color="#000000">562:</font></a> sequences.
<a name="line563"><font color="#000000">563:</font></a> <b><font color="#0000FF">@item</font></b>
<a name="line564"><font color="#000000">564:</font></a> <b><font color="#0000FF">@kbd</font></b><font color="#009900">{R @var{key}@dots{}}</font> reads one key sequence, executes it, and replaces the
<a name="line565"><font color="#000000">565:</font></a> current command in the keyboard macro with that key sequence,
<a name="line566"><font color="#000000">566:</font></a> advancing over the inserted key sequence.
<a name="line567"><font color="#000000">567:</font></a> <b><font color="#0000FF">@item</font></b>
<a name="line568"><font color="#000000">568:</font></a> <b><font color="#0000FF">@kbd</font></b><font color="#009900">{a @var{key}@dots{} C-j}</font> executes the current command, then reads and
<a name="line569"><font color="#000000">569:</font></a> executes a series of key sequences (not including the final
<a name="line570"><font color="#000000">570:</font></a> <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-j}</font>), and inserts them after the current command in the keyboard
<a name="line571"><font color="#000000">571:</font></a> macro; it then advances over the current command and the inserted key
<a name="line572"><font color="#000000">572:</font></a> sequences.
<a name="line573"><font color="#000000">573:</font></a> <b><font color="#0000FF">@item</font></b>
<a name="line574"><font color="#000000">574:</font></a> <b><font color="#0000FF">@kbd</font></b><font color="#009900">{A @var{key}@dots{} C-j}</font> executes the rest of the commands in the keyboard
<a name="line575"><font color="#000000">575:</font></a> macro, then reads and executes a series of key sequences (not
<a name="line576"><font color="#000000">576:</font></a> including the final <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-j}</font>), and appends them at the end of the
<a name="line577"><font color="#000000">577:</font></a> keyboard macro; it then terminates the step-editing and replaces the
<a name="line578"><font color="#000000">578:</font></a> original keyboard macro with the edited macro.
<a name="line579"><font color="#000000">579:</font></a> <b><font color="#0000FF">@end itemize</font></b>
<a name="line580"><font color="#000000">580:</font></a> </tt></pre>
