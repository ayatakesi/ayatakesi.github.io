<!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><a name="line1"><font color="#000000">0001:</font></a> <i><font color="#9A1900">@c This is part of the Emacs manual.</font></i>
<a name="line2"><font color="#000000">0002:</font></a> <i><font color="#9A1900">@c Copyright (C) 1985-1987, 1993-1995, 1997, 2000-2017 Free Software</font></i>
<a name="line3"><font color="#000000">0003:</font></a> <i><font color="#9A1900">@c Foundation, Inc.</font></i>
<a name="line4"><font color="#000000">0004:</font></a> <i><font color="#9A1900">@c See file emacs.texi for copying conditions.</font></i>
<a name="line5"><font color="#000000">0005:</font></a> <b><font color="#0000FF">@node</font></b> Microsoft Windows
<a name="line6"><font color="#000000">0006:</font></a> <b><font color="#0000FF">@appendix</font></b> Emacs and Microsoft Windows/MS-DOS
<a name="line7"><font color="#000000">0007:</font></a> <i><font color="#9A1900">@cindex Microsoft Windows</font></i>
<a name="line8"><font color="#000000">0008:</font></a> <i><font color="#9A1900">@cindex MS-Windows, Emacs peculiarities</font></i>
<a name="line9"><font color="#000000">0009:</font></a> 
<a name="line10"><font color="#000000">0010:</font></a>   This section describes peculiarities of using Emacs on Microsoft
<a name="line11"><font color="#000000">0011:</font></a> Windows.  Some of these peculiarities are also relevant to Microsoft's
<a name="line12"><font color="#000000">0012:</font></a> older MS-DOS operating system.
<a name="line13"><font color="#000000">0013:</font></a> However, Emacs features that are relevant <b><font color="#0000FF">@emph</font></b><font color="#FF0000">{</font><i><font color="#009900">only</font></i><font color="#FF0000">}</font> to MS-DOS are
<a name="line14"><font color="#000000">0014:</font></a> described in a separate
<a name="line15"><font color="#000000">0015:</font></a> <b><font color="#0000FF">@iftex</font></b>
<a name="line16"><font color="#000000">0016:</font></a> manual (<b><font color="#0000FF">@pxref</font></b><font color="#FF0000">{</font><font color="#FF0000">MS-DOS,,, emacs-xtra, Specialized Emacs Features</font><font color="#FF0000">}</font>).
<a name="line17"><font color="#000000">0017:</font></a> <b><font color="#0000FF">@end iftex</font></b>
<a name="line18"><font color="#000000">0018:</font></a> <b><font color="#0000FF">@ifnottex</font></b>
<a name="line19"><font color="#000000">0019:</font></a> section (<b><font color="#0000FF">@pxref</font></b><font color="#FF0000">{</font><font color="#FF0000">MS-DOS</font><font color="#FF0000">}</font>).
<a name="line20"><font color="#000000">0020:</font></a> <b><font color="#0000FF">@end ifnottex</font></b>
<a name="line21"><font color="#000000">0021:</font></a> 
<a name="line22"><font color="#000000">0022:</font></a> 
<a name="line23"><font color="#000000">0023:</font></a>   The behavior of Emacs on MS-Windows is reasonably similar to what is
<a name="line24"><font color="#000000">0024:</font></a> documented in the rest of the manual, including support for long file
<a name="line25"><font color="#000000">0025:</font></a> names, multiple frames, scroll bars, mouse menus, and subprocesses.
<a name="line26"><font color="#000000">0026:</font></a> However, a few special considerations apply, and they are described
<a name="line27"><font color="#000000">0027:</font></a> here.
<a name="line28"><font color="#000000">0028:</font></a> 
<a name="line29"><font color="#000000">0029:</font></a> <b><font color="#000080">@menu</font></b>
<a name="line30"><font color="#000000">0030:</font></a> <font color="#FF0000">* Windows Startup::</font>     How to start Emacs on Windows.
<a name="line31"><font color="#000000">0031:</font></a> <font color="#FF0000">* Text and Binary::</font>     Text files use CRLF to terminate lines.
<a name="line32"><font color="#000000">0032:</font></a> <font color="#FF0000">* Windows Files::</font>       File-name conventions on Windows.
<a name="line33"><font color="#000000">0033:</font></a> <font color="#FF0000">* ls in Lisp::</font>          Emulation of <b><font color="#0000FF">@code</font></b><font color="#009900">{ls}</font> for Dired.
<a name="line34"><font color="#000000">0034:</font></a> <font color="#FF0000">* Windows HOME::</font>        Where Emacs looks for your <b><font color="#0000FF">@file</font></b><font color="#009900">{.emacs}</font> and
<a name="line35"><font color="#000000">0035:</font></a>                           where it starts up.
<a name="line36"><font color="#000000">0036:</font></a> <font color="#FF0000">* Windows Keyboard::</font>    Windows-specific keyboard features.
<a name="line37"><font color="#000000">0037:</font></a> <font color="#FF0000">* Windows Mouse::</font>       Windows-specific mouse features.
<a name="line38"><font color="#000000">0038:</font></a> <font color="#FF0000">* Windows Processes::</font>   Running subprocesses on Windows.
<a name="line39"><font color="#000000">0039:</font></a> <font color="#FF0000">* Windows Printing::</font>    How to specify the printer on MS-Windows.
<a name="line40"><font color="#000000">0040:</font></a> <font color="#FF0000">* Windows Fonts::</font>       Specifying fonts on MS-Windows.
<a name="line41"><font color="#000000">0041:</font></a> <font color="#FF0000">* Windows Misc::</font>        Miscellaneous Windows features.
<a name="line42"><font color="#000000">0042:</font></a> <b><font color="#0000FF">@ifnottex</font></b>
<a name="line43"><font color="#000000">0043:</font></a> <font color="#FF0000">* MS-DOS::</font>              Using Emacs on MS-DOS.
<a name="line44"><font color="#000000">0044:</font></a> <b><font color="#0000FF">@end ifnottex</font></b>
<a name="line45"><font color="#000000">0045:</font></a> <b><font color="#000080">@end menu</font></b>
<a name="line46"><font color="#000000">0046:</font></a> 
<a name="line47"><font color="#000000">0047:</font></a> <b><font color="#0000FF">@node</font></b> Windows Startup
<a name="line48"><font color="#000000">0048:</font></a> <b><font color="#0000FF">@section</font></b> How to Start Emacs on MS-Windows
<a name="line49"><font color="#000000">0049:</font></a> <i><font color="#9A1900">@cindex starting Emacs on MS-Windows</font></i>
<a name="line50"><font color="#000000">0050:</font></a> 
<a name="line51"><font color="#000000">0051:</font></a>   There are several ways of starting Emacs on MS-Windows:
<a name="line52"><font color="#000000">0052:</font></a> 
<a name="line53"><font color="#000000">0053:</font></a> <b><font color="#0000FF">@enumerate</font></b>
<a name="line54"><font color="#000000">0054:</font></a> <b><font color="#0000FF">@item</font></b>
<a name="line55"><font color="#000000">0055:</font></a> <b><font color="#0000FF">@pindex</font></b> runemacs.exe
<a name="line56"><font color="#000000">0056:</font></a> <i><font color="#9A1900">@cindex desktop shortcut, MS-Windows</font></i>
<a name="line57"><font color="#000000">0057:</font></a> <i><font color="#9A1900">@cindex start directory, MS-Windows</font></i>
<a name="line58"><font color="#000000">0058:</font></a> <i><font color="#9A1900">@cindex directory where Emacs starts on MS-Windows</font></i>
<a name="line59"><font color="#000000">0059:</font></a> From the desktop shortcut icon: either double-click the left mouse
<a name="line60"><font color="#000000">0060:</font></a> button on the icon, or click once, then press <b><font color="#0000FF">@key</font></b><font color="#009900">{RET}</font>.  The desktop
<a name="line61"><font color="#000000">0061:</font></a> shortcut should specify as its ``Target'' (in the ``Properties'' of
<a name="line62"><font color="#000000">0062:</font></a> the shortcut) the full absolute file name of <b><font color="#0000FF">@file</font></b><font color="#009900">{runemacs.exe}</font>,
<a name="line63"><font color="#000000">0063:</font></a> <b><font color="#0000FF">@emph</font></b><font color="#FF0000">{</font><i><font color="#009900">not</font></i><font color="#FF0000">}</font> of <b><font color="#0000FF">@file</font></b><font color="#009900">{emacs.exe}</font>.  This is because <b><font color="#0000FF">@file</font></b><font color="#009900">{runemacs.exe}</font>
<a name="line64"><font color="#000000">0064:</font></a> hides the console window that would have been created if the target of
<a name="line65"><font color="#000000">0065:</font></a> the shortcut were <b><font color="#0000FF">@file</font></b><font color="#009900">{emacs.exe}</font> (which is a console program, as far
<a name="line66"><font color="#000000">0066:</font></a> as Windows is concerned).  If you use this method, Emacs starts in the
<a name="line67"><font color="#000000">0067:</font></a> directory specified by the shortcut.  To control where that is,
<a name="line68"><font color="#000000">0068:</font></a> right-click on the shortcut, select ``Properties'', and in the
<a name="line69"><font color="#000000">0069:</font></a> ``Shortcut'' tab modify the ``Start in'' field to your liking.
<a name="line70"><font color="#000000">0070:</font></a> 
<a name="line71"><font color="#000000">0071:</font></a> <b><font color="#0000FF">@item</font></b>
<a name="line72"><font color="#000000">0072:</font></a> From the Command Prompt window, by typing <b><font color="#0000FF">@kbd</font></b><font color="#009900">{emacs @key{RET}}</font> at the
<a name="line73"><font color="#000000">0073:</font></a> prompt.  The Command Prompt window where you did that will not be
<a name="line74"><font color="#000000">0074:</font></a> available for invoking other commands until Emacs exits.  In this
<a name="line75"><font color="#000000">0075:</font></a> case, Emacs will start in the current directory of the Windows shell.
<a name="line76"><font color="#000000">0076:</font></a> 
<a name="line77"><font color="#000000">0077:</font></a> <b><font color="#0000FF">@item</font></b>
<a name="line78"><font color="#000000">0078:</font></a> From the Command Prompt window, by typing <b><font color="#0000FF">@kbd</font></b><font color="#009900">{runemacs @key{RET}}</font> at
<a name="line79"><font color="#000000">0079:</font></a> the prompt.  The Command Prompt window where you did that will be
<a name="line80"><font color="#000000">0080:</font></a> immediately available for invoking other commands.  In this case,
<a name="line81"><font color="#000000">0081:</font></a> Emacs will start in the current directory of the Windows shell.
<a name="line82"><font color="#000000">0082:</font></a> 
<a name="line83"><font color="#000000">0083:</font></a> <b><font color="#0000FF">@item</font></b>
<a name="line84"><font color="#000000">0084:</font></a> <i><font color="#9A1900">@cindex invoking Emacs from Windows Explorer</font></i>
<a name="line85"><font color="#000000">0085:</font></a> <b><font color="#0000FF">@pindex</font></b> emacsclient.exe
<a name="line86"><font color="#000000">0086:</font></a> <b><font color="#0000FF">@pindex</font></b> emacsclientw.exe
<a name="line87"><font color="#000000">0087:</font></a> Via <b><font color="#0000FF">@file</font></b><font color="#009900">{emacsclient.exe}</font> or <b><font color="#0000FF">@file</font></b><font color="#009900">{emacsclientw.exe}</font>, which allow you
<a name="line88"><font color="#000000">0088:</font></a> to invoke Emacs from other programs, and to reuse a running Emacs
<a name="line89"><font color="#000000">0089:</font></a> process for serving editing jobs required by other programs.
<a name="line90"><font color="#000000">0090:</font></a> <b><font color="#0000FF">@xref</font></b><font color="#FF0000">{</font><font color="#FF0000">Emacs Server</font><font color="#FF0000">}</font>.  The difference between <b><font color="#0000FF">@file</font></b><font color="#009900">{emacsclient.exe}</font>
<a name="line91"><font color="#000000">0091:</font></a> and <b><font color="#0000FF">@file</font></b><font color="#009900">{emacsclientw.exe}</font> is that the former is a console program,
<a name="line92"><font color="#000000">0092:</font></a> while the latter is a Windows GUI program.  Both programs wait for
<a name="line93"><font color="#000000">0093:</font></a> Emacs to signal that the editing job is finished, before they exit and
<a name="line94"><font color="#000000">0094:</font></a> return control to the program that invoked them.  Which one of them to
<a name="line95"><font color="#000000">0095:</font></a> use in each case depends on the expectations of the program that needs
<a name="line96"><font color="#000000">0096:</font></a> editing services.  If that program is itself a console (text-mode)
<a name="line97"><font color="#000000">0097:</font></a> program, you should use <b><font color="#0000FF">@file</font></b><font color="#009900">{emacsclient.exe}</font>, so that any of its
<a name="line98"><font color="#000000">0098:</font></a> messages and prompts appear in the same command window as those of the
<a name="line99"><font color="#000000">0099:</font></a> invoking program.  By contrast, if the invoking program is a GUI
<a name="line100"><font color="#000000">0100:</font></a> program, you will be better off using <b><font color="#0000FF">@file</font></b><font color="#009900">{emacsclientw.exe}</font>, because
<a name="line101"><font color="#000000">0101:</font></a> <b><font color="#0000FF">@file</font></b><font color="#009900">{emacsclient.exe}</font> will pop up a command window if it is invoked
<a name="line102"><font color="#000000">0102:</font></a> from a GUI program.  A notable situation where you would want
<a name="line103"><font color="#000000">0103:</font></a> <b><font color="#0000FF">@file</font></b><font color="#009900">{emacsclientw.exe}</font> is when you right-click on a file in the
<a name="line104"><font color="#000000">0104:</font></a> Windows Explorer and select ``Open With'' from the pop-up menu.  Use
<a name="line105"><font color="#000000">0105:</font></a> the <b><font color="#0000FF">@samp</font></b><font color="#009900">{--alternate-editor=}</font> or <b><font color="#0000FF">@samp</font></b><font color="#009900">{-a}</font> options if Emacs might not
<a name="line106"><font color="#000000">0106:</font></a> be running (or not running as a server) when <b><font color="#0000FF">@command</font></b><font color="#009900">{emacsclient}</font> is
<a name="line107"><font color="#000000">0107:</font></a> invoked---that will always give you an editor.  When invoked via
<a name="line108"><font color="#000000">0108:</font></a> <i><font color="#9A1900">@command{emacsclient}, Emacs will start in the current directory of</font></i>
<a name="line109"><font color="#000000">0109:</font></a> the program that invoked <b><font color="#0000FF">@command</font></b><font color="#009900">{emacsclient}</font>.
<a name="line110"><font color="#000000">0110:</font></a> <b><font color="#0000FF">@end enumerate</font></b>
<a name="line111"><font color="#000000">0111:</font></a> 
<a name="line112"><font color="#000000">0112:</font></a> <i><font color="#9A1900">@cindex emacsclient, on MS-Windows</font></i>
<a name="line113"><font color="#000000">0113:</font></a> Note that, due to limitations of MS-Windows, Emacs cannot have both
<a name="line114"><font color="#000000">0114:</font></a> GUI and text-mode frames in the same session.  It also cannot open
<a name="line115"><font color="#000000">0115:</font></a> text-mode frames on more than a single <b><font color="#0000FF">@dfn</font></b><font color="#009900">{Command Prompt}</font> window,
<a name="line116"><font color="#000000">0116:</font></a> because each Windows program can have only one console at any given
<a name="line117"><font color="#000000">0117:</font></a> time.  For these reasons, if you invoke <b><font color="#0000FF">@command</font></b><font color="#009900">{emacsclient}</font> with the
<a name="line118"><font color="#000000">0118:</font></a> <b><font color="#0000FF">@option</font></b><font color="#009900">{-c}</font> option, and the Emacs server runs in a text-mode session,
<a name="line119"><font color="#000000">0119:</font></a> Emacs will always create a new text-mode frame in the same
<a name="line120"><font color="#000000">0120:</font></a> <b><font color="#0000FF">@dfn</font></b><font color="#009900">{Command Prompt}</font> window where it was started; a GUI frame will be
<a name="line121"><font color="#000000">0121:</font></a> created only if the server runs in a GUI session.  Similarly, if you
<a name="line122"><font color="#000000">0122:</font></a> invoke <b><font color="#0000FF">@command</font></b><font color="#009900">{emacsclient}</font> with the <b><font color="#0000FF">@option</font></b><font color="#009900">{-t}</font> option, Emacs will
<a name="line123"><font color="#000000">0123:</font></a> create a GUI frame if the server runs in a GUI session, or a text-mode
<a name="line124"><font color="#000000">0124:</font></a> frame when the session runs in text mode in a <b><font color="#0000FF">@dfn</font></b><font color="#009900">{Command Prompt}</font>
<a name="line125"><font color="#000000">0125:</font></a> window.  <b><font color="#0000FF">@xref</font></b><font color="#FF0000">{</font><font color="#FF0000">emacsclient Options</font><font color="#FF0000">}</font>.
<a name="line126"><font color="#000000">0126:</font></a> 
<a name="line127"><font color="#000000">0127:</font></a> <b><font color="#0000FF">@node</font></b> Text and Binary
<a name="line128"><font color="#000000">0128:</font></a> <b><font color="#0000FF">@section</font></b> Text Files and Binary Files
<a name="line129"><font color="#000000">0129:</font></a> <i><font color="#9A1900">@cindex text and binary files on MS-DOS/MS-Windows</font></i>
<a name="line130"><font color="#000000">0130:</font></a> 
<a name="line131"><font color="#000000">0131:</font></a>   GNU Emacs uses newline characters to separate text lines.  This is the
<a name="line132"><font color="#000000">0132:</font></a> convention used on GNU, Unix, and other Posix-compliant systems.
<a name="line133"><font color="#000000">0133:</font></a> 
<a name="line134"><font color="#000000">0134:</font></a> <i><font color="#9A1900">@cindex end-of-line conversion on MS-DOS/MS-Windows</font></i>
<a name="line135"><font color="#000000">0135:</font></a>   By contrast, MS-DOS and MS-Windows normally use carriage-return linefeed,
<a name="line136"><font color="#000000">0136:</font></a> a two-character sequence, to separate text lines.  (Linefeed is the same
<a name="line137"><font color="#000000">0137:</font></a> character as newline.)  Therefore, convenient editing of typical files
<a name="line138"><font color="#000000">0138:</font></a> with Emacs requires conversion of these end-of-line (EOL) sequences.
<a name="line139"><font color="#000000">0139:</font></a> And that is what Emacs normally does: it converts carriage-return
<a name="line140"><font color="#000000">0140:</font></a> linefeed into newline when reading files, and converts newline into
<a name="line141"><font color="#000000">0141:</font></a> carriage-return linefeed when writing files.  The same mechanism that
<a name="line142"><font color="#000000">0142:</font></a> handles conversion of international character codes does this conversion
<a name="line143"><font color="#000000">0143:</font></a> also (<b><font color="#0000FF">@pxref</font></b><font color="#FF0000">{</font><font color="#FF0000">Coding Systems</font><font color="#FF0000">}</font>).
<a name="line144"><font color="#000000">0144:</font></a> 
<a name="line145"><font color="#000000">0145:</font></a> <i><font color="#9A1900">@cindex cursor location, on MS-DOS</font></i>
<a name="line146"><font color="#000000">0146:</font></a> <i><font color="#9A1900">@cindex point location, on MS-DOS</font></i>
<a name="line147"><font color="#000000">0147:</font></a>   One consequence of this special format-conversion of most files is
<a name="line148"><font color="#000000">0148:</font></a> that character positions as reported by Emacs (<b><font color="#0000FF">@pxref</font></b><font color="#FF0000">{</font><font color="#FF0000">Position Info</font><font color="#FF0000">}</font>) do
<a name="line149"><font color="#000000">0149:</font></a> not agree with the file size information known to the operating system.
<a name="line150"><font color="#000000">0150:</font></a> 
<a name="line151"><font color="#000000">0151:</font></a>   In addition, if Emacs recognizes from a file's contents that it uses
<a name="line152"><font color="#000000">0152:</font></a> newline rather than carriage-return linefeed as its line separator, it
<a name="line153"><font color="#000000">0153:</font></a> does not perform EOL conversion when reading or writing that file.
<a name="line154"><font color="#000000">0154:</font></a> Thus, you can read and edit files from GNU and Unix systems on MS-DOS
<a name="line155"><font color="#000000">0155:</font></a> with no special effort, and they will retain their Unix-style
<a name="line156"><font color="#000000">0156:</font></a> end-of-line convention after you edit them.
<a name="line157"><font color="#000000">0157:</font></a> 
<a name="line158"><font color="#000000">0158:</font></a>   The mode line indicates whether end-of-line translation was used for
<a name="line159"><font color="#000000">0159:</font></a> the current buffer.  If MS-DOS end-of-line translation is in use for the
<a name="line160"><font color="#000000">0160:</font></a> buffer, the MS-Windows build of Emacs displays a backslash <b><font color="#0000FF">@samp</font></b><font color="#009900">{\}</font> after
<a name="line161"><font color="#000000">0161:</font></a> the coding system mnemonic near the beginning of the mode line
<a name="line162"><font color="#000000">0162:</font></a> (<b><font color="#0000FF">@pxref</font></b><font color="#FF0000">{</font><font color="#FF0000">Mode Line</font><font color="#FF0000">}</font>).  If no EOL translation was performed, the string
<a name="line163"><font color="#000000">0163:</font></a> <b><font color="#0000FF">@samp</font></b><font color="#009900">{(Unix)}</font> is displayed instead of the backslash, to alert you that the
<a name="line164"><font color="#000000">0164:</font></a> file's EOL format is not the usual carriage-return linefeed.
<a name="line165"><font color="#000000">0165:</font></a> 
<a name="line166"><font color="#000000">0166:</font></a> <i><font color="#9A1900">@cindex DOS-to-Unix conversion of files</font></i>
<a name="line167"><font color="#000000">0167:</font></a>   To visit a file and specify whether it uses DOS-style or Unix-style
<a name="line168"><font color="#000000">0168:</font></a> end-of-line, specify a coding system (<b><font color="#0000FF">@pxref</font></b><font color="#FF0000">{</font><font color="#FF0000">Text Coding</font><font color="#FF0000">}</font>).  For
<a name="line169"><font color="#000000">0169:</font></a> example, <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x @key{RET} c unix @key{RET} C-x C-f foobar.txt}</font>
<a name="line170"><font color="#000000">0170:</font></a> visits the file <b><font color="#0000FF">@file</font></b><font color="#009900">{foobar.txt}</font> without converting the EOLs; if some
<a name="line171"><font color="#000000">0171:</font></a> line ends with a carriage-return linefeed pair, Emacs will display
<a name="line172"><font color="#000000">0172:</font></a> <b><font color="#0000FF">@samp</font></b><font color="#009900">{^M}</font> at the end of that line.  Similarly, you can direct Emacs to
<a name="line173"><font color="#000000">0173:</font></a> save a buffer in a specified EOL format with the <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x @key{RET} f}</font>
<a name="line174"><font color="#000000">0174:</font></a> command.  For example, to save a buffer with Unix EOL format, type
<a name="line175"><font color="#000000">0175:</font></a> <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x @key{RET} f unix @key{RET} C-x C-s}</font>.  If you visit a file
<a name="line176"><font color="#000000">0176:</font></a> with DOS EOL conversion, then save it with Unix EOL format, that
<a name="line177"><font color="#000000">0177:</font></a> effectively converts the file to Unix EOL style, like the
<a name="line178"><font color="#000000">0178:</font></a> <i><font color="#9A1900">@code{dos2unix} program.</font></i>
<a name="line179"><font color="#000000">0179:</font></a> 
<a name="line180"><font color="#000000">0180:</font></a> <i><font color="#9A1900">@cindex untranslated file system</font></i>
<a name="line181"><font color="#000000">0181:</font></a> <b><font color="#0000FF">@findex</font></b> add-untranslated-filesystem
<a name="line182"><font color="#000000">0182:</font></a>   When you use NFS, Samba, or some other similar method to access file
<a name="line183"><font color="#000000">0183:</font></a> systems that reside on computers using GNU or Unix systems, Emacs
<a name="line184"><font color="#000000">0184:</font></a> should not perform end-of-line translation on any files in these file
<a name="line185"><font color="#000000">0185:</font></a> systems---not even when you create a new file.  To request this,
<a name="line186"><font color="#000000">0186:</font></a> designate these file systems as <b><font color="#0000FF">@dfn</font></b><font color="#009900">{untranslated}</font> file systems by
<a name="line187"><font color="#000000">0187:</font></a> calling the function <b><font color="#0000FF">@code</font></b><font color="#009900">{add-untranslated-filesystem}</font>.  It takes one
<a name="line188"><font color="#000000">0188:</font></a> argument: the file system name, including a drive letter and
<a name="line189"><font color="#000000">0189:</font></a> optionally a directory.  For example,
<a name="line190"><font color="#000000">0190:</font></a> 
<a name="line191"><font color="#000000">0191:</font></a> <b><font color="#0000FF">@example</font></b>
<a name="line192"><font color="#000000">0192:</font></a> (add-untranslated-filesystem "Z:")
<a name="line193"><font color="#000000">0193:</font></a> <b><font color="#0000FF">@end example</font></b>
<a name="line194"><font color="#000000">0194:</font></a> 
<a name="line195"><font color="#000000">0195:</font></a> <b><font color="#0000FF">@noindent</font></b>
<a name="line196"><font color="#000000">0196:</font></a> designates drive Z as an untranslated file system, and
<a name="line197"><font color="#000000">0197:</font></a> 
<a name="line198"><font color="#000000">0198:</font></a> <b><font color="#0000FF">@example</font></b>
<a name="line199"><font color="#000000">0199:</font></a> (add-untranslated-filesystem "Z:\\foo")
<a name="line200"><font color="#000000">0200:</font></a> <b><font color="#0000FF">@end example</font></b>
<a name="line201"><font color="#000000">0201:</font></a> 
<a name="line202"><font color="#000000">0202:</font></a> <b><font color="#0000FF">@noindent</font></b>
<a name="line203"><font color="#000000">0203:</font></a> designates directory <b><font color="#0000FF">@file</font></b><font color="#009900">{\foo}</font> on drive Z as an untranslated file
<a name="line204"><font color="#000000">0204:</font></a> system.
<a name="line205"><font color="#000000">0205:</font></a> 
<a name="line206"><font color="#000000">0206:</font></a>   Most often you would use <b><font color="#0000FF">@code</font></b><font color="#009900">{add-untranslated-filesystem}</font> in your
<a name="line207"><font color="#000000">0207:</font></a> <b><font color="#0000FF">@file</font></b><font color="#009900">{.emacs}</font> file, or in <b><font color="#0000FF">@file</font></b><font color="#009900">{site-start.el}</font> so that all the users at
<a name="line208"><font color="#000000">0208:</font></a> your site get the benefit of it.
<a name="line209"><font color="#000000">0209:</font></a> 
<a name="line210"><font color="#000000">0210:</font></a> <b><font color="#0000FF">@findex</font></b> remove-untranslated-filesystem
<a name="line211"><font color="#000000">0211:</font></a>   To countermand the effect of <b><font color="#0000FF">@code</font></b><font color="#009900">{add-untranslated-filesystem}</font>, use
<a name="line212"><font color="#000000">0212:</font></a> the function <b><font color="#0000FF">@code</font></b><font color="#009900">{remove-untranslated-filesystem}</font>.  This function takes
<a name="line213"><font color="#000000">0213:</font></a> one argument, which should be a string just like the one that was used
<a name="line214"><font color="#000000">0214:</font></a> previously with <b><font color="#0000FF">@code</font></b><font color="#009900">{add-untranslated-filesystem}</font>.
<a name="line215"><font color="#000000">0215:</font></a> 
<a name="line216"><font color="#000000">0216:</font></a>   Designating a file system as untranslated does not affect character
<a name="line217"><font color="#000000">0217:</font></a> set conversion, only end-of-line conversion.  Essentially, it directs
<a name="line218"><font color="#000000">0218:</font></a> Emacs to create new files with the Unix-style convention of using
<a name="line219"><font color="#000000">0219:</font></a> newline at the end of a line.  <b><font color="#0000FF">@xref</font></b><font color="#FF0000">{</font><font color="#FF0000">Coding Systems</font><font color="#FF0000">}</font>.
<a name="line220"><font color="#000000">0220:</font></a> 
<a name="line221"><font color="#000000">0221:</font></a> <b><font color="#0000FF">@node</font></b> Windows Files
<a name="line222"><font color="#000000">0222:</font></a> <b><font color="#0000FF">@section</font></b> File Names on MS-Windows
<a name="line223"><font color="#000000">0223:</font></a> <i><font color="#9A1900">@cindex file names on MS-Windows</font></i>
<a name="line224"><font color="#000000">0224:</font></a> 
<a name="line225"><font color="#000000">0225:</font></a>   MS-Windows and MS-DOS normally use a backslash, <b><font color="#0000FF">@samp</font></b><font color="#009900">{\}</font>, to
<a name="line226"><font color="#000000">0226:</font></a> separate name units within a file name, instead of the slash used on
<a name="line227"><font color="#000000">0227:</font></a> other systems.  Emacs on MS-DOS/MS-Windows permits use of either slash or
<a name="line228"><font color="#000000">0228:</font></a> backslash, and also knows about drive letters in file names.
<a name="line229"><font color="#000000">0229:</font></a> 
<a name="line230"><font color="#000000">0230:</font></a> <i><font color="#9A1900">@cindex file-name completion, on MS-Windows</font></i>
<a name="line231"><font color="#000000">0231:</font></a>   On MS-DOS/MS-Windows, file names are case-insensitive, so Emacs by
<a name="line232"><font color="#000000">0232:</font></a> default ignores letter-case in file names during completion.
<a name="line233"><font color="#000000">0233:</font></a> 
<a name="line234"><font color="#000000">0234:</font></a> <b><font color="#0000FF">@vindex</font></b> w32-get-true-file-attributes
<a name="line235"><font color="#000000">0235:</font></a>   The variable <b><font color="#0000FF">@code</font></b><font color="#009900">{w32-get-true-file-attributes}</font> controls whether
<a name="line236"><font color="#000000">0236:</font></a> Emacs should issue additional system calls to determine more
<a name="line237"><font color="#000000">0237:</font></a> accurately file attributes in primitives like <b><font color="#0000FF">@code</font></b><font color="#009900">{file-attributes}</font>
<a name="line238"><font color="#000000">0238:</font></a> and <b><font color="#0000FF">@code</font></b><font color="#009900">{directory-files-and-attributes}</font>.  These additional calls are
<a name="line239"><font color="#000000">0239:</font></a> needed to report correct file ownership, link counts and file types
<a name="line240"><font color="#000000">0240:</font></a> for special files such as pipes.  Without these system calls, file
<a name="line241"><font color="#000000">0241:</font></a> ownership will be attributed to the current user, link counts will be
<a name="line242"><font color="#000000">0242:</font></a> always reported as 1, and special files will be reported as regular
<a name="line243"><font color="#000000">0243:</font></a> files.
<a name="line244"><font color="#000000">0244:</font></a> 
<a name="line245"><font color="#000000">0245:</font></a>   If the value of this variable is <b><font color="#0000FF">@code</font></b><font color="#009900">{local}</font> (the default), Emacs
<a name="line246"><font color="#000000">0246:</font></a> will issue these additional system calls only for files on local fixed
<a name="line247"><font color="#000000">0247:</font></a> drives.  Any other non-<b><font color="#0000FF">@code</font></b><font color="#009900">{nil}</font> value means do this even for
<a name="line248"><font color="#000000">0248:</font></a> removable and remote volumes, where this could potentially slow down
<a name="line249"><font color="#000000">0249:</font></a> Dired and other related features.  The value of <b><font color="#0000FF">@code</font></b><font color="#009900">{nil}</font> means never
<a name="line250"><font color="#000000">0250:</font></a> issue those system calls.  Non-<b><font color="#0000FF">@code</font></b><font color="#009900">{nil}</font> values are more useful on
<a name="line251"><font color="#000000">0251:</font></a> NTFS volumes, which support hard links and file security, than on FAT,
<a name="line252"><font color="#000000">0252:</font></a> FAT32, and exFAT volumes.
<a name="line253"><font color="#000000">0253:</font></a> 
<a name="line254"><font color="#000000">0254:</font></a> <i><font color="#9A1900">@cindex file names, invalid characters on MS-Windows</font></i>
<a name="line255"><font color="#000000">0255:</font></a>   Unlike Unix, MS-Windows file systems restrict the set of characters
<a name="line256"><font color="#000000">0256:</font></a> that can be used in a file name.  The following characters are not
<a name="line257"><font color="#000000">0257:</font></a> allowed:
<a name="line258"><font color="#000000">0258:</font></a> 
<a name="line259"><font color="#000000">0259:</font></a> <b><font color="#0000FF">@itemize</font></b> <b><font color="#0000FF">@bullet</font></b>
<a name="line260"><font color="#000000">0260:</font></a> <b><font color="#0000FF">@item</font></b>
<a name="line261"><font color="#000000">0261:</font></a> Shell redirection symbols <b><font color="#0000FF">@samp</font></b><font color="#009900">{&lt;}</font>, <b><font color="#0000FF">@samp</font></b><font color="#009900">{&gt;}</font>, and <b><font color="#0000FF">@samp</font></b><font color="#009900">{|}</font>.
<a name="line262"><font color="#000000">0262:</font></a> 
<a name="line263"><font color="#000000">0263:</font></a> <b><font color="#0000FF">@item</font></b>
<a name="line264"><font color="#000000">0264:</font></a> Colon <b><font color="#0000FF">@samp</font></b><font color="#009900">{:}</font> (except after the drive letter).
<a name="line265"><font color="#000000">0265:</font></a> 
<a name="line266"><font color="#000000">0266:</font></a> <b><font color="#0000FF">@item</font></b>
<a name="line267"><font color="#000000">0267:</font></a> Forward slash <b><font color="#0000FF">@samp</font></b><font color="#009900">{/}</font> and backslash <b><font color="#0000FF">@samp</font></b><font color="#009900">{\}</font> (except as directory
<a name="line268"><font color="#000000">0268:</font></a> separators).
<a name="line269"><font color="#000000">0269:</font></a> 
<a name="line270"><font color="#000000">0270:</font></a> <b><font color="#0000FF">@item</font></b>
<a name="line271"><font color="#000000">0271:</font></a> Wildcard characters <b><font color="#0000FF">@samp</font></b><font color="#009900">{*}</font> and <b><font color="#0000FF">@samp</font></b><font color="#009900">{?}</font>.
<a name="line272"><font color="#000000">0272:</font></a> 
<a name="line273"><font color="#000000">0273:</font></a> <b><font color="#0000FF">@item</font></b>
<a name="line274"><font color="#000000">0274:</font></a> Control characters whose codepoints are 1 through 31 decimal.  In
<a name="line275"><font color="#000000">0275:</font></a> particular, newlines in file names are not allowed.
<a name="line276"><font color="#000000">0276:</font></a> 
<a name="line277"><font color="#000000">0277:</font></a> <b><font color="#0000FF">@item</font></b>
<a name="line278"><font color="#000000">0278:</font></a> The null character, whose codepoint is zero (this limitation exists on
<a name="line279"><font color="#000000">0279:</font></a> Unix filesystems as well).
<a name="line280"><font color="#000000">0280:</font></a> <b><font color="#0000FF">@end itemize</font></b>
<a name="line281"><font color="#000000">0281:</font></a> 
<a name="line282"><font color="#000000">0282:</font></a> <b><font color="#0000FF">@noindent</font></b>
<a name="line283"><font color="#000000">0283:</font></a> In addition, referencing any file whose name matches a DOS character
<a name="line284"><font color="#000000">0284:</font></a> device, such as <b><font color="#0000FF">@file</font></b><font color="#009900">{NUL}</font> or <b><font color="#0000FF">@file</font></b><font color="#009900">{LPT1}</font> or <b><font color="#0000FF">@file</font></b><font color="#009900">{PRN}</font> or <b><font color="#0000FF">@file</font></b><font color="#009900">{CON}</font>,
<a name="line285"><font color="#000000">0285:</font></a> with or without any file-name extension, will always resolve to those
<a name="line286"><font color="#000000">0286:</font></a> character devices, in any directory.  Therefore, only use such file
<a name="line287"><font color="#000000">0287:</font></a> names when you want to use the corresponding character device.
<a name="line288"><font color="#000000">0288:</font></a> 
<a name="line289"><font color="#000000">0289:</font></a> <b><font color="#0000FF">@node</font></b> ls in Lisp
<a name="line290"><font color="#000000">0290:</font></a> <b><font color="#0000FF">@section</font></b> Emulation of <b><font color="#0000FF">@code</font></b><font color="#009900">{ls}</font> on MS-Windows
<a name="line291"><font color="#000000">0291:</font></a> <i><font color="#9A1900">@cindex Dired, and MS-Windows/MS-DOS</font></i>
<a name="line292"><font color="#000000">0292:</font></a> <i><font color="#9A1900">@cindex @code{ls} emulation</font></i>
<a name="line293"><font color="#000000">0293:</font></a> 
<a name="line294"><font color="#000000">0294:</font></a>   Dired normally uses the external program <b><font color="#0000FF">@code</font></b><font color="#009900">{ls}</font>
<a name="line295"><font color="#000000">0295:</font></a> to produce the directory listing displayed in Dired
<a name="line296"><font color="#000000">0296:</font></a> buffers (<b><font color="#0000FF">@pxref</font></b><font color="#FF0000">{</font><font color="#FF0000">Dired</font><font color="#FF0000">}</font>).  However, MS-Windows and MS-DOS systems don't
<a name="line297"><font color="#000000">0297:</font></a> come with such a program, although several ports of <b><font color="#0000FF">@sc</font></b><font color="#009900">{gnu}</font> <i><font color="#9A1900">@code{ls}</font></i>
<a name="line298"><font color="#000000">0298:</font></a> are available.  Therefore, Emacs on those systems <b><font color="#0000FF">@emph</font></b><font color="#FF0000">{</font><i><font color="#009900">emulates</font></i><font color="#FF0000">}</font>
<a name="line299"><font color="#000000">0299:</font></a> <i><font color="#9A1900">@code{ls} in Lisp, by using the @file{ls-lisp.el} package.  While</font></i>
<a name="line300"><font color="#000000">0300:</font></a> <b><font color="#0000FF">@file</font></b><font color="#009900">{ls-lisp.el}</font> provides a reasonably full emulation of <b><font color="#0000FF">@code</font></b><font color="#009900">{ls}</font>,
<a name="line301"><font color="#000000">0301:</font></a> there are some options and features peculiar to that emulation;
<a name="line302"><font color="#000000">0302:</font></a> <b><font color="#0000FF">@iftex</font></b>
<a name="line303"><font color="#000000">0303:</font></a> for more details, see the documentation of the variables whose names
<a name="line304"><font color="#000000">0304:</font></a> begin with <b><font color="#0000FF">@code</font></b><font color="#009900">{ls-lisp}</font>.
<a name="line305"><font color="#000000">0305:</font></a> <b><font color="#0000FF">@end iftex</font></b>
<a name="line306"><font color="#000000">0306:</font></a> <b><font color="#0000FF">@ifnottex</font></b>
<a name="line307"><font color="#000000">0307:</font></a> they are described in this section.
<a name="line308"><font color="#000000">0308:</font></a> 
<a name="line309"><font color="#000000">0309:</font></a>   The <b><font color="#0000FF">@code</font></b><font color="#009900">{ls}</font> emulation supports many of the <b><font color="#0000FF">@code</font></b><font color="#009900">{ls}</font> switches, but
<a name="line310"><font color="#000000">0310:</font></a> it doesn't support all of them.  Here's the list of the switches it
<a name="line311"><font color="#000000">0311:</font></a> does support: <b><font color="#0000FF">@option</font></b><font color="#009900">{-A}</font>, <b><font color="#0000FF">@option</font></b><font color="#009900">{-a}</font>, <b><font color="#0000FF">@option</font></b><font color="#009900">{-B}</font>, <b><font color="#0000FF">@option</font></b><font color="#009900">{-C}</font>,
<a name="line312"><font color="#000000">0312:</font></a> <b><font color="#0000FF">@option</font></b><font color="#009900">{-c}</font>, <b><font color="#0000FF">@option</font></b><font color="#009900">{-G}</font>, <b><font color="#0000FF">@option</font></b><font color="#009900">{-g}</font>, <b><font color="#0000FF">@option</font></b><font color="#009900">{-h}</font>, <b><font color="#0000FF">@option</font></b><font color="#009900">{-i}</font>, <b><font color="#0000FF">@option</font></b><font color="#009900">{-n}</font>,
<a name="line313"><font color="#000000">0313:</font></a> <b><font color="#0000FF">@option</font></b><font color="#009900">{-R}</font>, <b><font color="#0000FF">@option</font></b><font color="#009900">{-r}</font>, <b><font color="#0000FF">@option</font></b><font color="#009900">{-S}</font>, <b><font color="#0000FF">@option</font></b><font color="#009900">{-s}</font>, <b><font color="#0000FF">@option</font></b><font color="#009900">{-t}</font>, <b><font color="#0000FF">@option</font></b><font color="#009900">{-U}</font>,
<a name="line314"><font color="#000000">0314:</font></a> <b><font color="#0000FF">@option</font></b><font color="#009900">{-u}</font>, and <b><font color="#0000FF">@option</font></b><font color="#009900">{-X}</font>.  The <b><font color="#0000FF">@option</font></b><font color="#009900">{-F}</font> switch is partially
<a name="line315"><font color="#000000">0315:</font></a> supported (it appends the character that classifies the file, but does
<a name="line316"><font color="#000000">0316:</font></a> not prevent symlink following).
<a name="line317"><font color="#000000">0317:</font></a> 
<a name="line318"><font color="#000000">0318:</font></a> <b><font color="#0000FF">@vindex</font></b> ls-lisp-use-insert-directory-program
<a name="line319"><font color="#000000">0319:</font></a>   On MS-Windows and MS-DOS, <b><font color="#0000FF">@file</font></b><font color="#009900">{ls-lisp.el}</font> is preloaded when Emacs
<a name="line320"><font color="#000000">0320:</font></a> is built, so the Lisp emulation of <b><font color="#0000FF">@code</font></b><font color="#009900">{ls}</font> is always used on those
<a name="line321"><font color="#000000">0321:</font></a> platforms.  If you have a ported <b><font color="#0000FF">@code</font></b><font color="#009900">{ls}</font>, setting
<a name="line322"><font color="#000000">0322:</font></a> <i><font color="#9A1900">@code{ls-lisp-use-insert-directory-program} to a non-@code{nil} value</font></i>
<a name="line323"><font color="#000000">0323:</font></a> will revert to using an external program named by the variable
<a name="line324"><font color="#000000">0324:</font></a> <i><font color="#9A1900">@code{insert-directory-program}.</font></i>
<a name="line325"><font color="#000000">0325:</font></a> 
<a name="line326"><font color="#000000">0326:</font></a> <b><font color="#0000FF">@vindex</font></b> ls-lisp-ignore-case
<a name="line327"><font color="#000000">0327:</font></a>   By default, <b><font color="#0000FF">@file</font></b><font color="#009900">{ls-lisp.el}</font> uses a case-sensitive sort order for
<a name="line328"><font color="#000000">0328:</font></a> the directory listing it produces; this is so the listing looks the
<a name="line329"><font color="#000000">0329:</font></a> same as on other platforms.  If you wish that the files be sorted in
<a name="line330"><font color="#000000">0330:</font></a> case-insensitive order, set the variable <b><font color="#0000FF">@code</font></b><font color="#009900">{ls-lisp-ignore-case}</font> to
<a name="line331"><font color="#000000">0331:</font></a> a non-<b><font color="#0000FF">@code</font></b><font color="#009900">{nil}</font> value.
<a name="line332"><font color="#000000">0332:</font></a> 
<a name="line333"><font color="#000000">0333:</font></a> <b><font color="#0000FF">@vindex</font></b> ls-lisp-dirs-first
<a name="line334"><font color="#000000">0334:</font></a>   By default, files and subdirectories are sorted together, to emulate
<a name="line335"><font color="#000000">0335:</font></a> the behavior of <b><font color="#0000FF">@code</font></b><font color="#009900">{ls}</font>.  However, native MS-Windows/MS-DOS file
<a name="line336"><font color="#000000">0336:</font></a> managers list the directories before the files; if you want that
<a name="line337"><font color="#000000">0337:</font></a> behavior, customize the option <b><font color="#0000FF">@code</font></b><font color="#009900">{ls-lisp-dirs-first}</font> to a
<a name="line338"><font color="#000000">0338:</font></a> non-<b><font color="#0000FF">@code</font></b><font color="#009900">{nil}</font> value.
<a name="line339"><font color="#000000">0339:</font></a> 
<a name="line340"><font color="#000000">0340:</font></a> <b><font color="#0000FF">@vindex</font></b> ls-lisp-verbosity
<a name="line341"><font color="#000000">0341:</font></a>   The variable <b><font color="#0000FF">@code</font></b><font color="#009900">{ls-lisp-verbosity}</font> controls the file attributes
<a name="line342"><font color="#000000">0342:</font></a> that <b><font color="#0000FF">@file</font></b><font color="#009900">{ls-lisp.el}</font> displays.  The value should be a list that
<a name="line343"><font color="#000000">0343:</font></a> contains one or more of the symbols <b><font color="#0000FF">@code</font></b><font color="#009900">{links}</font>, <b><font color="#0000FF">@code</font></b><font color="#009900">{uid}</font>, and
<a name="line344"><font color="#000000">0344:</font></a> <i><font color="#9A1900">@code{gid}.  @code{links} means display the count of different file</font></i>
<a name="line345"><font color="#000000">0345:</font></a> names that are associated with (a.k.a.<b><font color="#0000FF">@:</font></b> <b><font color="#0000FF">@dfn</font></b><font color="#009900">{links to}</font>) the file's
<a name="line346"><font color="#000000">0346:</font></a> data; this is only useful on NTFS volumes.  <b><font color="#0000FF">@code</font></b><font color="#009900">{uid}</font> means display
<a name="line347"><font color="#000000">0347:</font></a> the numerical identifier of the user who owns the file.  <b><font color="#0000FF">@code</font></b><font color="#009900">{gid}</font>
<a name="line348"><font color="#000000">0348:</font></a> means display the numerical identifier of the file owner's group.  The
<a name="line349"><font color="#000000">0349:</font></a> default value is <b><font color="#0000FF">@code</font></b><font color="#009900">{(links uid gid)}</font> i.e., all the 3 optional
<a name="line350"><font color="#000000">0350:</font></a> attributes are displayed.
<a name="line351"><font color="#000000">0351:</font></a> 
<a name="line352"><font color="#000000">0352:</font></a> <b><font color="#0000FF">@vindex</font></b> ls-lisp-emulation
<a name="line353"><font color="#000000">0353:</font></a>   The variable <b><font color="#0000FF">@code</font></b><font color="#009900">{ls-lisp-emulation}</font> controls the flavor of the
<a name="line354"><font color="#000000">0354:</font></a> <i><font color="#9A1900">@code{ls} emulation by setting the defaults for the 3 options</font></i>
<a name="line355"><font color="#000000">0355:</font></a> described above: <b><font color="#0000FF">@code</font></b><font color="#009900">{ls-lisp-ignore-case}</font>,
<a name="line356"><font color="#000000">0356:</font></a> <i><font color="#9A1900">@code{ls-lisp-dirs-first}, and @code{ls-lisp-verbosity}.  The value of</font></i>
<a name="line357"><font color="#000000">0357:</font></a> this option can be one of the following symbols:
<a name="line358"><font color="#000000">0358:</font></a> 
<a name="line359"><font color="#000000">0359:</font></a> <b><font color="#0000FF">@table</font></b> <i><font color="#9A1900">@code</font></i>
<a name="line360"><font color="#000000">0360:</font></a> <b><font color="#0000FF">@item</font></b> GNU
<a name="line361"><font color="#000000">0361:</font></a> <b><font color="#0000FF">@itemx</font></b> nil
<a name="line362"><font color="#000000">0362:</font></a> Emulate <b><font color="#0000FF">@sc</font></b><font color="#009900">{gnu}</font> systems; this is the default.  This sets
<a name="line363"><font color="#000000">0363:</font></a> <i><font color="#9A1900">@code{ls-lisp-ignore-case} and @code{ls-lisp-dirs-first} to</font></i>
<a name="line364"><font color="#000000">0364:</font></a> <i><font color="#9A1900">@code{nil}, and @code{ls-lisp-verbosity} to @code{(links uid gid)}.</font></i>
<a name="line365"><font color="#000000">0365:</font></a> <b><font color="#0000FF">@item</font></b> UNIX
<a name="line366"><font color="#000000">0366:</font></a> Emulate Unix systems.  Like <b><font color="#0000FF">@code</font></b><font color="#009900">{GNU}</font>, but sets
<a name="line367"><font color="#000000">0367:</font></a> <i><font color="#9A1900">@code{ls-lisp-verbosity} to @code{(links uid)}.</font></i>
<a name="line368"><font color="#000000">0368:</font></a> <b><font color="#0000FF">@item</font></b> MacOS
<a name="line369"><font color="#000000">0369:</font></a> Emulate macOS<b><font color="#0000FF">@.</font></b>  Sets <b><font color="#0000FF">@code</font></b><font color="#009900">{ls-lisp-ignore-case}</font> to <b><font color="#0000FF">@code</font></b><font color="#009900">{t}</font>, and
<a name="line370"><font color="#000000">0370:</font></a> <i><font color="#9A1900">@code{ls-lisp-dirs-first} and @code{ls-lisp-verbosity} to @code{nil}.</font></i>
<a name="line371"><font color="#000000">0371:</font></a> <b><font color="#0000FF">@item</font></b> MS-Windows
<a name="line372"><font color="#000000">0372:</font></a> Emulate MS-Windows.  Sets <b><font color="#0000FF">@code</font></b><font color="#009900">{ls-lisp-ignore-case}</font> and
<a name="line373"><font color="#000000">0373:</font></a> <i><font color="#9A1900">@code{ls-lisp-dirs-first} to @code{t}, and @code{ls-lisp-verbosity} to</font></i>
<a name="line374"><font color="#000000">0374:</font></a> <i><font color="#9A1900">@code{(links)} on Windows NT/2K/XP/2K3 and to @code{nil} on Windows 9X@.</font></i>
<a name="line375"><font color="#000000">0375:</font></a> Note that the default emulation is <b><font color="#0000FF">@emph</font></b><font color="#FF0000">{</font><i><font color="#009900">not</font></i><font color="#FF0000">}</font> <i><font color="#9A1900">@code{MS-Windows}, even</font></i>
<a name="line376"><font color="#000000">0376:</font></a> on Windows, since many users of Emacs on those platforms prefer the
<a name="line377"><font color="#000000">0377:</font></a> <b><font color="#0000FF">@sc</font></b><font color="#009900">{gnu}</font> defaults.
<a name="line378"><font color="#000000">0378:</font></a> <b><font color="#0000FF">@end table</font></b>
<a name="line379"><font color="#000000">0379:</font></a> 
<a name="line380"><font color="#000000">0380:</font></a> <b><font color="#0000FF">@noindent</font></b>
<a name="line381"><font color="#000000">0381:</font></a> Any other value of <b><font color="#0000FF">@code</font></b><font color="#009900">{ls-lisp-emulation}</font> means the same as <b><font color="#0000FF">@code</font></b><font color="#009900">{GNU}</font>.
<a name="line382"><font color="#000000">0382:</font></a> Customizing this option calls the function <b><font color="#0000FF">@code</font></b><font color="#009900">{ls-lisp-set-options}</font> to
<a name="line383"><font color="#000000">0383:</font></a> update the 3 dependent options as needed.  If you change the value of
<a name="line384"><font color="#000000">0384:</font></a> this variable without using customize after <b><font color="#0000FF">@file</font></b><font color="#009900">{ls-lisp.el}</font> is loaded
<a name="line385"><font color="#000000">0385:</font></a> (note that it is preloaded on MS-Windows and MS-DOS), you can call that
<a name="line386"><font color="#000000">0386:</font></a> function manually for the same result.
<a name="line387"><font color="#000000">0387:</font></a> 
<a name="line388"><font color="#000000">0388:</font></a> <b><font color="#0000FF">@vindex</font></b> ls-lisp-support-shell-wildcards
<a name="line389"><font color="#000000">0389:</font></a>   The variable <b><font color="#0000FF">@code</font></b><font color="#009900">{ls-lisp-support-shell-wildcards}</font> controls how
<a name="line390"><font color="#000000">0390:</font></a> file-name patterns are supported: if it is non-<b><font color="#0000FF">@code</font></b><font color="#009900">{nil}</font> (the
<a name="line391"><font color="#000000">0391:</font></a> default), they are treated as shell-style wildcards; otherwise they
<a name="line392"><font color="#000000">0392:</font></a> are treated as Emacs regular expressions.
<a name="line393"><font color="#000000">0393:</font></a> 
<a name="line394"><font color="#000000">0394:</font></a> <b><font color="#0000FF">@vindex</font></b> ls-lisp-format-time-list
<a name="line395"><font color="#000000">0395:</font></a>   The variable <b><font color="#0000FF">@code</font></b><font color="#009900">{ls-lisp-format-time-list}</font> defines how to format
<a name="line396"><font color="#000000">0396:</font></a> the date and time of files.  <b><font color="#0000FF">@emph</font></b><font color="#009900">{The value of this variable is</font>
<a name="line397"><font color="#000000">0397:</font></a> <font color="#009900">ignored}</font>, unless Emacs cannot determine the current locale.  (However,
<a name="line398"><font color="#000000">0398:</font></a> if the value of <b><font color="#0000FF">@code</font></b><font color="#009900">{ls-lisp-use-localized-time-format}</font> is
<a name="line399"><font color="#000000">0399:</font></a> non-<b><font color="#0000FF">@code</font></b><font color="#009900">{nil}</font>, Emacs obeys <b><font color="#0000FF">@code</font></b><font color="#009900">{ls-lisp-format-time-list}</font> even if
<a name="line400"><font color="#000000">0400:</font></a> the current locale is available; see below.)
<a name="line401"><font color="#000000">0401:</font></a> 
<a name="line402"><font color="#000000">0402:</font></a> The value of <b><font color="#0000FF">@code</font></b><font color="#009900">{ls-lisp-format-time-list}</font> is a list of 2 strings.
<a name="line403"><font color="#000000">0403:</font></a> The first string is used if the file was modified within the current
<a name="line404"><font color="#000000">0404:</font></a> year, while the second string is used for older files.  In each of
<a name="line405"><font color="#000000">0405:</font></a> these two strings you can use <b><font color="#0000FF">@samp</font></b><font color="#009900">{%}</font>-sequences to substitute parts
<a name="line406"><font color="#000000">0406:</font></a> of the time.  For example:
<a name="line407"><font color="#000000">0407:</font></a> <b><font color="#0000FF">@lisp</font></b>
<a name="line408"><font color="#000000">0408:</font></a> ("%b %e %H:%M" "%b %e  %Y")
<a name="line409"><font color="#000000">0409:</font></a> <b><font color="#0000FF">@end lisp</font></b>
<a name="line410"><font color="#000000">0410:</font></a> 
<a name="line411"><font color="#000000">0411:</font></a> <b><font color="#0000FF">@noindent</font></b>
<a name="line412"><font color="#000000">0412:</font></a> Note that the strings substituted for these <b><font color="#0000FF">@samp</font></b><font color="#009900">{%}</font>-sequences depend
<a name="line413"><font color="#000000">0413:</font></a> on the current locale.  <b><font color="#0000FF">@xref</font></b><font color="#FF0000">{</font><font color="#FF0000">Time Parsing,,, elisp, The Emacs Lisp</font>
<a name="line414"><font color="#000000">0414:</font></a> <font color="#FF0000">Reference Manual</font><font color="#FF0000">}</font>, for more about format time specs.
<a name="line415"><font color="#000000">0415:</font></a> 
<a name="line416"><font color="#000000">0416:</font></a> <b><font color="#0000FF">@vindex</font></b> ls-lisp-use-localized-time-format
<a name="line417"><font color="#000000">0417:</font></a>   Normally, Emacs formats the file time stamps in either traditional
<a name="line418"><font color="#000000">0418:</font></a> or ISO-style time format.  However, if the value of the variable
<a name="line419"><font color="#000000">0419:</font></a> <i><font color="#9A1900">@code{ls-lisp-use-localized-time-format} is non-@code{nil}, Emacs</font></i>
<a name="line420"><font color="#000000">0420:</font></a> formats file time stamps according to what
<a name="line421"><font color="#000000">0421:</font></a> <i><font color="#9A1900">@code{ls-lisp-format-time-list} specifies.  The @samp{%}-sequences in</font></i>
<a name="line422"><font color="#000000">0422:</font></a> <i><font color="#9A1900">@code{ls-lisp-format-time-list} produce locale-dependent month and day</font></i>
<a name="line423"><font color="#000000">0423:</font></a> names, which might cause misalignment of columns in Dired display.
<a name="line424"><font color="#000000">0424:</font></a> <b><font color="#0000FF">@end ifnottex</font></b>
<a name="line425"><font color="#000000">0425:</font></a> 
<a name="line426"><font color="#000000">0426:</font></a> <b><font color="#0000FF">@node</font></b> Windows HOME
<a name="line427"><font color="#000000">0427:</font></a> <b><font color="#0000FF">@section</font></b> HOME and Startup Directories on MS-Windows
<a name="line428"><font color="#000000">0428:</font></a> <i><font color="#9A1900">@cindex HOME directory on MS-Windows</font></i>
<a name="line429"><font color="#000000">0429:</font></a> 
<a name="line430"><font color="#000000">0430:</font></a>   The Windows equivalent of <b><font color="#0000FF">@code</font></b><font color="#009900">{HOME}</font> is the <b><font color="#0000FF">@dfn</font></b><font color="#009900">{user-specific</font>
<a name="line431"><font color="#000000">0431:</font></a> <font color="#009900">application data directory}</font>.  The actual location depends on the
<a name="line432"><font color="#000000">0432:</font></a> Windows version; typical values are <b><font color="#0000FF">@file</font></b><font color="#009900">{C:\Documents and</font>
<a name="line433"><font color="#000000">0433:</font></a> <font color="#009900">Settings\@var{username}\Application Data}</font> on Windows 2000/XP/2K3,
<a name="line434"><font color="#000000">0434:</font></a> <b><font color="#0000FF">@file</font></b><font color="#009900">{C:\Users\@var{username}\AppData\Roaming}</font> on Windows
<a name="line435"><font color="#000000">0435:</font></a> Vista/7/2008, and either <b><font color="#0000FF">@file</font></b><font color="#009900">{C:\WINDOWS\Application Data}</font> or
<a name="line436"><font color="#000000">0436:</font></a> <b><font color="#0000FF">@file</font></b><font color="#009900">{C:\WINDOWS\Profiles\@var{username}\Application Data}</font> on Windows
<a name="line437"><font color="#000000">0437:</font></a> 9X/ME<b><font color="#0000FF">@.</font></b>  If this directory does not exist or cannot be accessed, Emacs
<a name="line438"><font color="#000000">0438:</font></a> falls back to <b><font color="#0000FF">@file</font></b><font color="#009900">{C:\}</font> as the default value of <b><font color="#0000FF">@code</font></b><font color="#009900">{HOME}</font>.
<a name="line439"><font color="#000000">0439:</font></a> 
<a name="line440"><font color="#000000">0440:</font></a>   You can override this default value of <b><font color="#0000FF">@code</font></b><font color="#009900">{HOME}</font> by explicitly
<a name="line441"><font color="#000000">0441:</font></a> setting the environment variable <b><font color="#0000FF">@env</font></b><font color="#009900">{HOME}</font> to point to any directory
<a name="line442"><font color="#000000">0442:</font></a> on your system.  <b><font color="#0000FF">@env</font></b><font color="#009900">{HOME}</font> can be set either from the command shell
<a name="line443"><font color="#000000">0443:</font></a> prompt or from <b><font color="#0000FF">@samp</font></b><font color="#009900">{Properties}</font> dialog of <b><font color="#0000FF">@samp</font></b><font color="#009900">{My Computer}</font>.
<a name="line444"><font color="#000000">0444:</font></a> <i><font color="#9A1900">@code{HOME} can also be set in the system registry,</font></i>
<a name="line445"><font color="#000000">0445:</font></a> <b><font color="#0000FF">@pxref</font></b><font color="#FF0000">{</font><font color="#FF0000">MS-Windows Registry</font><font color="#FF0000">}</font>.
<a name="line446"><font color="#000000">0446:</font></a> 
<a name="line447"><font color="#000000">0447:</font></a>   For compatibility with older versions of Emacs<b><font color="#0000FF">@footnote</font></b><font color="#009900">{</font>
<a name="line448"><font color="#000000">0448:</font></a> <font color="#009900">Older versions of Emacs didn't check the application data directory.</font>
<a name="line449"><font color="#000000">0449:</font></a> <font color="#009900">}</font>, if there is a file named <b><font color="#0000FF">@file</font></b><font color="#009900">{.emacs}</font> in <b><font color="#0000FF">@file</font></b><font color="#009900">{C:\}</font>, the root
<a name="line450"><font color="#000000">0450:</font></a> directory of drive <b><font color="#0000FF">@file</font></b><font color="#009900">{C:}</font>, and <b><font color="#0000FF">@env</font></b><font color="#009900">{HOME}</font> is set neither in the
<a name="line451"><font color="#000000">0451:</font></a> environment nor in the Registry, Emacs will treat <b><font color="#0000FF">@file</font></b><font color="#009900">{C:\}</font> as the
<a name="line452"><font color="#000000">0452:</font></a> default <b><font color="#0000FF">@code</font></b><font color="#009900">{HOME}</font> location, and will not look in the application
<a name="line453"><font color="#000000">0453:</font></a> data directory, even if it exists.  Note that only <b><font color="#0000FF">@file</font></b><font color="#009900">{.emacs}</font> is
<a name="line454"><font color="#000000">0454:</font></a> looked for in <b><font color="#0000FF">@file</font></b><font color="#009900">{C:\}</font>; the older name <b><font color="#0000FF">@file</font></b><font color="#009900">{_emacs}</font> (see below) is
<a name="line455"><font color="#000000">0455:</font></a> not.  This use of <b><font color="#0000FF">@file</font></b><font color="#009900">{C:\.emacs}</font> to define <b><font color="#0000FF">@code</font></b><font color="#009900">{HOME}</font> is
<a name="line456"><font color="#000000">0456:</font></a> deprecated.
<a name="line457"><font color="#000000">0457:</font></a> 
<a name="line458"><font color="#000000">0458:</font></a>   Whatever the final place is, Emacs sets the internal value of the
<a name="line459"><font color="#000000">0459:</font></a> <b><font color="#0000FF">@env</font></b><font color="#009900">{HOME}</font> environment variable to point to it, and it will use that
<a name="line460"><font color="#000000">0460:</font></a> location for other files and directories it normally looks for or
<a name="line461"><font color="#000000">0461:</font></a> creates in your home directory.
<a name="line462"><font color="#000000">0462:</font></a> 
<a name="line463"><font color="#000000">0463:</font></a>   You can always find out what Emacs thinks is your home directory's
<a name="line464"><font color="#000000">0464:</font></a> location by typing <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x d ~/ @key{RET}}</font>.  This should present the
<a name="line465"><font color="#000000">0465:</font></a> list of files in the home directory, and show its full name on the
<a name="line466"><font color="#000000">0466:</font></a> first line.  Likewise, to visit your init file, type <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x C-f</font>
<a name="line467"><font color="#000000">0467:</font></a> <font color="#009900">~/.emacs @key{RET}}</font> (assuming the file's name is <b><font color="#0000FF">@file</font></b><font color="#009900">{.emacs}</font>).
<a name="line468"><font color="#000000">0468:</font></a> 
<a name="line469"><font color="#000000">0469:</font></a> <i><font color="#9A1900">@cindex init file @file{.emacs} on MS-Windows</font></i>
<a name="line470"><font color="#000000">0470:</font></a>   The home directory is where your init file is stored.  It can have
<a name="line471"><font color="#000000">0471:</font></a> any name mentioned in <b><font color="#0000FF">@ref</font></b><font color="#FF0000">{</font><font color="#FF0000">Init File</font><font color="#FF0000">}</font>.
<a name="line472"><font color="#000000">0472:</font></a> 
<a name="line473"><font color="#000000">0473:</font></a> <i><font color="#9A1900">@cindex @file{_emacs} init file, MS-Windows</font></i>
<a name="line474"><font color="#000000">0474:</font></a>   Because MS-DOS does not allow file names with leading dots, and
<a name="line475"><font color="#000000">0475:</font></a> older Windows systems made it hard to create files with such names,
<a name="line476"><font color="#000000">0476:</font></a> the Windows port of Emacs supports an init file name <b><font color="#0000FF">@file</font></b><font color="#009900">{_emacs}</font>, if
<a name="line477"><font color="#000000">0477:</font></a> such a file exists in the home directory and <b><font color="#0000FF">@file</font></b><font color="#009900">{.emacs}</font> does not.
<a name="line478"><font color="#000000">0478:</font></a> This name is considered obsolete.
<a name="line479"><font color="#000000">0479:</font></a> 
<a name="line480"><font color="#000000">0480:</font></a> <b><font color="#0000FF">@node</font></b> Windows Keyboard
<a name="line481"><font color="#000000">0481:</font></a> <b><font color="#0000FF">@section</font></b> Keyboard Usage on MS-Windows
<a name="line482"><font color="#000000">0482:</font></a> <i><font color="#9A1900">@cindex keyboard, MS-Windows</font></i>
<a name="line483"><font color="#000000">0483:</font></a> 
<a name="line484"><font color="#000000">0484:</font></a>   This section describes the Windows-specific features related to
<a name="line485"><font color="#000000">0485:</font></a> keyboard input in Emacs.
<a name="line486"><font color="#000000">0486:</font></a> 
<a name="line487"><font color="#000000">0487:</font></a> <i><font color="#9A1900">@cindex MS-Windows keyboard shortcuts</font></i>
<a name="line488"><font color="#000000">0488:</font></a>   Many key combinations (known as ``keyboard shortcuts'') that have
<a name="line489"><font color="#000000">0489:</font></a> conventional uses in MS-Windows programs conflict with traditional
<a name="line490"><font color="#000000">0490:</font></a> Emacs key bindings.  (These Emacs key bindings were established years
<a name="line491"><font color="#000000">0491:</font></a> before Microsoft was founded.)  Examples of conflicts include
<a name="line492"><font color="#000000">0492:</font></a> <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-c}</font>, <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-x}</font>, <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-z}</font>, <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-a}</font>, and <b><font color="#0000FF">@kbd</font></b><font color="#009900">{W-@key{SPC}}</font>.
<a name="line493"><font color="#000000">0493:</font></a> You can redefine some of them with meanings more like the MS-Windows
<a name="line494"><font color="#000000">0494:</font></a> meanings by enabling CUA Mode (<b><font color="#0000FF">@pxref</font></b><font color="#FF0000">{</font><font color="#FF0000">CUA Bindings</font><font color="#FF0000">}</font>).
<a name="line495"><font color="#000000">0495:</font></a> 
<a name="line496"><font color="#000000">0496:</font></a> <b><font color="#0000FF">@iftex</font></b>
<a name="line497"><font color="#000000">0497:</font></a> <b><font color="#0000FF">@inforef</font></b><font color="#FF0000">{</font><font color="#FF0000">Windows Keyboard, , emacs</font><font color="#FF0000">}</font>, for information about additional
<a name="line498"><font color="#000000">0498:</font></a> Windows-specific variables in this category.
<a name="line499"><font color="#000000">0499:</font></a> <b><font color="#0000FF">@end iftex</font></b>
<a name="line500"><font color="#000000">0500:</font></a> <b><font color="#0000FF">@ifnottex</font></b>
<a name="line501"><font color="#000000">0501:</font></a> <b><font color="#0000FF">@vindex</font></b> w32-alt-is-meta
<a name="line502"><font color="#000000">0502:</font></a> <i><font color="#9A1900">@cindex @code{Alt} key (MS-Windows)</font></i>
<a name="line503"><font color="#000000">0503:</font></a>   By default, the key labeled <b><font color="#0000FF">@key</font></b><font color="#009900">{Alt}</font> is mapped as the <b><font color="#0000FF">@key</font></b><font color="#009900">{META}</font>
<a name="line504"><font color="#000000">0504:</font></a> key.  If you wish it to produce the <b><font color="#0000FF">@code</font></b><font color="#009900">{Alt}</font> modifier instead, set
<a name="line505"><font color="#000000">0505:</font></a> the variable <b><font color="#0000FF">@code</font></b><font color="#009900">{w32-alt-is-meta}</font> to a <b><font color="#0000FF">@code</font></b><font color="#009900">{nil}</font> value.
<a name="line506"><font color="#000000">0506:</font></a> 
<a name="line507"><font color="#000000">0507:</font></a> <b><font color="#0000FF">@findex</font></b> w32-register-hot-key
<a name="line508"><font color="#000000">0508:</font></a> <b><font color="#0000FF">@findex</font></b> w32-unregister-hot-key
<a name="line509"><font color="#000000">0509:</font></a>   MS-Windows reserves certain key combinations, such as
<a name="line510"><font color="#000000">0510:</font></a> <b><font color="#0000FF">@kbd</font></b><font color="#009900">{@key{Alt}-@key{TAB}}</font> and a number of Windows key combinations,
<a name="line511"><font color="#000000">0511:</font></a> for its own use.  These key combinations are intercepted by the system
<a name="line512"><font color="#000000">0512:</font></a> before Emacs can see them.  Also, on Windows 10, all Windows key
<a name="line513"><font color="#000000">0513:</font></a> combinations are reserved by the system in such a way that they are
<a name="line514"><font color="#000000">0514:</font></a> never propagated to applications, even if the system does not
<a name="line515"><font color="#000000">0515:</font></a> currently define a hotkey on the specific combination.  You can use
<a name="line516"><font color="#000000">0516:</font></a> the <b><font color="#0000FF">@code</font></b><font color="#009900">{w32-register-hot-key}</font> function to allow a key sequence to be
<a name="line517"><font color="#000000">0517:</font></a> seen by Emacs instead of being grabbed by Windows.  When registered as
<a name="line518"><font color="#000000">0518:</font></a> a hot key, the key combination is pulled out of the system's input
<a name="line519"><font color="#000000">0519:</font></a> queue before it is handled by Windows, effectively overriding the
<a name="line520"><font color="#000000">0520:</font></a> special meaning of that key sequence for Windows.  The override is
<a name="line521"><font color="#000000">0521:</font></a> only effective when Emacs is active; with other applications on the
<a name="line522"><font color="#000000">0522:</font></a> foreground the keys behave normally.
<a name="line523"><font color="#000000">0523:</font></a> 
<a name="line524"><font color="#000000">0524:</font></a>   The argument to <b><font color="#0000FF">@code</font></b><font color="#009900">{w32-register-hot-key}</font> must be a single key with a
<a name="line525"><font color="#000000">0525:</font></a> single modifier, in vector form that would be acceptable to
<a name="line526"><font color="#000000">0526:</font></a> <i><font color="#9A1900">@code{define-key}.  The control and shift modifiers have no effect on the</font></i>
<a name="line527"><font color="#000000">0527:</font></a> argument.  The meta modifier is interpreted as the <b><font color="#0000FF">@key</font></b><font color="#009900">{Alt}</font> key if
<a name="line528"><font color="#000000">0528:</font></a> <i><font color="#9A1900">@code{w32-alt-is-meta} is @code{t} (the default), and the super and hyper</font></i>
<a name="line529"><font color="#000000">0529:</font></a> modifiers are interpreted according to the bindings of
<a name="line530"><font color="#000000">0530:</font></a> <i><font color="#9A1900">@code{w32-lwindow-modifier} and @code{w32-rwindow-modifier}.  Additionally, a</font></i>
<a name="line531"><font color="#000000">0531:</font></a> modifier with the trailing dash but with no key indicates that all
<a name="line532"><font color="#000000">0532:</font></a> Windows defined hotkeys for that modifier are to be overridden in the
<a name="line533"><font color="#000000">0533:</font></a> favor of Emacs.
<a name="line534"><font color="#000000">0534:</font></a> 
<a name="line535"><font color="#000000">0535:</font></a> <b><font color="#0000FF">@kindex</font></b> M-TAB<b><font color="#0000FF">@r</font></b><font color="#009900">{, (MS-Windows)}</font>
<a name="line536"><font color="#000000">0536:</font></a> <i><font color="#9A1900">@cindex @kbd{M-@key{TAB}} vs @kbd{@key{Alt}-@key{TAB}} (MS-Windows)</font></i>
<a name="line537"><font color="#000000">0537:</font></a> <i><font color="#9A1900">@cindex @kbd{@key{Alt}-@key{TAB}} vs @kbd{M-@key{TAB}} (MS-Windows)</font></i>
<a name="line538"><font color="#000000">0538:</font></a>   For example, <b><font color="#0000FF">@code</font></b><font color="#009900">{(w32-register-hot-key [M-tab])}</font> lets you use
<a name="line539"><font color="#000000">0539:</font></a> <b><font color="#0000FF">@kbd</font></b><font color="#009900">{M-@key{TAB}}</font> normally in Emacs; for instance, to complete the
<a name="line540"><font color="#000000">0540:</font></a> word or symbol at point at top level, or to complete the current
<a name="line541"><font color="#000000">0541:</font></a> search string against previously sought strings during incremental
<a name="line542"><font color="#000000">0542:</font></a> search.  <b><font color="#0000FF">@code</font></b><font color="#009900">{(w32-register-hot-key [s-])}</font> with
<a name="line543"><font color="#000000">0543:</font></a> <i><font color="#9A1900">@code{w32-lwindow-modifier} bound to @code{super} disables all the</font></i>
<a name="line544"><font color="#000000">0544:</font></a> Windows' own Windows key based shortcuts.<b><font color="#0000FF">@footnote</font></b><font color="#009900">{There is one known</font>
<a name="line545"><font color="#000000">0545:</font></a> <font color="#009900">exception: The combination @kbd{@key{Windows}-@key{L}} that locks the</font>
<a name="line546"><font color="#000000">0546:</font></a> <font color="#009900">workstation is handled by the system on a lower level.  For this</font>
<a name="line547"><font color="#000000">0547:</font></a> <font color="#009900">reason, @code{w32-register-hot-key} cannot override this key</font>
<a name="line548"><font color="#000000">0548:</font></a> <font color="#009900">combination - it always locks the computer.}</font>
<a name="line549"><font color="#000000">0549:</font></a> 
<a name="line550"><font color="#000000">0550:</font></a>   Note that <b><font color="#0000FF">@code</font></b><font color="#009900">{w32-register-hot-key}</font> checks the
<a name="line551"><font color="#000000">0551:</font></a> <i><font color="#9A1900">@code{w32-[lr]window-modifier} values at the time of the function</font></i>
<a name="line552"><font color="#000000">0552:</font></a> call.  Thus, you can set <b><font color="#0000FF">@code</font></b><font color="#009900">{w32-lwindow-modifier}</font> as <b><font color="#0000FF">@code</font></b><font color="#009900">{super}</font>,
<a name="line553"><font color="#000000">0553:</font></a> then call <b><font color="#0000FF">@code</font></b><font color="#009900">{(w32-register-hot-key [s-r])}</font>, and finally set
<a name="line554"><font color="#000000">0554:</font></a> <i><font color="#9A1900">@code{w32-rwindow-modifier} as @code{super} as well.  The result is</font></i>
<a name="line555"><font color="#000000">0555:</font></a> that the left Windows key together with <b><font color="#0000FF">@key</font></b><font color="#009900">{R}</font> invokes whichever
<a name="line556"><font color="#000000">0556:</font></a> function you have bound for the combination in Emacs, and the right
<a name="line557"><font color="#000000">0557:</font></a> Windows key and <b><font color="#0000FF">@key</font></b><font color="#009900">{R}</font> opens the Windows <b><font color="#0000FF">@code</font></b><font color="#009900">{Run}</font> dialog.
<a name="line558"><font color="#000000">0558:</font></a> 
<a name="line559"><font color="#000000">0559:</font></a>   The hotkey registrations always also include all the shift and
<a name="line560"><font color="#000000">0560:</font></a> control modifier combinations for the given hotkey; that is,
<a name="line561"><font color="#000000">0561:</font></a> registering <b><font color="#0000FF">@kbd</font></b><font color="#009900">{s-@key{a}}</font> as a hotkey gives you <b><font color="#0000FF">@kbd</font></b><font color="#009900">{S-s-@key{a}}</font>,
<a name="line562"><font color="#000000">0562:</font></a> <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-s-@key{a}}</font> and <b><font color="#0000FF">@kbd</font></b><font color="#009900">{C-S-s-@key{a}}</font> as well.
<a name="line563"><font color="#000000">0563:</font></a> 
<a name="line564"><font color="#000000">0564:</font></a>   On Windows 98 and ME, the hotkey registration is more restricted.
<a name="line565"><font color="#000000">0565:</font></a> The desired hotkey must always be fully specified, and
<a name="line566"><font color="#000000">0566:</font></a> <i><font color="#9A1900">@code{w32-phantom-key-code} can be customized to achieve desired</font></i>
<a name="line567"><font color="#000000">0567:</font></a> results.
<a name="line568"><font color="#000000">0568:</font></a> 
<a name="line569"><font color="#000000">0569:</font></a>   The function <b><font color="#0000FF">@code</font></b><font color="#009900">{w32-unregister-hot-key}</font> reverses the effect of
<a name="line570"><font color="#000000">0570:</font></a> <i><font color="#9A1900">@code{w32-register-hot-key} for its argument key sequence.</font></i>
<a name="line571"><font color="#000000">0571:</font></a> 
<a name="line572"><font color="#000000">0572:</font></a> <b><font color="#0000FF">@vindex</font></b> w32-capslock-is-shiftlock
<a name="line573"><font color="#000000">0573:</font></a>   By default, the <b><font color="#0000FF">@key</font></b><font color="#009900">{CapsLock}</font> key only affects normal character
<a name="line574"><font color="#000000">0574:</font></a> keys (it converts lower-case characters to their upper-case
<a name="line575"><font color="#000000">0575:</font></a> variants).  However, if you set the variable
<a name="line576"><font color="#000000">0576:</font></a> <i><font color="#9A1900">@code{w32-capslock-is-shiftlock} to a non-@code{nil} value, the</font></i>
<a name="line577"><font color="#000000">0577:</font></a> <b><font color="#0000FF">@key</font></b><font color="#009900">{CapsLock}</font> key will affect non-character keys as well, as if you
<a name="line578"><font color="#000000">0578:</font></a> pressed the <b><font color="#0000FF">@key</font></b><font color="#009900">{Shift}</font> key while typing the non-character key.
<a name="line579"><font color="#000000">0579:</font></a> 
<a name="line580"><font color="#000000">0580:</font></a> <b><font color="#0000FF">@vindex</font></b> w32-enable-caps-lock
<a name="line581"><font color="#000000">0581:</font></a>   If the variable <b><font color="#0000FF">@code</font></b><font color="#009900">{w32-enable-caps-lock}</font> is set to a <b><font color="#0000FF">@code</font></b><font color="#009900">{nil}</font>
<a name="line582"><font color="#000000">0582:</font></a> value, the <b><font color="#0000FF">@key</font></b><font color="#009900">{CapsLock}</font> key produces the symbol <b><font color="#0000FF">@code</font></b><font color="#009900">{capslock}</font>
<a name="line583"><font color="#000000">0583:</font></a> instead of the shifted version of they keys.  The default value is
<a name="line584"><font color="#000000">0584:</font></a> <i><font color="#9A1900">@code{t}.</font></i>
<a name="line585"><font color="#000000">0585:</font></a> 
<a name="line586"><font color="#000000">0586:</font></a> <b><font color="#0000FF">@vindex</font></b> w32-enable-num-lock
<a name="line587"><font color="#000000">0587:</font></a> <i><font color="#9A1900">@cindex keypad keys (MS-Windows)</font></i>
<a name="line588"><font color="#000000">0588:</font></a>   Similarly, if <b><font color="#0000FF">@code</font></b><font color="#009900">{w32-enable-num-lock}</font> is <b><font color="#0000FF">@code</font></b><font color="#009900">{nil}</font>, the
<a name="line589"><font color="#000000">0589:</font></a> <b><font color="#0000FF">@key</font></b><font color="#009900">{NumLock}</font> key will produce the symbol <b><font color="#0000FF">@code</font></b><font color="#009900">{kp-numlock}</font>.  The
<a name="line590"><font color="#000000">0590:</font></a> default is <b><font color="#0000FF">@code</font></b><font color="#009900">{t}</font>, which causes <b><font color="#0000FF">@key</font></b><font color="#009900">{NumLock}</font> to work as expected:
<a name="line591"><font color="#000000">0591:</font></a> toggle the meaning of the keys on the numeric keypad.
<a name="line592"><font color="#000000">0592:</font></a> <b><font color="#0000FF">@end ifnottex</font></b>
<a name="line593"><font color="#000000">0593:</font></a> 
<a name="line594"><font color="#000000">0594:</font></a> <b><font color="#0000FF">@vindex</font></b> w32-apps-modifier
<a name="line595"><font color="#000000">0595:</font></a>   The variable <b><font color="#0000FF">@code</font></b><font color="#009900">{w32-apps-modifier}</font> controls the effect of the
<a name="line596"><font color="#000000">0596:</font></a> <b><font color="#0000FF">@key</font></b><font color="#009900">{Apps}</font> key (usually located between the right <b><font color="#0000FF">@key</font></b><font color="#009900">{Alt}</font> and the
<a name="line597"><font color="#000000">0597:</font></a> right <b><font color="#0000FF">@key</font></b><font color="#009900">{Ctrl}</font> keys).  Its value can be one of the symbols
<a name="line598"><font color="#000000">0598:</font></a> <i><font color="#9A1900">@code{hyper}, @code{super}, @code{meta}, @code{alt}, @code{control},</font></i>
<a name="line599"><font color="#000000">0599:</font></a> or <b><font color="#0000FF">@code</font></b><font color="#009900">{shift}</font> for the respective modifier, or <b><font color="#0000FF">@code</font></b><font color="#009900">{nil}</font> to appear
<a name="line600"><font color="#000000">0600:</font></a> as the key <b><font color="#0000FF">@code</font></b><font color="#009900">{apps}</font>.  The default is <b><font color="#0000FF">@code</font></b><font color="#009900">{nil}</font>.
<a name="line601"><font color="#000000">0601:</font></a> 
<a name="line602"><font color="#000000">0602:</font></a> <b><font color="#0000FF">@vindex</font></b> w32-lwindow-modifier
<a name="line603"><font color="#000000">0603:</font></a> <b><font color="#0000FF">@vindex</font></b> w32-rwindow-modifier
<a name="line604"><font color="#000000">0604:</font></a> <b><font color="#0000FF">@vindex</font></b> w32-scroll-lock-modifier
<a name="line605"><font color="#000000">0605:</font></a>   The variable <b><font color="#0000FF">@code</font></b><font color="#009900">{w32-lwindow-modifier}</font> determines the effect of
<a name="line606"><font color="#000000">0606:</font></a> the left Windows key (usually labeled with <b><font color="#0000FF">@key</font></b><font color="#009900">{start}</font> and the Windows
<a name="line607"><font color="#000000">0607:</font></a> logo).  If its value is <b><font color="#0000FF">@code</font></b><font color="#009900">{nil}</font> (the default), the key will produce
<a name="line608"><font color="#000000">0608:</font></a> the symbol <b><font color="#0000FF">@code</font></b><font color="#009900">{lwindow}</font>.  Setting it to one of the symbols
<a name="line609"><font color="#000000">0609:</font></a> <i><font color="#9A1900">@code{hyper}, @code{super}, @code{meta}, @code{alt}, @code{control},</font></i>
<a name="line610"><font color="#000000">0610:</font></a> or <b><font color="#0000FF">@code</font></b><font color="#009900">{shift}</font> will produce the respective modifier.  A similar
<a name="line611"><font color="#000000">0611:</font></a> variable <b><font color="#0000FF">@code</font></b><font color="#009900">{w32-rwindow-modifier}</font> controls the effect of the right
<a name="line612"><font color="#000000">0612:</font></a> Windows key, and <b><font color="#0000FF">@code</font></b><font color="#009900">{w32-scroll-lock-modifier}</font> does the same for the
<a name="line613"><font color="#000000">0613:</font></a> <b><font color="#0000FF">@key</font></b><font color="#009900">{ScrLock}</font> key.  If these variables are set to <b><font color="#0000FF">@code</font></b><font color="#009900">{nil}</font>, the
<a name="line614"><font color="#000000">0614:</font></a> right Windows key produces the symbol <b><font color="#0000FF">@code</font></b><font color="#009900">{rwindow}</font> and <b><font color="#0000FF">@key</font></b><font color="#009900">{ScrLock}</font>
<a name="line615"><font color="#000000">0615:</font></a> produces the symbol <b><font color="#0000FF">@code</font></b><font color="#009900">{scroll}</font>.  If you want <b><font color="#0000FF">@key</font></b><font color="#009900">{ScrLock}</font> to
<a name="line616"><font color="#000000">0616:</font></a> produce the same effect as in other applications, i.e.<b><font color="#0000FF">@:</font></b> toggle the
<a name="line617"><font color="#000000">0617:</font></a> Scroll Lock <b><font color="#0000FF">@acronym</font></b><font color="#009900">{LED}</font> indication on the keyboard, set
<a name="line618"><font color="#000000">0618:</font></a> <i><font color="#9A1900">@code{w32-scroll-lock-modifier} to @code{t} or any non-@code{nil}</font></i>
<a name="line619"><font color="#000000">0619:</font></a> value other than the above modifier symbols.
<a name="line620"><font color="#000000">0620:</font></a> 
<a name="line621"><font color="#000000">0621:</font></a> <b><font color="#0000FF">@vindex</font></b> w32-pass-alt-to-system
<a name="line622"><font color="#000000">0622:</font></a> <i><font color="#9A1900">@cindex Windows system menu</font></i>
<a name="line623"><font color="#000000">0623:</font></a> <i><font color="#9A1900">@cindex @code{Alt} key invokes menu (Windows)</font></i>
<a name="line624"><font color="#000000">0624:</font></a>   Emacs compiled as a native Windows application normally turns off
<a name="line625"><font color="#000000">0625:</font></a> the Windows feature that tapping the <b><font color="#0000FF">@key</font></b><font color="#009900">{Alt}</font> key invokes the Windows
<a name="line626"><font color="#000000">0626:</font></a> menu.  The reason is that the <b><font color="#0000FF">@key</font></b><font color="#009900">{Alt}</font> serves as <b><font color="#0000FF">@key</font></b><font color="#009900">{META}</font> in Emacs.
<a name="line627"><font color="#000000">0627:</font></a> When using Emacs, users often press the <b><font color="#0000FF">@key</font></b><font color="#009900">{META}</font> key temporarily and
<a name="line628"><font color="#000000">0628:</font></a> then change their minds; if this has the effect of bringing up the
<a name="line629"><font color="#000000">0629:</font></a> Windows menu, it alters the meaning of subsequent commands.  Many
<a name="line630"><font color="#000000">0630:</font></a> users find this frustrating.
<a name="line631"><font color="#000000">0631:</font></a> 
<a name="line632"><font color="#000000">0632:</font></a>   You can re-enable Windows's default handling of tapping the <b><font color="#0000FF">@key</font></b><font color="#009900">{Alt}</font>
<a name="line633"><font color="#000000">0633:</font></a> key by setting <b><font color="#0000FF">@code</font></b><font color="#009900">{w32-pass-alt-to-system}</font> to a non-<b><font color="#0000FF">@code</font></b><font color="#009900">{nil}</font>
<a name="line634"><font color="#000000">0634:</font></a> value.
<a name="line635"><font color="#000000">0635:</font></a> 
<a name="line636"><font color="#000000">0636:</font></a> <b><font color="#0000FF">@ifnottex</font></b>
<a name="line637"><font color="#000000">0637:</font></a> <b><font color="#0000FF">@vindex</font></b> w32-pass-lwindow-to-system
<a name="line638"><font color="#000000">0638:</font></a> <b><font color="#0000FF">@vindex</font></b> w32-pass-rwindow-to-system
<a name="line639"><font color="#000000">0639:</font></a>   The variables <b><font color="#0000FF">@code</font></b><font color="#009900">{w32-pass-lwindow-to-system}</font> and
<a name="line640"><font color="#000000">0640:</font></a> <i><font color="#9A1900">@code{w32-pass-rwindow-to-system} determine whether the respective</font></i>
<a name="line641"><font color="#000000">0641:</font></a> keys are passed to Windows or swallowed by Emacs.  If the value is
<a name="line642"><font color="#000000">0642:</font></a> <i><font color="#9A1900">@code{nil}, the respective key is silently swallowed by Emacs,</font></i>
<a name="line643"><font color="#000000">0643:</font></a> otherwise it is passed to Windows.  The default is <b><font color="#0000FF">@code</font></b><font color="#009900">{t}</font> for both
<a name="line644"><font color="#000000">0644:</font></a> of these variables.  Passing each of these keys to Windows produces
<a name="line645"><font color="#000000">0645:</font></a> its normal effect: for example, <b><font color="#0000FF">@kbd</font></b><font color="#009900">{@key{Lwindow}}</font> opens the
<a name="line646"><font color="#000000">0646:</font></a> <i><font color="#9A1900">@code{Start} menu, etc.</font></i>
<a name="line647"><font color="#000000">0647:</font></a> 
<a name="line648"><font color="#000000">0648:</font></a> <b><font color="#0000FF">@vindex</font></b> w32-recognize-altgr
<a name="line649"><font color="#000000">0649:</font></a> <b><font color="#0000FF">@kindex</font></b> AltGr <b><font color="#0000FF">@r</font></b><font color="#009900">{(MS-Windows)}</font>
<a name="line650"><font color="#000000">0650:</font></a> <i><font color="#9A1900">@cindex AltGr key (MS-Windows)</font></i>
<a name="line651"><font color="#000000">0651:</font></a>   The variable <b><font color="#0000FF">@code</font></b><font color="#009900">{w32-recognize-altgr}</font> controls whether the
<a name="line652"><font color="#000000">0652:</font></a> <b><font color="#0000FF">@key</font></b><font color="#009900">{AltGr}</font> key (if it exists on your keyboard), or its equivalent,
<a name="line653"><font color="#000000">0653:</font></a> the combination of the right <b><font color="#0000FF">@key</font></b><font color="#009900">{Alt}</font> and left <b><font color="#0000FF">@key</font></b><font color="#009900">{Ctrl}</font> keys
<a name="line654"><font color="#000000">0654:</font></a> pressed together, is recognized as the <b><font color="#0000FF">@key</font></b><font color="#009900">{AltGr}</font> key.  The default
<a name="line655"><font color="#000000">0655:</font></a> is <b><font color="#0000FF">@code</font></b><font color="#009900">{t}</font>, which means these keys produce <b><font color="#0000FF">@code</font></b><font color="#009900">{AltGr}</font>; setting it
<a name="line656"><font color="#000000">0656:</font></a> to <b><font color="#0000FF">@code</font></b><font color="#009900">{nil}</font> causes <b><font color="#0000FF">@key</font></b><font color="#009900">{AltGr}</font> or the equivalent key combination to
<a name="line657"><font color="#000000">0657:</font></a> be interpreted as the combination of <b><font color="#0000FF">@key</font></b><font color="#009900">{Ctrl}</font> and <b><font color="#0000FF">@key</font></b><font color="#009900">{META}</font>
<a name="line658"><font color="#000000">0658:</font></a> modifiers.
<a name="line659"><font color="#000000">0659:</font></a> <b><font color="#0000FF">@end ifnottex</font></b>
<a name="line660"><font color="#000000">0660:</font></a> 
<a name="line661"><font color="#000000">0661:</font></a> <b><font color="#0000FF">@node</font></b> Windows Mouse
<a name="line662"><font color="#000000">0662:</font></a> <b><font color="#0000FF">@section</font></b> Mouse Usage on MS-Windows
<a name="line663"><font color="#000000">0663:</font></a> <i><font color="#9A1900">@cindex mouse, and MS-Windows</font></i>
<a name="line664"><font color="#000000">0664:</font></a> 
<a name="line665"><font color="#000000">0665:</font></a>   This section describes the Windows-specific variables related to
<a name="line666"><font color="#000000">0666:</font></a> the mouse.
<a name="line667"><font color="#000000">0667:</font></a> 
<a name="line668"><font color="#000000">0668:</font></a> <b><font color="#0000FF">@vindex</font></b> w32-mouse-button-tolerance
<a name="line669"><font color="#000000">0669:</font></a> <i><font color="#9A1900">@cindex simulation of middle mouse button</font></i>
<a name="line670"><font color="#000000">0670:</font></a>   The variable <b><font color="#0000FF">@code</font></b><font color="#009900">{w32-mouse-button-tolerance}</font> specifies the
<a name="line671"><font color="#000000">0671:</font></a> time interval, in milliseconds, for faking middle mouse button press
<a name="line672"><font color="#000000">0672:</font></a> on 2-button mice.  If both mouse buttons are depressed within this
<a name="line673"><font color="#000000">0673:</font></a> time interval, Emacs generates a middle mouse button click event
<a name="line674"><font color="#000000">0674:</font></a> instead of a double click on one of the buttons.
<a name="line675"><font color="#000000">0675:</font></a> 
<a name="line676"><font color="#000000">0676:</font></a> <b><font color="#0000FF">@vindex</font></b> w32-pass-extra-mouse-buttons-to-system
<a name="line677"><font color="#000000">0677:</font></a>   If the variable <b><font color="#0000FF">@code</font></b><font color="#009900">{w32-pass-extra-mouse-buttons-to-system}</font> is
<a name="line678"><font color="#000000">0678:</font></a> non-<b><font color="#0000FF">@code</font></b><font color="#009900">{nil}</font>, Emacs passes the fourth and fifth mouse buttons to
<a name="line679"><font color="#000000">0679:</font></a> Windows.
<a name="line680"><font color="#000000">0680:</font></a> 
<a name="line681"><font color="#000000">0681:</font></a> <b><font color="#0000FF">@vindex</font></b> w32-swap-mouse-buttons
<a name="line682"><font color="#000000">0682:</font></a>   The variable <b><font color="#0000FF">@code</font></b><font color="#009900">{w32-swap-mouse-buttons}</font> controls which of the 3
<a name="line683"><font color="#000000">0683:</font></a> mouse buttons generates the <b><font color="#0000FF">@kbd</font></b><font color="#009900">{mouse-2}</font> events.  When it is
<a name="line684"><font color="#000000">0684:</font></a> <i><font color="#9A1900">@code{nil} (the default), the middle button generates @kbd{mouse-2}</font></i>
<a name="line685"><font color="#000000">0685:</font></a> and the right button generates <b><font color="#0000FF">@kbd</font></b><font color="#009900">{mouse-3}</font> events.  If this variable
<a name="line686"><font color="#000000">0686:</font></a> is non-<b><font color="#0000FF">@code</font></b><font color="#009900">{nil}</font>, the roles of these two buttons are reversed.
<a name="line687"><font color="#000000">0687:</font></a> 
<a name="line688"><font color="#000000">0688:</font></a> <b><font color="#0000FF">@node</font></b> Windows Processes
<a name="line689"><font color="#000000">0689:</font></a> <b><font color="#0000FF">@section</font></b> Subprocesses on Windows 9X/ME and Windows NT/2K/XP/Vista/7/8/10
<a name="line690"><font color="#000000">0690:</font></a> <i><font color="#9A1900">@cindex subprocesses on MS-Windows</font></i>
<a name="line691"><font color="#000000">0691:</font></a> 
<a name="line692"><font color="#000000">0692:</font></a> <i><font color="#9A1900">@cindex DOS applications, running from Emacs</font></i>
<a name="line693"><font color="#000000">0693:</font></a>   Emacs compiled as a native Windows application (as opposed to the DOS
<a name="line694"><font color="#000000">0694:</font></a> version) includes full support for asynchronous subprocesses.
<a name="line695"><font color="#000000">0695:</font></a> In the Windows version, synchronous and asynchronous subprocesses work
<a name="line696"><font color="#000000">0696:</font></a> fine on both
<a name="line697"><font color="#000000">0697:</font></a> Windows 9X/ME and Windows NT/2K/XP/Vista/7/8/10 as long as you run
<a name="line698"><font color="#000000">0698:</font></a> only 32-bit or 64-bit Windows
<a name="line699"><font color="#000000">0699:</font></a> applications.  However, when you run a DOS application in a subprocess,
<a name="line700"><font color="#000000">0700:</font></a> you may encounter problems or be unable to run the application at all;
<a name="line701"><font color="#000000">0701:</font></a> and if you run two DOS applications at the same time in two
<a name="line702"><font color="#000000">0702:</font></a> subprocesses, you may have to reboot your system.
<a name="line703"><font color="#000000">0703:</font></a> 
<a name="line704"><font color="#000000">0704:</font></a> Since the standard command interpreter (and most command line utilities)
<a name="line705"><font color="#000000">0705:</font></a> on Windows 9X are DOS applications, these problems are significant when
<a name="line706"><font color="#000000">0706:</font></a> using that system.  But there's nothing we can do about them; only
<a name="line707"><font color="#000000">0707:</font></a> Microsoft can fix them.
<a name="line708"><font color="#000000">0708:</font></a> 
<a name="line709"><font color="#000000">0709:</font></a> If you run just one DOS application subprocess, the subprocess should
<a name="line710"><font color="#000000">0710:</font></a> work as expected as long as it is ``well-behaved'' and does not perform
<a name="line711"><font color="#000000">0711:</font></a> direct screen access or other unusual actions.  If you have a CPU
<a name="line712"><font color="#000000">0712:</font></a> monitor application, your machine will appear to be 100% busy even when
<a name="line713"><font color="#000000">0713:</font></a> the DOS application is idle, but this is only an artifact of the way CPU
<a name="line714"><font color="#000000">0714:</font></a> monitors measure processor load.
<a name="line715"><font color="#000000">0715:</font></a> 
<a name="line716"><font color="#000000">0716:</font></a> You must terminate the DOS application before you start any other DOS
<a name="line717"><font color="#000000">0717:</font></a> application in a different subprocess.  Emacs is unable to interrupt or
<a name="line718"><font color="#000000">0718:</font></a> terminate a DOS subprocess.  The only way you can terminate such a
<a name="line719"><font color="#000000">0719:</font></a> subprocess is by giving it a command that tells its program to exit.
<a name="line720"><font color="#000000">0720:</font></a> 
<a name="line721"><font color="#000000">0721:</font></a> If you attempt to run two DOS applications at the same time in separate
<a name="line722"><font color="#000000">0722:</font></a> subprocesses, the second one that is started will be suspended until the
<a name="line723"><font color="#000000">0723:</font></a> first one finishes, even if either or both of them are asynchronous.
<a name="line724"><font color="#000000">0724:</font></a> 
<a name="line725"><font color="#000000">0725:</font></a> <i><font color="#9A1900">@cindex kill DOS application</font></i>
<a name="line726"><font color="#000000">0726:</font></a> If you can go to the first subprocess, and tell it to exit, the second
<a name="line727"><font color="#000000">0727:</font></a> subprocess should continue normally.  However, if the second subprocess
<a name="line728"><font color="#000000">0728:</font></a> is synchronous, Emacs itself will be hung until the first subprocess
<a name="line729"><font color="#000000">0729:</font></a> finishes.  If it will not finish without user input, then you have no
<a name="line730"><font color="#000000">0730:</font></a> choice but to reboot if you are running on Windows 9X<b><font color="#0000FF">@.</font></b>  If you are
<a name="line731"><font color="#000000">0731:</font></a> running on Windows NT/2K/XP, you can use a process viewer application to kill
<a name="line732"><font color="#000000">0732:</font></a> the appropriate instance of NTVDM instead (this will terminate both DOS
<a name="line733"><font color="#000000">0733:</font></a> subprocesses).
<a name="line734"><font color="#000000">0734:</font></a> 
<a name="line735"><font color="#000000">0735:</font></a> If you have to reboot Windows 9X in this situation, do not use the
<a name="line736"><font color="#000000">0736:</font></a> <i><font color="#9A1900">@code{Shutdown} command on the @code{Start} menu; that usually hangs the</font></i>
<a name="line737"><font color="#000000">0737:</font></a> system.  Instead, type <b><font color="#0000FF">@kbd</font></b><font color="#009900">{@key{Ctrl}-@key{Alt}-@key{DEL}}</font> and then choose
<a name="line738"><font color="#000000">0738:</font></a> <i><font color="#9A1900">@code{Shutdown}.  That usually works, although it may take a few minutes</font></i>
<a name="line739"><font color="#000000">0739:</font></a> to do its job.
<a name="line740"><font color="#000000">0740:</font></a> 
<a name="line741"><font color="#000000">0741:</font></a> <b><font color="#0000FF">@vindex</font></b> w32-quote-process-args
<a name="line742"><font color="#000000">0742:</font></a>   The variable <b><font color="#0000FF">@code</font></b><font color="#009900">{w32-quote-process-args}</font> controls how Emacs quotes
<a name="line743"><font color="#000000">0743:</font></a> the process arguments.  Non-<b><font color="#0000FF">@code</font></b><font color="#009900">{nil}</font> means quote with the <b><font color="#0000FF">@code</font></b><font color="#009900">{"}</font>
<a name="line744"><font color="#000000">0744:</font></a> character.  If the value is a character, Emacs uses that character to escape
<a name="line745"><font color="#000000">0745:</font></a> any quote characters that appear; otherwise it chooses a suitable escape
<a name="line746"><font color="#000000">0746:</font></a> character based on the type of the program.
<a name="line747"><font color="#000000">0747:</font></a> 
<a name="line748"><font color="#000000">0748:</font></a> <b><font color="#0000FF">@vindex</font></b> w32-pipe-buffer-size
<a name="line749"><font color="#000000">0749:</font></a>   The variable <b><font color="#0000FF">@code</font></b><font color="#009900">{w32-pipe-buffer-size}</font> controls the size of the
<a name="line750"><font color="#000000">0750:</font></a> buffer Emacs requests from the system when it creates pipes for
<a name="line751"><font color="#000000">0751:</font></a> communications with subprocesses.  The default value is zero, which
<a name="line752"><font color="#000000">0752:</font></a> lets the OS choose the size.  Any valid positive value will request a
<a name="line753"><font color="#000000">0753:</font></a> buffer of that size in bytes.  This can be used to tailor
<a name="line754"><font color="#000000">0754:</font></a> communications with subprocesses to programs that exhibit unusual
<a name="line755"><font color="#000000">0755:</font></a> behavior with respect to buffering pipe I/O.
<a name="line756"><font color="#000000">0756:</font></a> 
<a name="line757"><font color="#000000">0757:</font></a> <b><font color="#0000FF">@ifnottex</font></b>
<a name="line758"><font color="#000000">0758:</font></a> <b><font color="#0000FF">@findex</font></b> w32-shell-execute
<a name="line759"><font color="#000000">0759:</font></a>   The function <b><font color="#0000FF">@code</font></b><font color="#009900">{w32-shell-execute}</font> can be useful for writing
<a name="line760"><font color="#000000">0760:</font></a> customized commands that run MS-Windows applications registered to
<a name="line761"><font color="#000000">0761:</font></a> handle a certain standard Windows operation for a specific type of
<a name="line762"><font color="#000000">0762:</font></a> document or file.  This function is a wrapper around the Windows
<a name="line763"><font color="#000000">0763:</font></a> <i><font color="#9A1900">@code{ShellExecute} API@.  See the MS-Windows API documentation for</font></i>
<a name="line764"><font color="#000000">0764:</font></a> more details.
<a name="line765"><font color="#000000">0765:</font></a> <b><font color="#0000FF">@end ifnottex</font></b>
<a name="line766"><font color="#000000">0766:</font></a> 
<a name="line767"><font color="#000000">0767:</font></a> <b><font color="#0000FF">@node</font></b> Windows Printing
<a name="line768"><font color="#000000">0768:</font></a> <b><font color="#0000FF">@section</font></b> Printing and MS-Windows
<a name="line769"><font color="#000000">0769:</font></a> 
<a name="line770"><font color="#000000">0770:</font></a>   Printing commands, such as <b><font color="#0000FF">@code</font></b><font color="#009900">{lpr-buffer}</font> (<b><font color="#0000FF">@pxref</font></b><font color="#FF0000">{</font><font color="#FF0000">Printing</font><font color="#FF0000">}</font>) and
<a name="line771"><font color="#000000">0771:</font></a> <i><font color="#9A1900">@code{ps-print-buffer} (@pxref{PostScript}) work in MS-DOS and</font></i>
<a name="line772"><font color="#000000">0772:</font></a> MS-Windows by sending the output to one of the printer ports, if a
<a name="line773"><font color="#000000">0773:</font></a> Posix-style <b><font color="#0000FF">@code</font></b><font color="#009900">{lpr}</font> program is unavailable.  The same Emacs
<a name="line774"><font color="#000000">0774:</font></a> variables control printing on all systems, but in some cases they have
<a name="line775"><font color="#000000">0775:</font></a> different default values on MS-DOS and MS-Windows.
<a name="line776"><font color="#000000">0776:</font></a> 
<a name="line777"><font color="#000000">0777:</font></a>   Emacs on MS Windows attempts to determine your default printer
<a name="line778"><font color="#000000">0778:</font></a> automatically (using the function <b><font color="#0000FF">@code</font></b><font color="#009900">{default-printer-name}</font>).
<a name="line779"><font color="#000000">0779:</font></a> But in some rare cases this can fail, or you may wish to use a different
<a name="line780"><font color="#000000">0780:</font></a> printer from within Emacs.  The rest of this section explains how to
<a name="line781"><font color="#000000">0781:</font></a> tell Emacs which printer to use.
<a name="line782"><font color="#000000">0782:</font></a> 
<a name="line783"><font color="#000000">0783:</font></a> <b><font color="#0000FF">@vindex</font></b> printer-name<b><font color="#0000FF">@r</font></b><font color="#009900">{, (MS-DOS/MS-Windows)}</font>
<a name="line784"><font color="#000000">0784:</font></a>   If you want to use your local printer, then set the Lisp variable
<a name="line785"><font color="#000000">0785:</font></a> <i><font color="#9A1900">@code{lpr-command} to @code{""} (its default value on Windows) and</font></i>
<a name="line786"><font color="#000000">0786:</font></a> <i><font color="#9A1900">@code{printer-name} to the name of the printer port---for example,</font></i>
<a name="line787"><font color="#000000">0787:</font></a> <i><font color="#9A1900">@code{"PRN"}, the usual local printer port, or @code{"LPT2"}, or</font></i>
<a name="line788"><font color="#000000">0788:</font></a> <i><font color="#9A1900">@code{"COM1"} for a serial printer.  You can also set</font></i>
<a name="line789"><font color="#000000">0789:</font></a> <i><font color="#9A1900">@code{printer-name} to a file name, in which case ``printed'' output</font></i>
<a name="line790"><font color="#000000">0790:</font></a> is actually appended to that file.  If you set <b><font color="#0000FF">@code</font></b><font color="#009900">{printer-name}</font> to
<a name="line791"><font color="#000000">0791:</font></a> <i><font color="#9A1900">@code{"NUL"}, printed output is silently discarded (sent to the system</font></i>
<a name="line792"><font color="#000000">0792:</font></a> null device).
<a name="line793"><font color="#000000">0793:</font></a> 
<a name="line794"><font color="#000000">0794:</font></a>   You can also use a printer shared by another machine by setting
<a name="line795"><font color="#000000">0795:</font></a> <i><font color="#9A1900">@code{printer-name} to the UNC share name for that printer---for</font></i>
<a name="line796"><font color="#000000">0796:</font></a> example, <b><font color="#0000FF">@code</font></b><font color="#009900">{"//joes_pc/hp4si"}</font>.  (It doesn't matter whether you use
<a name="line797"><font color="#000000">0797:</font></a> forward slashes or backslashes here.)  To find out the names of shared
<a name="line798"><font color="#000000">0798:</font></a> printers, run the command <b><font color="#0000FF">@samp</font></b><font color="#009900">{net view}</font> from the command prompt to
<a name="line799"><font color="#000000">0799:</font></a> obtain a list of servers, and <b><font color="#0000FF">@samp</font></b><font color="#009900">{net view @var{server-name}}</font> to see
<a name="line800"><font color="#000000">0800:</font></a> the names of printers (and directories) shared by that server.
<a name="line801"><font color="#000000">0801:</font></a> Alternatively, click the <b><font color="#0000FF">@samp</font></b><font color="#009900">{Network Neighborhood}</font> icon on your
<a name="line802"><font color="#000000">0802:</font></a> desktop, and look for machines that share their printers via the
<a name="line803"><font color="#000000">0803:</font></a> network.
<a name="line804"><font color="#000000">0804:</font></a> 
<a name="line805"><font color="#000000">0805:</font></a> <i><font color="#9A1900">@cindex @samp{net use}, and printing on MS-Windows</font></i>
<a name="line806"><font color="#000000">0806:</font></a> <i><font color="#9A1900">@cindex networked printers (MS-Windows)</font></i>
<a name="line807"><font color="#000000">0807:</font></a>   If the printer doesn't appear in the output of <b><font color="#0000FF">@samp</font></b><font color="#009900">{net view}</font>, or
<a name="line808"><font color="#000000">0808:</font></a> if setting <b><font color="#0000FF">@code</font></b><font color="#009900">{printer-name}</font> to the UNC share name doesn't produce a
<a name="line809"><font color="#000000">0809:</font></a> hardcopy on that printer, you can use the <b><font color="#0000FF">@samp</font></b><font color="#009900">{net use}</font> command to
<a name="line810"><font color="#000000">0810:</font></a> connect a local print port such as <b><font color="#0000FF">@code</font></b><font color="#009900">{"LPT2"}</font> to the networked
<a name="line811"><font color="#000000">0811:</font></a> printer.  For example, typing <b><font color="#0000FF">@kbd</font></b><font color="#009900">{net use LPT2: \\joes_pc\hp4si}</font><b><font color="#0000FF">@footnote</font></b><font color="#009900">{</font>
<a name="line812"><font color="#000000">0812:</font></a> <font color="#009900">Note that the @samp{net use} command requires the UNC share name to be</font>
<a name="line813"><font color="#000000">0813:</font></a> <font color="#009900">typed with the Windows-style backslashes, while the value of</font>
<a name="line814"><font color="#000000">0814:</font></a> <font color="#009900">@code{printer-name} can be set with either forward- or backslashes.}</font>
<a name="line815"><font color="#000000">0815:</font></a> causes Windows to <b><font color="#0000FF">@dfn</font></b><font color="#009900">{capture}</font> the <b><font color="#0000FF">@code</font></b><font color="#009900">{LPT2}</font> port and redirect the
<a name="line816"><font color="#000000">0816:</font></a> printed material to the printer connected to the machine <b><font color="#0000FF">@code</font></b><font color="#009900">{joes_pc}</font>.
<a name="line817"><font color="#000000">0817:</font></a> After this command, setting <b><font color="#0000FF">@code</font></b><font color="#009900">{printer-name}</font> to <b><font color="#0000FF">@code</font></b><font color="#009900">{"LPT2"}</font>
<a name="line818"><font color="#000000">0818:</font></a> should produce the hardcopy on the networked printer.
<a name="line819"><font color="#000000">0819:</font></a> 
<a name="line820"><font color="#000000">0820:</font></a>   With some varieties of Windows network software, you can instruct
<a name="line821"><font color="#000000">0821:</font></a> Windows to capture a specific printer port such as <b><font color="#0000FF">@code</font></b><font color="#009900">{"LPT2"}</font>, and
<a name="line822"><font color="#000000">0822:</font></a> redirect it to a networked printer via the <b><font color="#0000FF">@w</font></b><font color="#009900">{@code{Control</font>
<a name="line823"><font color="#000000">0823:</font></a> <font color="#009900">Panel-&gt;Printers}}</font> applet instead of <b><font color="#0000FF">@samp</font></b><font color="#009900">{net use}</font>.
<a name="line824"><font color="#000000">0824:</font></a> 
<a name="line825"><font color="#000000">0825:</font></a>   If you set <b><font color="#0000FF">@code</font></b><font color="#009900">{printer-name}</font> to a file name, it's best to use an
<a name="line826"><font color="#000000">0826:</font></a> absolute file name.  Emacs changes the working directory according to
<a name="line827"><font color="#000000">0827:</font></a> the default directory of the current buffer, so if the file name in
<a name="line828"><font color="#000000">0828:</font></a> <i><font color="#9A1900">@code{printer-name} is relative, you will end up with several such</font></i>
<a name="line829"><font color="#000000">0829:</font></a> files, each one in the directory of the buffer from which the printing
<a name="line830"><font color="#000000">0830:</font></a> was done.
<a name="line831"><font color="#000000">0831:</font></a> 
<a name="line832"><font color="#000000">0832:</font></a>   If the value of <b><font color="#0000FF">@code</font></b><font color="#009900">{printer-name}</font> is correct, but printing does
<a name="line833"><font color="#000000">0833:</font></a> not produce the hardcopy on your printer, it is possible that your
<a name="line834"><font color="#000000">0834:</font></a> printer does not support printing plain text (some cheap printers omit
<a name="line835"><font color="#000000">0835:</font></a> this functionality).  In that case, try the PostScript print commands,
<a name="line836"><font color="#000000">0836:</font></a> described below.
<a name="line837"><font color="#000000">0837:</font></a> 
<a name="line838"><font color="#000000">0838:</font></a> <b><font color="#0000FF">@findex</font></b> print-buffer <b><font color="#0000FF">@r</font></b><font color="#009900">{(MS-DOS)}</font>
<a name="line839"><font color="#000000">0839:</font></a> <b><font color="#0000FF">@findex</font></b> print-region <b><font color="#0000FF">@r</font></b><font color="#009900">{(MS-DOS)}</font>
<a name="line840"><font color="#000000">0840:</font></a> <b><font color="#0000FF">@vindex</font></b> lpr-headers-switches <b><font color="#0000FF">@r</font></b><font color="#009900">{(MS-DOS)}</font>
<a name="line841"><font color="#000000">0841:</font></a>   The commands <b><font color="#0000FF">@code</font></b><font color="#009900">{print-buffer}</font> and <b><font color="#0000FF">@code</font></b><font color="#009900">{print-region}</font> call the
<a name="line842"><font color="#000000">0842:</font></a> <i><font color="#9A1900">@code{pr} program, or use special switches to the @code{lpr} program, to</font></i>
<a name="line843"><font color="#000000">0843:</font></a> produce headers on each printed page.  MS-DOS and MS-Windows don't
<a name="line844"><font color="#000000">0844:</font></a> normally have these programs, so by default, the variable
<a name="line845"><font color="#000000">0845:</font></a> <i><font color="#9A1900">@code{lpr-headers-switches} is set so that the requests to print page</font></i>
<a name="line846"><font color="#000000">0846:</font></a> headers are silently ignored.  Thus, <b><font color="#0000FF">@code</font></b><font color="#009900">{print-buffer}</font> and
<a name="line847"><font color="#000000">0847:</font></a> <i><font color="#9A1900">@code{print-region} produce the same output as @code{lpr-buffer} and</font></i>
<a name="line848"><font color="#000000">0848:</font></a> <i><font color="#9A1900">@code{lpr-region}, respectively.  If you do have a suitable @code{pr}</font></i>
<a name="line849"><font color="#000000">0849:</font></a> program (for example, from GNU Coreutils), set
<a name="line850"><font color="#000000">0850:</font></a> <i><font color="#9A1900">@code{lpr-headers-switches} to @code{nil}; Emacs will then call</font></i>
<a name="line851"><font color="#000000">0851:</font></a> <i><font color="#9A1900">@code{pr} to produce the page headers, and print the resulting output as</font></i>
<a name="line852"><font color="#000000">0852:</font></a> specified by <b><font color="#0000FF">@code</font></b><font color="#009900">{printer-name}</font>.
<a name="line853"><font color="#000000">0853:</font></a> 
<a name="line854"><font color="#000000">0854:</font></a> <b><font color="#0000FF">@vindex</font></b> print-region-function <b><font color="#0000FF">@r</font></b><font color="#009900">{(MS-DOS)}</font>
<a name="line855"><font color="#000000">0855:</font></a> <i><font color="#9A1900">@cindex lpr usage under MS-DOS</font></i>
<a name="line856"><font color="#000000">0856:</font></a> <b><font color="#0000FF">@vindex</font></b> lpr-command <b><font color="#0000FF">@r</font></b><font color="#009900">{(MS-DOS)}</font>
<a name="line857"><font color="#000000">0857:</font></a> <b><font color="#0000FF">@vindex</font></b> lpr-switches <b><font color="#0000FF">@r</font></b><font color="#009900">{(MS-DOS)}</font>
<a name="line858"><font color="#000000">0858:</font></a>   Finally, if you do have an <b><font color="#0000FF">@code</font></b><font color="#009900">{lpr}</font> work-alike, you can set the
<a name="line859"><font color="#000000">0859:</font></a> variable <b><font color="#0000FF">@code</font></b><font color="#009900">{lpr-command}</font> to <b><font color="#0000FF">@code</font></b><font color="#009900">{"lpr"}</font>.  Then Emacs will use
<a name="line860"><font color="#000000">0860:</font></a> <i><font color="#9A1900">@code{lpr} for printing, as on other systems.  (If the name of the</font></i>
<a name="line861"><font color="#000000">0861:</font></a> program isn't <b><font color="#0000FF">@code</font></b><font color="#009900">{lpr}</font>, set <b><font color="#0000FF">@code</font></b><font color="#009900">{lpr-command}</font> to the appropriate value.)
<a name="line862"><font color="#000000">0862:</font></a> The variable <b><font color="#0000FF">@code</font></b><font color="#009900">{lpr-switches}</font> has its standard meaning
<a name="line863"><font color="#000000">0863:</font></a> when <b><font color="#0000FF">@code</font></b><font color="#009900">{lpr-command}</font> is not <b><font color="#0000FF">@code</font></b><font color="#009900">{""}</font>.  If the variable
<a name="line864"><font color="#000000">0864:</font></a> <i><font color="#9A1900">@code{printer-name} has a string value, it is used as the value for the</font></i>
<a name="line865"><font color="#000000">0865:</font></a> <i><font color="#9A1900">@code{-P} option to @code{lpr}, as on Unix.</font></i>
<a name="line866"><font color="#000000">0866:</font></a> 
<a name="line867"><font color="#000000">0867:</font></a> <b><font color="#0000FF">@findex</font></b> ps-print-buffer <b><font color="#0000FF">@r</font></b><font color="#009900">{(MS-DOS)}</font>
<a name="line868"><font color="#000000">0868:</font></a> <b><font color="#0000FF">@findex</font></b> ps-spool-buffer <b><font color="#0000FF">@r</font></b><font color="#009900">{(MS-DOS)}</font>
<a name="line869"><font color="#000000">0869:</font></a> <b><font color="#0000FF">@vindex</font></b> ps-printer-name <b><font color="#0000FF">@r</font></b><font color="#009900">{(MS-DOS)}</font>
<a name="line870"><font color="#000000">0870:</font></a> <b><font color="#0000FF">@vindex</font></b> ps-lpr-command <b><font color="#0000FF">@r</font></b><font color="#009900">{(MS-DOS)}</font>
<a name="line871"><font color="#000000">0871:</font></a> <b><font color="#0000FF">@vindex</font></b> ps-lpr-switches <b><font color="#0000FF">@r</font></b><font color="#009900">{(MS-DOS)}</font>
<a name="line872"><font color="#000000">0872:</font></a>   A parallel set of variables, <b><font color="#0000FF">@code</font></b><font color="#009900">{ps-lpr-command}</font>,
<a name="line873"><font color="#000000">0873:</font></a> <i><font color="#9A1900">@code{ps-lpr-switches}, and @code{ps-printer-name} (@pxref{PostScript</font></i>
<a name="line874"><font color="#000000">0874:</font></a> Variables}), defines how PostScript files should be printed.  These
<a name="line875"><font color="#000000">0875:</font></a> variables are used in the same way as the corresponding variables
<a name="line876"><font color="#000000">0876:</font></a> described above for non-PostScript printing.  Thus, the value of
<a name="line877"><font color="#000000">0877:</font></a> <i><font color="#9A1900">@code{ps-printer-name} is used as the name of the device (or file) to</font></i>
<a name="line878"><font color="#000000">0878:</font></a> which PostScript output is sent, just as <b><font color="#0000FF">@code</font></b><font color="#009900">{printer-name}</font> is used
<a name="line879"><font color="#000000">0879:</font></a> for non-PostScript printing.  (There are two distinct sets of
<a name="line880"><font color="#000000">0880:</font></a> variables in case you have two printers attached to two different
<a name="line881"><font color="#000000">0881:</font></a> ports, and only one of them is a PostScript printer.)
<a name="line882"><font color="#000000">0882:</font></a> 
<a name="line883"><font color="#000000">0883:</font></a> <i><font color="#9A1900">@cindex Ghostscript, use for PostScript printing</font></i>
<a name="line884"><font color="#000000">0884:</font></a>   The default value of the variable <b><font color="#0000FF">@code</font></b><font color="#009900">{ps-lpr-command}</font> is <b><font color="#0000FF">@code</font></b><font color="#009900">{""}</font>,
<a name="line885"><font color="#000000">0885:</font></a> which causes PostScript output to be sent to the printer port specified
<a name="line886"><font color="#000000">0886:</font></a> by <b><font color="#0000FF">@code</font></b><font color="#009900">{ps-printer-name}</font>; but <b><font color="#0000FF">@code</font></b><font color="#009900">{ps-lpr-command}</font> can also be set to
<a name="line887"><font color="#000000">0887:</font></a> the name of a program which will accept PostScript files.  Thus, if you
<a name="line888"><font color="#000000">0888:</font></a> have a non-PostScript printer, you can set this variable to the name of
<a name="line889"><font color="#000000">0889:</font></a> a PostScript interpreter program (such as Ghostscript).  Any switches
<a name="line890"><font color="#000000">0890:</font></a> that need to be passed to the interpreter program are specified using
<a name="line891"><font color="#000000">0891:</font></a> <i><font color="#9A1900">@code{ps-lpr-switches}.  (If the value of @code{ps-printer-name} is a</font></i>
<a name="line892"><font color="#000000">0892:</font></a> string, it will be added to the list of switches as the value for the
<a name="line893"><font color="#000000">0893:</font></a> <i><font color="#9A1900">@code{-P} option.  This is probably only useful if you are using</font></i>
<a name="line894"><font color="#000000">0894:</font></a> <i><font color="#9A1900">@code{lpr}, so when using an interpreter typically you would set</font></i>
<a name="line895"><font color="#000000">0895:</font></a> <i><font color="#9A1900">@code{ps-printer-name} to something other than a string so it is</font></i>
<a name="line896"><font color="#000000">0896:</font></a> ignored.)
<a name="line897"><font color="#000000">0897:</font></a> 
<a name="line898"><font color="#000000">0898:</font></a>   For example, to use Ghostscript for printing on the system's default
<a name="line899"><font color="#000000">0899:</font></a> printer, put this in your <b><font color="#0000FF">@file</font></b><font color="#009900">{.emacs}</font> file:
<a name="line900"><font color="#000000">0900:</font></a> 
<a name="line901"><font color="#000000">0901:</font></a> <b><font color="#0000FF">@example</font></b>
<a name="line902"><font color="#000000">0902:</font></a> (setq ps-printer-name t)
<a name="line903"><font color="#000000">0903:</font></a> (setq ps-lpr-command "D:/gs6.01/bin/gswin32c.exe")
<a name="line904"><font color="#000000">0904:</font></a> (setq ps-lpr-switches '("-q" "-dNOPAUSE" "-dBATCH"
<a name="line905"><font color="#000000">0905:</font></a>                         "-sDEVICE=mswinpr2"
<a name="line906"><font color="#000000">0906:</font></a>                         "-sPAPERSIZE=a4"))
<a name="line907"><font color="#000000">0907:</font></a> <b><font color="#0000FF">@end example</font></b>
<a name="line908"><font color="#000000">0908:</font></a> 
<a name="line909"><font color="#000000">0909:</font></a> <b><font color="#0000FF">@noindent</font></b>
<a name="line910"><font color="#000000">0910:</font></a> (This assumes that Ghostscript is installed in the
<a name="line911"><font color="#000000">0911:</font></a> <b><font color="#0000FF">@file</font></b><font color="#009900">{D:/gs6.01}</font> directory.)
<a name="line912"><font color="#000000">0912:</font></a> 
<a name="line913"><font color="#000000">0913:</font></a> <b><font color="#0000FF">@node</font></b> Windows Fonts
<a name="line914"><font color="#000000">0914:</font></a> <b><font color="#0000FF">@section</font></b> Specifying Fonts on MS-Windows
<a name="line915"><font color="#000000">0915:</font></a> <i><font color="#9A1900">@cindex font specification (MS Windows)</font></i>
<a name="line916"><font color="#000000">0916:</font></a> 
<a name="line917"><font color="#000000">0917:</font></a>   Starting with Emacs 23, fonts are specified by their name, size
<a name="line918"><font color="#000000">0918:</font></a> and optional properties.  The format for specifying fonts comes from the
<a name="line919"><font color="#000000">0919:</font></a> fontconfig library used in modern Free desktops:
<a name="line920"><font color="#000000">0920:</font></a> 
<a name="line921"><font color="#000000">0921:</font></a> <b><font color="#0000FF">@example</font></b>
<a name="line922"><font color="#000000">0922:</font></a>   [Family[-PointSize]][:Option1=Value1[:Option2=Value2[...]]]
<a name="line923"><font color="#000000">0923:</font></a> <b><font color="#0000FF">@end example</font></b>
<a name="line924"><font color="#000000">0924:</font></a> 
<a name="line925"><font color="#000000">0925:</font></a>   The old XLFD based format is also supported for backwards compatibility.
<a name="line926"><font color="#000000">0926:</font></a> 
<a name="line927"><font color="#000000">0927:</font></a> <i><font color="#9A1900">@cindex font backend selection (MS-Windows)</font></i>
<a name="line928"><font color="#000000">0928:</font></a>   Emacs 23 and later supports a number of font backends.  Currently,
<a name="line929"><font color="#000000">0929:</font></a> the <b><font color="#0000FF">@code</font></b><font color="#009900">{gdi}</font> and <b><font color="#0000FF">@code</font></b><font color="#009900">{uniscribe}</font> backends are supported on Windows.
<a name="line930"><font color="#000000">0930:</font></a> The <b><font color="#0000FF">@code</font></b><font color="#009900">{gdi}</font> font backend is available on all versions of Windows,
<a name="line931"><font color="#000000">0931:</font></a> and supports all fonts that are natively supported by Windows.  The
<a name="line932"><font color="#000000">0932:</font></a> <i><font color="#9A1900">@code{uniscribe} font backend is available on Windows 2000 and later,</font></i>
<a name="line933"><font color="#000000">0933:</font></a> and supports TrueType and OpenType fonts.  Some languages requiring
<a name="line934"><font color="#000000">0934:</font></a> complex layout can only be properly supported by the Uniscribe
<a name="line935"><font color="#000000">0935:</font></a> backend.  By default, both backends are enabled if supported, with
<a name="line936"><font color="#000000">0936:</font></a> <i><font color="#9A1900">@code{uniscribe} taking priority over @code{gdi}.  To override that</font></i>
<a name="line937"><font color="#000000">0937:</font></a> and use the GDI backend even if Uniscribe is available, invoke Emacs
<a name="line938"><font color="#000000">0938:</font></a> with the <b><font color="#0000FF">@kbd</font></b><font color="#009900">{-xrm Emacs.fontBackend:gdi}</font> command-line argument, or
<a name="line939"><font color="#000000">0939:</font></a> add a <b><font color="#0000FF">@code</font></b><font color="#009900">{Emacs.fontBackend}</font> resource with the value <b><font color="#0000FF">@code</font></b><font color="#009900">{gdi}</font> in
<a name="line940"><font color="#000000">0940:</font></a> the Registry under either the
<a name="line941"><font color="#000000">0941:</font></a> <b><font color="#0000FF">@samp</font></b><font color="#009900">{HKEY_CURRENT_USER\SOFTWARE\GNU\Emacs}</font> or the
<a name="line942"><font color="#000000">0942:</font></a> <b><font color="#0000FF">@samp</font></b><font color="#009900">{HKEY_LOCAL_MACHINE\SOFTWARE\GNU\Emacs}</font> key (<b><font color="#0000FF">@pxref</font></b><font color="#FF0000">{</font><font color="#FF0000">Resources</font><font color="#FF0000">}</font>).
<a name="line943"><font color="#000000">0943:</font></a> 
<a name="line944"><font color="#000000">0944:</font></a> <i><font color="#9A1900">@cindex font properties (MS Windows)</font></i>
<a name="line945"><font color="#000000">0945:</font></a> <b><font color="#0000FF">@noindent</font></b>
<a name="line946"><font color="#000000">0946:</font></a> Optional properties common to all font backends on MS-Windows are:
<a name="line947"><font color="#000000">0947:</font></a> 
<a name="line948"><font color="#000000">0948:</font></a> <b><font color="#0000FF">@table</font></b> <i><font color="#9A1900">@code</font></i>
<a name="line949"><font color="#000000">0949:</font></a> 
<a name="line950"><font color="#000000">0950:</font></a> <b><font color="#0000FF">@vindex</font></b> font-weight-table <b><font color="#0000FF">@r</font></b><font color="#009900">{(MS-Windows)}</font>
<a name="line951"><font color="#000000">0951:</font></a> <b><font color="#0000FF">@item</font></b> weight
<a name="line952"><font color="#000000">0952:</font></a> Specifies the weight of the font.  Special values <b><font color="#0000FF">@code</font></b><font color="#009900">{light}</font>,
<a name="line953"><font color="#000000">0953:</font></a> <i><font color="#9A1900">@code{medium}, @code{demibold}, @code{bold}, and @code{black} can be specified</font></i>
<a name="line954"><font color="#000000">0954:</font></a> without <b><font color="#0000FF">@code</font></b><font color="#009900">{weight=}</font> (e.g., <b><font color="#0000FF">@kbd</font></b><font color="#009900">{Courier New-12:bold}</font>).  Otherwise,
<a name="line955"><font color="#000000">0955:</font></a> the weight should be a numeric value between 100 and 900, or one of the
<a name="line956"><font color="#000000">0956:</font></a> named weights in <b><font color="#0000FF">@code</font></b><font color="#009900">{font-weight-table}</font>.  If unspecified, a regular font
<a name="line957"><font color="#000000">0957:</font></a> is assumed.
<a name="line958"><font color="#000000">0958:</font></a> 
<a name="line959"><font color="#000000">0959:</font></a> <b><font color="#0000FF">@vindex</font></b> font-slant-table <b><font color="#0000FF">@r</font></b><font color="#009900">{(MS-Windows)}</font>
<a name="line960"><font color="#000000">0960:</font></a> <b><font color="#0000FF">@item</font></b> slant
<a name="line961"><font color="#000000">0961:</font></a> Specifies whether the font is italic.  Special values
<a name="line962"><font color="#000000">0962:</font></a> <i><font color="#9A1900">@code{roman}, @code{italic} and @code{oblique} can be specified</font></i>
<a name="line963"><font color="#000000">0963:</font></a> without <b><font color="#0000FF">@code</font></b><font color="#009900">{slant=}</font> (e.g., <b><font color="#0000FF">@kbd</font></b><font color="#009900">{Courier New-12:italic}</font>).
<a name="line964"><font color="#000000">0964:</font></a> Otherwise, the slant should be a numeric value, or one of the named
<a name="line965"><font color="#000000">0965:</font></a> slants in <b><font color="#0000FF">@code</font></b><font color="#009900">{font-slant-table}</font>.  On Windows, any slant above 150 is
<a name="line966"><font color="#000000">0966:</font></a> treated as italics, and anything below as roman.
<a name="line967"><font color="#000000">0967:</font></a> 
<a name="line968"><font color="#000000">0968:</font></a> <b><font color="#0000FF">@item</font></b> family
<a name="line969"><font color="#000000">0969:</font></a> Specifies the font family, but normally this will be specified
<a name="line970"><font color="#000000">0970:</font></a> at the start of the font name.
<a name="line971"><font color="#000000">0971:</font></a> 
<a name="line972"><font color="#000000">0972:</font></a> <b><font color="#0000FF">@item</font></b> pixelsize
<a name="line973"><font color="#000000">0973:</font></a> Specifies the font size in pixels.  This can be used instead
<a name="line974"><font color="#000000">0974:</font></a> of the point size specified after the family name.
<a name="line975"><font color="#000000">0975:</font></a> 
<a name="line976"><font color="#000000">0976:</font></a> <b><font color="#0000FF">@item</font></b> adstyle
<a name="line977"><font color="#000000">0977:</font></a> Specifies additional style information for the font.
<a name="line978"><font color="#000000">0978:</font></a> On MS-Windows, the values <b><font color="#0000FF">@code</font></b><font color="#009900">{mono}</font>, <b><font color="#0000FF">@code</font></b><font color="#009900">{sans}</font>, <b><font color="#0000FF">@code</font></b><font color="#009900">{serif}</font>,
<a name="line979"><font color="#000000">0979:</font></a> <i><font color="#9A1900">@code{script} and @code{decorative} are recognized.  These are most useful</font></i>
<a name="line980"><font color="#000000">0980:</font></a> as a fallback with the font family left unspecified.
<a name="line981"><font color="#000000">0981:</font></a> 
<a name="line982"><font color="#000000">0982:</font></a> <b><font color="#0000FF">@vindex</font></b> w32-charset-info-alist
<a name="line983"><font color="#000000">0983:</font></a> <b><font color="#0000FF">@item</font></b> registry
<a name="line984"><font color="#000000">0984:</font></a> Specifies the character set registry that the font is
<a name="line985"><font color="#000000">0985:</font></a> expected to cover.  Most TrueType and OpenType fonts will be Unicode fonts
<a name="line986"><font color="#000000">0986:</font></a> that cover several national character sets, but you can narrow down the
<a name="line987"><font color="#000000">0987:</font></a> selection of fonts to those that support a particular character set by
<a name="line988"><font color="#000000">0988:</font></a> using a specific registry from <b><font color="#0000FF">@code</font></b><font color="#009900">{w32-charset-info-alist}</font> here.
<a name="line989"><font color="#000000">0989:</font></a> 
<a name="line990"><font color="#000000">0990:</font></a> <b><font color="#0000FF">@item</font></b> spacing
<a name="line991"><font color="#000000">0991:</font></a> Specifies how the font is spaced.  The <b><font color="#0000FF">@code</font></b><font color="#009900">{p}</font> spacing specifies
<a name="line992"><font color="#000000">0992:</font></a> a proportional font, and <b><font color="#0000FF">@code</font></b><font color="#009900">{m}</font> or <b><font color="#0000FF">@code</font></b><font color="#009900">{c}</font> specify a monospaced font.
<a name="line993"><font color="#000000">0993:</font></a> 
<a name="line994"><font color="#000000">0994:</font></a> <b><font color="#0000FF">@item</font></b> foundry
<a name="line995"><font color="#000000">0995:</font></a> Not used on Windows, but for informational purposes and to
<a name="line996"><font color="#000000">0996:</font></a> prevent problems with code that expects it to be set, is set internally to
<a name="line997"><font color="#000000">0997:</font></a> <i><font color="#9A1900">@code{raster} for bitmapped fonts, @code{outline} for scalable fonts,</font></i>
<a name="line998"><font color="#000000">0998:</font></a> or <b><font color="#0000FF">@code</font></b><font color="#009900">{unknown}</font> if the type cannot be determined as one of those.
<a name="line999"><font color="#000000">0999:</font></a> <b><font color="#0000FF">@end table</font></b>
<a name="line1000"><font color="#000000">1000:</font></a> 
<a name="line1001"><font color="#000000">1001:</font></a> <i><font color="#9A1900">@cindex font properties (MS Windows gdi backend)</font></i>
<a name="line1002"><font color="#000000">1002:</font></a> Options specific to <b><font color="#0000FF">@code</font></b><font color="#009900">{GDI}</font> fonts:
<a name="line1003"><font color="#000000">1003:</font></a> 
<a name="line1004"><font color="#000000">1004:</font></a> <b><font color="#0000FF">@table</font></b> <i><font color="#9A1900">@code</font></i>
<a name="line1005"><font color="#000000">1005:</font></a> 
<a name="line1006"><font color="#000000">1006:</font></a> <i><font color="#9A1900">@cindex font scripts (MS Windows)</font></i>
<a name="line1007"><font color="#000000">1007:</font></a> <i><font color="#9A1900">@cindex font Unicode subranges (MS Windows)</font></i>
<a name="line1008"><font color="#000000">1008:</font></a> <b><font color="#0000FF">@item</font></b> script
<a name="line1009"><font color="#000000">1009:</font></a> Specifies a Unicode subrange the font should support.
<a name="line1010"><font color="#000000">1010:</font></a> 
<a name="line1011"><font color="#000000">1011:</font></a> The following scripts are recognized on Windows: <b><font color="#0000FF">@code</font></b><font color="#009900">{latin}</font>, <b><font color="#0000FF">@code</font></b><font color="#009900">{greek}</font>,
<a name="line1012"><font color="#000000">1012:</font></a> <i><font color="#9A1900">@code{coptic}, @code{cyrillic}, @code{armenian}, @code{hebrew}, @code{arabic},</font></i>
<a name="line1013"><font color="#000000">1013:</font></a> <i><font color="#9A1900">@code{syriac}, @code{nko}, @code{thaana}, @code{devanagari}, @code{bengali},</font></i>
<a name="line1014"><font color="#000000">1014:</font></a> <i><font color="#9A1900">@code{gurmukhi}, @code{gujarati}, @code{oriya}, @code{tamil}, @code{telugu},</font></i>
<a name="line1015"><font color="#000000">1015:</font></a> <i><font color="#9A1900">@code{kannada}, @code{malayam}, @code{sinhala}, @code{thai}, @code{lao},</font></i>
<a name="line1016"><font color="#000000">1016:</font></a> <i><font color="#9A1900">@code{tibetan}, @code{myanmar}, @code{georgian}, @code{hangul},</font></i>
<a name="line1017"><font color="#000000">1017:</font></a> <i><font color="#9A1900">@code{ethiopic}, @code{cherokee}, @code{canadian-aboriginal}, @code{ogham},</font></i>
<a name="line1018"><font color="#000000">1018:</font></a> <i><font color="#9A1900">@code{runic}, @code{khmer}, @code{mongolian}, @code{symbol}, @code{braille},</font></i>
<a name="line1019"><font color="#000000">1019:</font></a> <i><font color="#9A1900">@code{han}, @code{ideographic-description}, @code{cjk-misc}, @code{kana},</font></i>
<a name="line1020"><font color="#000000">1020:</font></a> <i><font color="#9A1900">@code{bopomofo}, @code{kanbun}, @code{yi}, @code{byzantine-musical-symbol},</font></i>
<a name="line1021"><font color="#000000">1021:</font></a> <i><font color="#9A1900">@code{musical-symbol}, and @code{mathematical}.</font></i>
<a name="line1022"><font color="#000000">1022:</font></a> 
<a name="line1023"><font color="#000000">1023:</font></a> <i><font color="#9A1900">@cindex font antialiasing (MS Windows)</font></i>
<a name="line1024"><font color="#000000">1024:</font></a> <b><font color="#0000FF">@item</font></b> antialias
<a name="line1025"><font color="#000000">1025:</font></a> Specifies the antialiasing method.  The value <b><font color="#0000FF">@code</font></b><font color="#009900">{none}</font> means no
<a name="line1026"><font color="#000000">1026:</font></a> antialiasing, <b><font color="#0000FF">@code</font></b><font color="#009900">{standard}</font> means use standard antialiasing,
<a name="line1027"><font color="#000000">1027:</font></a> <i><font color="#9A1900">@code{subpixel} means use subpixel antialiasing (known as Cleartype on</font></i>
<a name="line1028"><font color="#000000">1028:</font></a> Windows), and <b><font color="#0000FF">@code</font></b><font color="#009900">{natural}</font> means use subpixel antialiasing with
<a name="line1029"><font color="#000000">1029:</font></a> adjusted spacing between letters.  If unspecified, the font will use
<a name="line1030"><font color="#000000">1030:</font></a> the system default antialiasing.
<a name="line1031"><font color="#000000">1031:</font></a> <b><font color="#0000FF">@end table</font></b>
<a name="line1032"><font color="#000000">1032:</font></a> 
<a name="line1033"><font color="#000000">1033:</font></a> <b><font color="#0000FF">@node</font></b> Windows Misc
<a name="line1034"><font color="#000000">1034:</font></a> <b><font color="#0000FF">@section</font></b> Miscellaneous Windows-specific features
<a name="line1035"><font color="#000000">1035:</font></a> 
<a name="line1036"><font color="#000000">1036:</font></a>   This section describes miscellaneous Windows-specific features.
<a name="line1037"><font color="#000000">1037:</font></a> 
<a name="line1038"><font color="#000000">1038:</font></a> <b><font color="#0000FF">@vindex</font></b> w32-use-visible-system-caret
<a name="line1039"><font color="#000000">1039:</font></a> <i><font color="#9A1900">@cindex screen reader software, MS-Windows</font></i>
<a name="line1040"><font color="#000000">1040:</font></a>   The variable <b><font color="#0000FF">@code</font></b><font color="#009900">{w32-use-visible-system-caret}</font> is a flag that
<a name="line1041"><font color="#000000">1041:</font></a> determines whether to make the system caret visible.  The default when
<a name="line1042"><font color="#000000">1042:</font></a> no screen reader software is in use is <b><font color="#0000FF">@code</font></b><font color="#009900">{nil}</font>, which means Emacs
<a name="line1043"><font color="#000000">1043:</font></a> draws its own cursor to indicate the position of point.  A
<a name="line1044"><font color="#000000">1044:</font></a> non-<b><font color="#0000FF">@code</font></b><font color="#009900">{nil}</font> value means Emacs will indicate point location with the
<a name="line1045"><font color="#000000">1045:</font></a> system caret; this facilitates use of screen reader software, and is
<a name="line1046"><font color="#000000">1046:</font></a> the default when such software is detected when running Emacs.
<a name="line1047"><font color="#000000">1047:</font></a> When this variable is non-<b><font color="#0000FF">@code</font></b><font color="#009900">{nil}</font>, other variables affecting the
<a name="line1048"><font color="#000000">1048:</font></a> cursor display have no effect.
<a name="line1049"><font color="#000000">1049:</font></a> 
<a name="line1050"><font color="#000000">1050:</font></a> <b><font color="#0000FF">@iftex</font></b>
<a name="line1051"><font color="#000000">1051:</font></a> <b><font color="#0000FF">@inforef</font></b><font color="#FF0000">{</font><font color="#FF0000">Windows Misc, , emacs</font><font color="#FF0000">}</font>, for information about additional
<a name="line1052"><font color="#000000">1052:</font></a> Windows-specific variables in this category.
<a name="line1053"><font color="#000000">1053:</font></a> <b><font color="#0000FF">@end iftex</font></b>
<a name="line1054"><font color="#000000">1054:</font></a> 
<a name="line1055"><font color="#000000">1055:</font></a> <b><font color="#0000FF">@ifnottex</font></b>
<a name="line1056"><font color="#000000">1056:</font></a> <b><font color="#0000FF">@vindex</font></b> w32-grab-focus-on-raise
<a name="line1057"><font color="#000000">1057:</font></a> <i><font color="#9A1900">@cindex frame focus policy, MS-Windows</font></i>
<a name="line1058"><font color="#000000">1058:</font></a>   The variable <b><font color="#0000FF">@code</font></b><font color="#009900">{w32-grab-focus-on-raise}</font>, if set to a
<a name="line1059"><font color="#000000">1059:</font></a> non-<b><font color="#0000FF">@code</font></b><font color="#009900">{nil}</font> value causes a frame to grab focus when it is raised.
<a name="line1060"><font color="#000000">1060:</font></a> The default is <b><font color="#0000FF">@code</font></b><font color="#009900">{t}</font>, which fits well with the Windows default
<a name="line1061"><font color="#000000">1061:</font></a> click-to-focus policy.
<a name="line1062"><font color="#000000">1062:</font></a> <b><font color="#0000FF">@end ifnottex</font></b>
<a name="line1063"><font color="#000000">1063:</font></a> 
<a name="line1064"><font color="#000000">1064:</font></a> <b><font color="#0000FF">@ifnottex</font></b>
<a name="line1065"><font color="#000000">1065:</font></a> <b><font color="#000080">@include</font></b> msdos-xtra.texi
<a name="line1066"><font color="#000000">1066:</font></a> <b><font color="#0000FF">@end ifnottex</font></b>
<a name="line1067"><font color="#000000">1067:</font></a> </tt></pre>
