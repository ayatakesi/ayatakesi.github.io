<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 6.8, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This is the GNU Emacs Manual,
updated for Emacs version 30.0.50.

Copyright (C) 1985-1987, 1993-2023 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document under
the terms of the GNU Free Documentation License, Version 1.3 or any later
version published by the Free Software Foundation; with the Invariant
Sections being "The GNU Manifesto," "Distribution" and "GNU GENERAL
PUBLIC LICENSE," with the Front-Cover Texts being "A GNU Manual," and
with the Back-Cover Texts as in (a) below.  A copy of the license is
included in the section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and modify
this GNU manual.  Buying copies from the FSF supports it in developing GNU
and promoting software freedom." -->
<title>Android Environment (GNU Emacs Manual
(Japanese Translation))</title>

<meta name="description" content="Android Environment (GNU Emacs Manual
(Japanese Translation))">
<meta name="keywords" content="Android Environment (GNU Emacs Manual
(Japanese Translation))">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2any">
<meta name="date" content="October 17, 2023">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Key-Index.html" rel="index" title="Key Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Android.html" rel="up" title="Android">
<link href="Android-Windowing.html" rel="next" title="Android Windowing">
<link href="Android-Document-Providers.html" rel="prev" title="Android Document Providers">
<style type="text/css">
<!--
a.copiable-anchor {visibility: hidden; text-decoration: none; line-height: 0em}
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
span:hover a.copiable-anchor {visibility: visible}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en">
<div class="section" id="Android-Environment">
<div class="header">
<p>
Next: <a href="Android-Windowing.html" accesskey="n" rel="next">The Android Window System</a>, Previous: <a href="Android-Document-Providers.html" accesskey="p" rel="prev">Accessing Files from Other Programs on Android</a>, Up: <a href="Android.html" accesskey="u" rel="up">Emacs and Android</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Key-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<span id="Running-Emacs-under-Android"></span><h3 class="section">H.5 Running Emacs under Android</h3>

<p>From the perspective of users, Android is mostly a single user operating
system; however, from the perspective of applications and Emacs, the system
has an overwhelming number of users.
</p>
<p>Each application runs in its own user, with its home directory set to its
app data directory (see <a href="Android-File-System.html">What Files Emacs Can Access on Android</a>.)<a id="DOCF28" href="#FOOT28"><sup>28</sup></a>
</p>
<p>Each application is also prohibited from accessing many system directories
and the app data directories of other applications.
</p>
<p>The Emacs distribution also incorporates several binaries.  While being
executable files, they are packaged as libraries in the library directory,
because otherwise the system will not unpack them while Emacs is being
installed.  This means that instead of <code>ctags</code> or <code>emacsclient</code>,
Lisp code must specify <code>libctags.so</code> or <code>libemacsclient.so</code> on the
command line when starting either of those programs in a subprocess; to
determine which names to use, consult the values of the variables
<code>ctags-program-name</code>, <code>etags-program-name</code>,
<code>hexl-program-name</code>, <code>emacsclient-program-name</code>,
<code>movemail-program-name</code>, <code>ebrowse-program-name</code>, and
<code>rcs2log-program-name</code>.  See <a data-manual="elisp" href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Subprocess-Creation.html#Subprocess-Creation">Subprocess Creation</a> in <cite>the Emacs
Lisp Reference Manual</cite>.
</p>
<p>The <samp>/assets</samp> directory containing Emacs start-up files is supposed to
be inaccessible to processes not directly created by <code>zygote</code>, the
system service responsible for starting applications.  Since required Lisp
is found in the <samp>/assets</samp> directory, it would thus follow that it is
not possible for Emacs to start itself as a subprocess.  A special binary
named <code>libandroid-emacs.so</code> is provided with Emacs, and does its
best to start Emacs for the purpose of running Lisp in batch mode.  However,
the approach it takes was devised by reading Android source code, and is not
sanctioned by the Android compatibility definition documents, so your
mileage may vary.
</p>
<span id="index-call_002dprocess_002c-Android"></span>
<span id="index-android_002duse_002dexec_002dloader"></span>
<p>Android 10 and later also prohibit Emacs itself from running executables
inside the app data directory, obstensibly for security reasons.  On these
systems, Emacs normally applies a workaround; however, this workaround
requires running all sub-processes through another subprocess which
implements an executable loader and applies process tracing to all its
children, which may prove to be problematic for various different reasons.
In that case, the workaround can be disabled by changing the variable
<code>android-use-exec-loader</code> to <code>nil</code>.
</p>
<p>When this workaround is in effect, process IDs retrieved through the
<code>process-id</code> function will be that of the executable loader process;
its child will belong to the same process group as the loader.  As a result,
<code>interrupt-process</code>, and other related functions will work correctly,
but using the process ID returned by <code>process-id</code> for other purposes
will not.
</p>
<p>One side effect of the mechanism by which process tracing is carried out is
that job control facilities inside inferior shells (see <a href="Interactive-Shell.html">対話的なサブシェル</a>) will not be able to stop processes, and sending the <code>SIGSTOP</code>
signal to a subprocess created by Emacs will appear to have no effect.
</p>
<p>In addition, Android 12 also terminates subprocesses which are consuming CPU
while Emacs itself is in the background.  The system determines which
processes are consuming too much CPU in intervals of five minutes, and
terminates the process that has consumed the most CPU time.
</p>
<p>Android 12.1 and Android 13 provide an option to disable this behavior; to
use it, enable &ldquo;USB debugging&rdquo; (see <a href="Android-Startup.html">Starting Emacs on Android</a>) connect the
Android system to another computer, and run:
</p>
<div class="example">
<pre class="example">$ adb shell &quot;settings put global settings_enable_monitor_phantom_procs false&quot;
</pre></div>

<span id="index-running-emacs-in-the-background_002c-android"></span>
<span id="index-emacs-killed_002c-android"></span>
<span id="index-emacs-in-the-background_002c-android"></span>

<p>Application processes are treated as disposable entities by the system.
When all Emacs frames move to the background, Emacs might be terminated by
the system at any time, for the purpose of saving system resources.
</p>
<p>On Android 7.1 and earlier, Emacs tells the system to treat it as a
&ldquo;background service&rdquo;.  The system will try to avoid killing Emacs unless
the system is stressed for memory.
</p>
<p>Android 8.0 removed the ability for background services to receive such
special treatment.  However, Emacs applies a workaround: the system
considers applications that create a permanent notification to be performing
active work, and will avoid killing such applications.  Thus, on those
systems, Emacs displays a permanent notification for as long as it is
running.  Once the notification is displayed, it can be safely hidden
through the system settings without resulting in Emacs being killed.
</p>
<p>However, it is not guaranteed that the system will not kill Emacs even if a
notification is being displayed.  While the Open Handset Alliance&rsquo;s sample
implementation of Android behaves correctly, many manufacturers place
additional restrictions on program execution in the background in their
proprietary versions of Android.  There is a list of such troublesome
manufacturers and sometimes workarounds at <a href="https://dontkillmyapp.com/">https://dontkillmyapp.com/</a>.
</p>
<span id="index-permissions-under-android"></span>
<span id="index-external-storage_002c-android"></span>

<p>Android also defines a permissions system that determines what system
services Emacs is allowed to access.  Programs must specify what permissions
they want; what then happens depends on the version of Android being used:
</p>
<ul>
<li> On Android 5.1 and earlier, Emacs automatically receives the following
permissions it has requested upon being installed:

<ul class="no-bullet">
<li>- <code>android.permission.READ_CONTACTS</code>
</li><li>- <code>android.permission.WRITE_CONTACTS</code>
</li><li>- <code>android.permission.VIBRATE</code>
</li><li>- <code>android.permission.ACCESS_COARSE_LOCATION</code>
</li><li>- <code>android.permission.ACCESS_NETWORK_STATE</code>
</li><li>- <code>android.permission.INTERNET</code>
</li><li>- <code>android.permission.SET_WALLPAPER</code>
</li><li>- <code>android.permission.READ_EXTERNAL_STORAGE</code>
</li><li>- <code>android.permission.WRITE_EXTERNAL_STORAGE</code>
</li><li>- <code>android.permission.SEND_SMS</code>
</li><li>- <code>android.permission.RECEIVE_SMS</code>
</li><li>- <code>android.permission.RECEIVE_MMS</code>
</li><li>- <code>android.permission.WRITE_SMS</code>
</li><li>- <code>android.permission.READ_SMS</code>
</li><li>- <code>android.permission.NFC</code>
</li><li>- <code>android.permission.TRANSMIT_IR</code>
</li><li>- <code>android.permission.READ_PHONE_STATE</code>
</li><li>- <code>android.permission.WAKE_LOCK</code>
</li><li>- <code>android.permission.FOREGROUND_SEVICE</code>
</li><li>- <code>android.permission.REQUEST_INSTALL_PACKAGES</code>
</li><li>- <code>android.permission.REQUEST_DELETE_PACKAGES</code>
</li><li>- <code>android.permission.SYSTEM_ALERT_WINDOW</code>
</li><li>- <code>android.permission.RECORD_AUDIO</code>
</li><li>- <code>android.permission.CAMERA</code>
</li><li>- <code>android.permission.POST_NOTIFICATIONS</code>
</li></ul>

<p>While most of these permissions are left unused by Emacs itself, they are
declared by Emacs as they could be useful for other programs; for example,
the permission to access contacts may be useful for EUDC.
</p>
</li><li> On Android 6.0 and later, Emacs only receives the following permissions upon
installation:

<ul class="no-bullet">
<li>- <code>android.permission.VIBRATE</code>
</li><li>- <code>android.permission.ACCESS_NETWORK_STATE</code>
</li><li>- <code>android.permission.INTERNET</code>
</li><li>- <code>android.permission.SET_WALLPAPER</code>
</li><li>- <code>android.permission.NFC</code>
</li><li>- <code>android.permission.TRANSMIT_IR</code>
</li><li>- <code>android.permission.WAKE_LOCK</code>
</li></ul>

<p>Other permissions must be granted by the user through the system settings
application.  Consult the manufacturer of your device for more details, as
how to do this varies by device.
</p></li></ul>

</div>
<div class="footnote">
<hr>
<h4 class="footnotes-heading">Footnotes</h4>

<h5><a id="FOOT28" href="#DOCF28">(28)</a></h5>
<p>Except in cases
where a &ldquo;shared user ID&rdquo; is specified and other applications signed using
the same &ldquo;package signing key&rdquo; are installed, in which case Emacs runs as
the same user and has access to the same files as each of the aformentioned
applications.</p>
</div>
<hr>
<div class="header">
<p>
Next: <a href="Android-Windowing.html">The Android Window System</a>, Previous: <a href="Android-Document-Providers.html">Accessing Files from Other Programs on Android</a>, Up: <a href="Android.html">Emacs and Android</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Key-Index.html" title="Index" rel="index">Index</a>]</p>
</div>


This page has generated for branch:master, commit:32e0f902629c8a91cc7caff0367ea5c80020639d to check Japanese translation.
</body>
</html>
