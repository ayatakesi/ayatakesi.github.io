<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 6.8, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This is the GNU Emacs Manual,
updated for Emacs version 30.0.50.

Copyright (C) 1985-2023 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document under
the terms of the GNU Free Documentation License, Version 1.3 or any later
version published by the Free Software Foundation; with the Invariant
Sections being "The GNU Manifesto," "Distribution" and "GNU GENERAL
PUBLIC LICENSE," with the Front-Cover Texts being "A GNU Manual," and
with the Back-Cover Texts as in (a) below.  A copy of the license is
included in the section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and modify
this GNU manual.  Buying copies from the FSF supports it in developing GNU
and promoting software freedom." -->
<title>Android Environment (GNU Emacs Manual
(Japanese Translation))</title>

<meta name="description" content="Android Environment (GNU Emacs Manual
(Japanese Translation))">
<meta name="keywords" content="Android Environment (GNU Emacs Manual
(Japanese Translation))">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2any">
<meta name="date" content="April 27, 2024">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Key-Index.html" rel="index" title="Key Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Android.html" rel="up" title="Android">
<link href="Android-Windowing.html" rel="next" title="Android Windowing">
<link href="Android-Document-Providers.html" rel="prev" title="Android Document Providers">
<style type="text/css">
<!--
a.copiable-anchor {visibility: hidden; text-decoration: none; line-height: 0em}
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
span:hover a.copiable-anchor {visibility: visible}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en">
<div class="section" id="Android-Environment">
<div class="header">
<p>
Next: <a href="Android-Windowing.html" accesskey="n" rel="next">The Android Window System</a>, Previous: <a href="Android-Document-Providers.html" accesskey="p" rel="prev">Androidでの他のプログラムからのファイルアクセス</a>, Up: <a href="Android.html" accesskey="u" rel="up">EmacstとAndroid</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Key-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<span id="AndroiddenoEmacsnoShi-Xing-"></span><h3 class="section">H.5 AndroidでのEmacsの実行</h3>

<p>ユーザーから見るとAndroidはほとんどタンドクユーザー向けオペレーティングシステムです。ただしアプリケーションやEmacsの視点から見ると、非常に多数のユーザーにホストするシステムなのです。
</p>
<p>アプリケーションはそれぞれ独自のホームディレクトリー(アプリケーションのアプリケーションデータディレクトリー; <a href="Android-File-System.html">AndroidでEmacsがアクセスできるファイル</a>を参照)をセットされて、独自のユーザーにより実行されます。<a id="DOCF28" href="#FOOT28"><sup>28</sup></a>
</p>
<p>アプリケーションはそれぞれ、多くのシステムディレクトリーや他のアプリケーションのアプリケーションデータディレクトリへのアクセスも禁止されています。
</p>
<p>Emacsの配布物には複数のバイナリーも含まれています。実行可能ファイルはライブラリーディレクトリーにパッケージされます。そうしなけれしばEmacsのインストールにおいてそれらをシステムがパッケージ展開しないからです。これは<code>ctags</code>や<code>emacsclient</code>をサブプロセスで起動する際に、Lispコードがかわりに<code>libctags.so</code>や<code>libemacsclient.so</code>にコマンドライン指定しなければならないことを意味しています。変数<code>ctags-program-name</code>、<code>etags-program-name</code>、<code>hexl-program-name</code>、<code>emacsclient-program-name</code>、<code>movemail-program-name</code>、<code>ebrowse-program-name</code>、<code>rcs2log-program-name</code>の値を調べてどの名前が使用されたのを判断シテ。<a data-manual="elisp" href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Subprocess-Creation.html#Subprocess-Creation">Subprocess
Creation</a> in <cite>the Emacs Lisp Reference Manual</cite>を参照してください。
</p>
<p>Emacsの起動時ファイルを含んだ<samp>/assets</samp>ディレクトリーは、<code>zygote</code>
(アプリケーションを起動する役目和担うシステムサービス)によって直接作成されたプロセスでなければアクセスできないように設計されています。必要となるLispは<samp>/assets</samp>ディレクトリーにあるので、これにしたがうとサブプロセスとしてEmacsを起動するのは不可能です。Emacsと一緒に提供される<code>libandroid-emacs.so</code>という名前の特別なバイナリーが、Emacsを開始してバッチモードでLispを実行するために最善を尽くします。ただしこはAndroidのソースを読むことによって考案されたアプローチであり、Androidの互換性定義ドキュメントによって認可されていないので効果は様々かもしれません。
</p>
<span id="index-call_002dprocess_002c-Android"></span>
<span id="index-android_002duse_002dexec_002dloader"></span>
<p>Android
10以降では表向きはセキュリティー上の懸念という理由により、Emacs自体がアプリケーションデータディレクトリーにある実行可能ファイルを実行することも禁止されました。それらのシステムでは、通常はEmacsが回避策を講じることにます。ただしこの回避策には実行可能ファイルのロードを実装して、その子プロセスすべてにトレースを適用するような別プロセスを介して、すべてのサブプロセスを実行することが要求されます。これは様々な理由による問題が生じる可能性があるのです。そのような場合には変数<code>android-use-exec-loader</code>を<code>nil</code>に変更することで、この回避策を無効にできます。
</p>
<p>この回避策が効力をもつ間は、<code>process-id</code>関数によって取得されるプロセスIDはその実行可能ローダーのプロセスIDとなります。実行可能ローダーの子プロセスは実行可能ローダーと同じプロセスグループに所属するからです。したがって<code>interrupt-process</code>やその他の関連する関数は正しく機能しますが、他の目的のために<code>process-id</code>がリターンしたプロセスIDを用いても正しく機能しないでしょう。
</p>
<p>このプロセスのトレースが実行されるメカニズムから派生する影響の1つとして、内部シェル(<a href="Interactive-Shell.html">対話的なサブシェル</a>を参照)の内部のジョブ制御機能がプロセスを停止できなくなり、Emacsがサブプロセスにたいして<code>SIGSTOP</code>シグナルを生成しても効果はないでしょう。
</p>
<p>さらにAndroid
12ではEmacs自体がバックグラウンドの間はCPUを消費するサブプロセスも終了させられます。システムはCPUを過剰に消費するプロセスを5分間隔で判定して、もっともCPU時間を多く消費するプロセスを終了させるのです。
</p>
<p>Android 12.1およびAndroid 13ではこの挙動を無効にするオプションが提供されています。これを行うには&ldquo;USB
debugging&rdquo;(<a href="Android-Startup.html">Android&lt;でのEmacsの起動</a>を参照)を有効にして別のシステムからAndroidシステムに接続して以下を実行してください:
</p>
<div class="example">
<pre class="example">$ adb shell &quot;settings put global settings_enable_monitor_phantom_procs false&quot;
</pre></div>

<span id="index-C-locale-settings_002c-Android"></span>
<p>Emacsはシステムのユーザーアプリケーションにたいして構成されたlocaleにしたがいません。Androidで利用できる選択されたlocaleが、Cライブラリーによって提供されるlocaleと一致しないからです。EmacsがAndroid
5.0以降で開始されると環境変数<code>LANG</code>が<code>en_US.utf8</code>にセットされます。これには出力を適切にプリントできるようにするために、Android
Cライブラリーにたいしてリンクされたサブプロセスも含まれます。それ以前のバージョンのAndroidでは何のlocaleも実装されていないために、この変数は<code>C</code>にセットされます。
</p>
<span id="index-running-emacs-in-the-background_002c-android"></span>
<span id="index-emacs-killed_002c-android"></span>
<span id="index-emacs-in-the-background_002c-android"></span>

<p>アプリケーションプロセスはシステムによって使い捨て可能な実体として扱われます。Emacsのすべてのフレームがバックグラウンドに移動されると、システムリソースを節約するために、任意のタイミングでEmacsが終了させられる可能性があります。
</p>
<p>Android
7.1以前ではメモリー負荷がないかぎりシステムがEmacsをkillしないように、Emacsが自身を&ldquo;バックグラウンドサービス&rdquo;に指定します。
</p>
<p>Android
8.0ではそのようなバックグラウンドサービスを特別に扱う機能が削除されました。とはいえEmacsには回避策があります。システムは永続的に通知を作成するアプリケーションはアクティブな作業を行っているとみなして、そのようなアプリケーションのkillを回避します。したがってそのようなシステムでは、Emacsが実行されているかぎり通知が永続的に表示されます。
</p>
<p>バージョン13より前のAndroidでは、Emacsが通知を表示する権限は不要です。Android
13以降では、ユーザーがEmacsにそのような権限を与えるまで通知は表示されません。それにも関わらず、単に通知の表示を試みるだけで突然死を避けるには十分なのです。通知が表示されるかどうかがバックグラウンドにおけるEmacsの実行能力を損なうことはないので、通知を無効にしても問題はないでしょう。
</p>
<p>ただしシステムがEmacsをkillしない保証はありません。Open Handset
AllianceのAndroidのサンプル実装は正しく振る舞うとはいえ、多くのメーカーのプロプライエタリーなバージョンのAndroidには、バックグラウンドにおけるプログラムの実行に追加の制限が設けられているのです。<a href="https://dontkillmyapp.com/">https://dontkillmyapp.com/</a>にはそのような問題のあるメーカー、および場合によっては回避策となるようなリストがあります。
</p>
<span id="index-permissions-under-android"></span>
<span id="index-external-storage_002c-android"></span>

<p>AndroidにはEmacsにアクセスできるシステムサービスを判定する権限システムも定義されています。プログラムは欲する権限を指定しなければなりません。その後に何が起こるかは、使用中にAndroidのバージョン次第です。
</p>
<ul>
<li> ある程度最近リリースされたAndroid、たとえばAndroid 6.0以降では、インストール時にEmacsが取得する権限は以下の権限だけです:

<ul class="no-bullet">
<li>- <code>android.permission.VIBRATE</code>
</li><li>- <code>android.permission.ACCESS_NETWORK_STATE</code>
</li><li>- <code>android.permission.INTERNET</code>
</li><li>- <code>android.permission.SET_WALLPAPER</code>
</li><li>- <code>android.permission.NFC</code>
</li><li>- <code>android.permission.TRANSMIT_IR</code>
</li><li>- <code>android.permission.WAKE_LOCK</code>
</li><li>- <code>android.permission.FOREGROUND_SERVICE</code>
</li><li>- <code>android.permission.FOREGROUND_SERVICE_SPECIAL_USE</code>
</li></ul>

<p>その他の権限については、ユーザーがシステム設定アプリケーションを介して付与しなければなりません。これを行う方法はデバイスにより異なるので、詳細はデバイスの製造元に照会してください。
</p>
</li><li> Android 5.1以前では、Emacsはインストール時に要求した以下の権限を自動的に取得します:

<ul class="no-bullet">
<li>- <code>android.permission.READ_CONTACTS</code>
</li><li>- <code>android.permission.WRITE_CONTACTS</code>
</li><li>- <code>android.permission.VIBRATE</code>
</li><li>- <code>android.permission.ACCESS_COARSE_LOCATION</code>
</li><li>- <code>android.permission.ACCESS_NETWORK_STATE</code>
</li><li>- <code>android.permission.INTERNET</code>
</li><li>- <code>android.permission.SET_WALLPAPER</code>
</li><li>- <code>android.permission.READ_CALENDAR</code>
</li><li>- <code>android.permission.WRITE_CALENDAR</code>
</li><li>- <code>android.permission.READ_EXTERNAL_STORAGE</code>
</li><li>- <code>android.permission.WRITE_EXTERNAL_STORAGE</code>
</li><li>- <code>android.permission.SEND_SMS</code>
</li><li>- <code>android.permission.RECEIVE_SMS</code>
</li><li>- <code>android.permission.RECEIVE_MMS</code>
</li><li>- <code>android.permission.WRITE_SMS</code>
</li><li>- <code>android.permission.READ_SMS</code>
</li><li>- <code>android.permission.NFC</code>
</li><li>- <code>android.permission.TRANSMIT_IR</code>
</li><li>- <code>android.permission.READ_PHONE_STATE</code>
</li><li>- <code>android.permission.WAKE_LOCK</code>
</li><li>- <code>android.permission.FOREGROUND_SEVICE</code>
</li><li>- <code>android.permission.REQUEST_INSTALL_PACKAGES</code>
</li><li>- <code>android.permission.REQUEST_DELETE_PACKAGES</code>
</li><li>- <code>android.permission.SYSTEM_ALERT_WINDOW</code>
</li><li>- <code>android.permission.RECORD_AUDIO</code>
</li><li>- <code>android.permission.CAMERA</code>
</li><li>- <code>android.permission.POST_NOTIFICATIONS</code>
</li></ul>

<p>これらの権限のほとんどについてはEmacs自体に使われることはありませんが、他のプログラムに有用かもしれないのでEmacsにより宣言されています。たとえば連絡先へのアクセス権限はEUDCにとって有用かもしれません。
</p></li></ul>

</div>
<div class="footnote">
<hr>
<h4 class="footnotes-heading">Footnotes</h4>

<h5><a id="FOOT28" href="#DOCF28">(28)</a></h5>
<p>&ldquo;共有ユーザーID(shared user
ID)&rdquo;を指定して、同じ&lsquo;パッケージ署名キー(&lsquo;package signing
key)&rdquo;を用いて署名、インストールされた他のプログラムは除外される。このような場合にはEmacsは同じユーザーで実行されるとともに、それらのアプリケーションそれぞれにたいして同じアクセス圏を保有する。</p>
</div>


This page has generated for branch:master, commit:78a306c7ac6f4741f1d2a14332399d5f28e6a614 to check Japanese translation.
</body>
</html>
