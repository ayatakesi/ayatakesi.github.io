<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 6.8, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This is the GNU Emacs Manual,
updated for Emacs version 30.0.50.

Copyright (C) 1985-1987, 1993-2023 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document under
the terms of the GNU Free Documentation License, Version 1.3 or any later
version published by the Free Software Foundation; with the Invariant
Sections being "The GNU Manifesto," "Distribution" and "GNU GENERAL
PUBLIC LICENSE," with the Front-Cover Texts being "A GNU Manual," and
with the Back-Cover Texts as in (a) below.  A copy of the license is
included in the section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and modify
this GNU manual.  Buying copies from the FSF supports it in developing GNU
and promoting software freedom." -->
<title>Android File System (GNU Emacs Manual
(Japanese Translation))</title>

<meta name="description" content="Android File System (GNU Emacs Manual
(Japanese Translation))">
<meta name="keywords" content="Android File System (GNU Emacs Manual
(Japanese Translation))">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2any">
<meta name="date" content="September 1, 2023">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Key-Index.html" rel="index" title="Key Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Android.html" rel="up" title="Android">
<link href="Android-Document-Providers.html" rel="next" title="Android Document Providers">
<link href="Android-Startup.html" rel="prev" title="Android Startup">
<style type="text/css">
<!--
a.copiable-anchor {visibility: hidden; text-decoration: none; line-height: 0em}
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
span:hover a.copiable-anchor {visibility: visible}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en">
<div class="section" id="Android-File-System">
<div class="header">
<p>
Next: <a href="Android-Document-Providers.html" accesskey="n" rel="next">Accessing Files from Other Programs on Android</a>, Previous: <a href="Android-Startup.html" accesskey="p" rel="prev">Starting Emacs on Android</a>, Up: <a href="Android.html" accesskey="u" rel="up">Emacs and Android</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Key-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<span id="What-Files-Emacs-Can-Access-on-Android"></span><h3 class="section">H.3 What Files Emacs Can Access on Android</h3>
<span id="index-_002fassets-directory_002c-android"></span>

<p>Emacs exposes a special directory on Android systems: the name of the
directory is <samp>/assets</samp>, and it contains the <samp>etc</samp>, <samp>lisp</samp> and
<samp>info</samp> directories which are normally installed in
<samp>/usr/share/emacs</samp> directory on GNU and Unix systems.  On Android
systems, the Lisp emulation of <code>ls</code> (see <a href="ls-in-Lisp.html">MS-Windowsでの<code>ls</code>のエミュレーション</a>) is also
enabled by default, as the <code>ls</code> binary which comes with the system
varies by manufacturer and usually does not support all of the features
required by Emacs.  One copy of <code>ls</code> distributed with some Android
systems is even known to lack support for the <code>-l</code> flag.
</p>
<span id="index-limitations-of-the-_002fassets-directory"></span>

<p>This directory exists because Android does not extract the contents of
application packages on to the file system while unpacking them, but instead
requires programs like Emacs to access its contents using a special &ldquo;asset
manager&rdquo; interface.  Here are the peculiarities that result from such an
implementation:
</p>
<ul>
<li> Subprocesses (such as <code>ls</code>) can not run from the <samp>/assets</samp>
directory; if you try to run a subprocess with <code>current-directory</code> set
to <samp>/assets</samp>, <samp>/content/storage</samp> or a subdirectory thereof, it
will run from the home directory instead.

</li><li> There are no <samp>.</samp> and <samp>..</samp> directories inside the <samp>/assets</samp> or
<samp>/content</samp> directory.

</li><li> Files in the <samp>/assets</samp> directory are always read only, and may be read
in to memory more than once each time they are opened.
</li></ul>

<p>Aside from the <samp>/assets</samp> directory, Android programs normally have
access to four other directories.  They are:
</p>
<ul>
<li> The <em>app data</em> directory.  This also serves as the home directory for
Emacs, and is always accessible read-write.

</li><li> The <em>app library</em> directory.  This is automatically appended to
<code>exec-path</code> and made <code>exec-directory</code> upon startup, and contains
utility executables alongside Emacs itself.

</li><li> The <em>external storage</em> directory.  This is accessible to Emacs when the
user grants the &ldquo;Files and Media&rdquo; permission to Emacs via system settings.

</li><li> Directories provided by <em>document providers</em> on Android 5.0 and later.
These directories exist outside the normal Unix filesystem, containing files
provided by external programs (see <a href="Android-Document-Providers.html">Accessing Files from Other Programs on Android</a>.)
</li></ul>

<p>Despite ordinary installations of Android not having files within the
(normally read-only) root directory named <samp>content</samp> or <samp>assets</samp>,
you may want to access real files by these names if the Android installation
in use has been customized.  These files will conflict with the
aformentioned special directories, but can nevertheless be accessed by
writing their names relative to the &ldquo;parent&rdquo; directory of the root
directory, as so illustrated: <samp>/../content</samp>, <samp>/../assets</samp>.
</p>
<p>The external storage directory is found at <samp>/sdcard</samp>.  The other
directories are not found at any fixed location (but see below), although
the app data directory is typically symlinked to
<samp>/data/data/org.gnu.emacs/files</samp>.
</p>
<span id="index-app-library-directory_002c-android"></span>
<span id="index-where-is-emacsclient-under-android"></span>
<p>Older versions of Android used to place the app library directory under the
name <samp>lib</samp> in the parent of the app data directory.  Today, this
directory is often placed in a directory with a randomly generated name
under <samp>/data/app</samp>.
</p>
<p>For the convenience of scripts running within applications sharing the same
user ID as Emacs (which have no access to the <code>exec-directory</code>
variable), a fairly considerable effort is made at startup to symlink the
application library directory to its traditional location within the parent
of the app data directory.
</p>
<p>If Emacs is reinstalled and the location of the app library directory
consequentially changes, that symlink will also be updated to point to its
new location the next time Emacs is started by the system.
</p>
<span id="index-temp_007eunlinked_002eNNNN-files_002c-Android"></span>
<p>On Android devices running very old (2.6.29) versions of the Linux kernel,
Emacs needs to create files named starting with <samp>temp~unlinked</samp> in the
the temporary file directory in order to read from asset files.  Do not
create files with such names yourself, or they may be overwritten or
removed.
</p>
<span id="index-file-system-limitations_002c-Android-11"></span>
<p>On Android 11 and later, the Android system restricts applications from
accessing files in the <samp>/sdcard</samp> directory using file-related system
calls such as <code>open</code> and <code>readdir</code>.
</p>
<p>This restriction is known as &ldquo;Scoped Storage&rdquo;, and supposedly makes the
system more secure.  Unfortunately, it also means that Emacs cannot access
files in those directories, despite holding the necessary permissions.
Thankfully, the Open Handset Alliance&rsquo;s version of Android allows this
restriction to be disabled on a per-program basis; the corresponding option
in the system settings panel is:
</p>
<div class="example">
<pre class="example">System -&gt; Apps -&gt; Special App Access -&gt; All files access -&gt; Emacs
</pre></div>

<p>After you disable or enable this setting as appropriate and grant Emacs the
&ldquo;Files and Media&rdquo; permission, it will be able to access files under
<samp>/sdcard</samp> as usual.  These settings are not present on some proprietary
versions of Android.
</p>
</div>
<hr>
<div class="header">
<p>
Next: <a href="Android-Document-Providers.html">Accessing Files from Other Programs on Android</a>, Previous: <a href="Android-Startup.html">Starting Emacs on Android</a>, Up: <a href="Android.html">Emacs and Android</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Key-Index.html" title="Index" rel="index">Index</a>]</p>
</div>


This page has generated for branch:master, commit:150786d23562e017c6e6da3645cd2b40fcd0d0ab to check Japanese translation.
</body>
</html>
