<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 6.8, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This is the GNU Emacs Manual,
updated for Emacs version 27.2.50.

Copyright (C) 1985-1987, 1993-2023 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document under
the terms of the GNU Free Documentation License, Version 1.3 or any later
version published by the Free Software Foundation; with the Invariant
Sections being "The GNU Manifesto," "Distribution" and "GNU GENERAL
PUBLIC LICENSE," with the Front-Cover Texts being "A GNU Manual," and
with the Back-Cover Texts as in (a) below.  A copy of the license is
included in the section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and modify
this GNU manual.  Buying copies from the FSF supports it in developing GNU
and promoting software freedom." -->
<title>Saving Emacs Sessions (GNU Emacs Manual
(Japanese Translation))</title>

<meta name="description" content="Saving Emacs Sessions (GNU Emacs Manual
(Japanese Translation))">
<meta name="keywords" content="Saving Emacs Sessions (GNU Emacs Manual
(Japanese Translation))">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2any">
<meta name="date" content="June 21, 2023">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Key-Index.html" rel="index" title="Key Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="index.html" rel="up" title="Top">
<link href="Recursive-Edit.html" rel="next" title="Recursive Edit">
<link href="Editing-Binary-Files.html" rel="prev" title="Editing Binary Files">
<style type="text/css">
<!--
a.copiable-anchor {visibility: hidden; text-decoration: none; line-height: 0em}
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
span:hover a.copiable-anchor {visibility: visible}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en">
<div class="section" id="Saving-Emacs-Sessions">
<div class="header">
<p>
Next: <a href="Recursive-Edit.html" accesskey="n" rel="next">再帰編集レベル</a>, Previous: <a href="Editing-Binary-Files.html" accesskey="p" rel="prev">バイナリーファイルの編集</a>, Up: <a href="index.html" accesskey="u" rel="up">The Emacs Editor</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Key-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<span id="EmacssetusiyonnoBao-Cun-"></span><h2 class="chapter">45 Emacsセッションの保存</h2>
<span id="index-saving-sessions"></span>
<span id="index-restore-session"></span>
<span id="index-remember-editing-session"></span>
<span id="index-reload-files"></span>

<span id="index-desktop-configuration"></span>
<p>You can use the desktop library to save the state of Emacs from one session
to another.  The saved Emacs <em>desktop configuration</em> includes the
buffers, their file names, major modes, buffer positions, window and frame
configuration, and some important global variables.
</p>
<span id="index-desktop_002dsave_002dmode-1"></span>
<span id="index-desktop_002dsave_002dmode"></span>
<p>To enable this feature, use the Customization buffer (see <a href="Easy-Customization.html">Easy Customizationインターフェース</a>) to set <code>desktop-save-mode</code> to <code>t</code> for future
sessions, or add this line in your init file (see <a href="Init-File.html">Emacs初期化ファイル</a>):
</p>
<div class="example">
<pre class="example">(desktop-save-mode 1)
</pre></div>

<span id="index-desktop_002dpath"></span>
<span id="index-desktop_002dauto_002dsave_002dtimeout"></span>
<p>If you turn on <code>desktop-save-mode</code> in your init file, then when Emacs
starts, it looks for a saved desktop in <code>desktop-path</code> (which defaults
to <code>user-emacs-directory</code> and then your home directory) and uses the
first desktop it finds.  While Emacs runs with <code>desktop-save-mode</code>
turned on, it by default auto-saves the desktop whenever any of the desktop
configuration changes.  The variable <code>desktop-auto-save-timeout</code>
determines how frequently Emacs checks for modifications to your desktop.
The desktop is also saved when you exit Emacs.
</p>
<span id="index-disable-restoring-of-desktop-configuration"></span>
<p>Specify the option &lsquo;<samp>--no-desktop</samp>&rsquo; on the Emacs command line when you
don&rsquo;t want it to reload any saved desktop configurations.  This turns off
<code>desktop-save-mode</code> for the current session.  Starting Emacs with the
&lsquo;<samp>--no-init-file</samp>&rsquo; option also disables desktop reloading, since it
bypasses the init file, where <code>desktop-save-mode</code> is usually turned on.
</p>
<span id="index-desktop_002dchange_002ddir"></span>
<span id="index-desktop_002drevert"></span>
<p>You can have separate saved desktop configurations in different directories;
starting Emacs from a directory where you have a saved desktop configuration
will restore that configuration, provided that you customize
<code>desktop-path</code> to prepend <samp>.</samp> (the current directory) to the other
directories there.  You can save the current desktop and reload the one
saved in another directory by typing <kbd>M-x desktop-change-dir</kbd>.  Typing
<kbd>M-x desktop-revert</kbd> reverts to the previously reloaded desktop.
</p>
<span id="index-desktop_002dload_002dlocked_002ddesktop"></span>
<p>The file in which Emacs saves the desktop is locked while the session runs,
to avoid inadvertently overwriting it from another Emacs session.  That lock
is normally removed when Emacs exits, but if Emacs or your system crashes,
the lock stays, and when you restart Emacs, it will by default ask you
whether to use the locked desktop file.  You can avoid the question by
customizing the variable <code>desktop-load-locked-desktop</code> to either
<code>nil</code>, which means never load the desktop in this case, or <code>t</code>,
which means load the desktop without asking.  You can also customize the
variable to the special value <code>check-pid</code>, which means to load the file
if the Emacs process that has locked the desktop is not running on the local
machine.  This should not be used in circumstances where the locking Emacs
might still be running on another machine, which could be the case in
multi-user environments where your home directory is mounted remotely using
NFS or similar.
</p>
<span id="index-desktop-restore-in-daemon-mode"></span>
<p>When Emacs starts in daemon mode, it cannot ask you any questions, so if it
finds the desktop file locked, it will not load it, unless
<code>desktop-load-locked-desktop</code> is <code>t</code>.  Note that restoring the
desktop in daemon mode is somewhat problematic for other reasons: e.g., the
daemon cannot use GUI features, so parameters such as frame position, size,
and decorations cannot be restored.  For that reason, you may wish to delay
restoring the desktop in daemon mode until the first client connects, by
calling <code>desktop-read</code> (see below) in a hook function that you add to
<code>server-after-make-frame-hook</code> (see <a data-manual="elisp" href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Creating-Frames.html#Creating-Frames">Creating Frames</a> in <cite>The
Emacs Lisp Reference Manual</cite>).
</p>
<span id="index-desktop_002dsave"></span>
<span id="index-desktop_002dread"></span>
<p>Whenever you want, you can use the command <kbd>M-x desktop-save</kbd> to force
immediate saving of the current desktop.  This is useful either if you do
not want to use the automatic desktop restoration, and thus don&rsquo;t turn on
<code>desktop-save-mode</code>, or when you have made significant changes to the
desktop, and want to make sure the configuration doesn&rsquo;t get lost if Emacs
or your system crashes.  You can use <kbd>M-x desktop-read</kbd> to restore a
previously-saved desktop if the current Emacs session didn&rsquo;t load any
desktop yet.
</p>
<span id="index-desktop_002drestore_002dframes"></span>
<p>By default, the desktop tries to save and restore the frame and window
configuration.  To disable this, set <code>desktop-restore-frames</code> to
<code>nil</code>.  (See that variable&rsquo;s documentation for some related options
that you can customize to fine-tune this behavior.)
</p>
<span id="index-frameset_002dfilter_002dalist"></span>
<p>When the desktop restores the frame and window configuration, it uses the
recorded values of frame parameters, disregarding any settings for those
parameters you have in your init file (see <a href="Init-File.html">Emacs初期化ファイル</a>).  This means that
frame parameters such as fonts and faces for the restored frames will come
from the desktop file, where they were saved when you exited your previous
Emacs session; any settings for those parameters in your init file will be
ignored.  To disable this, customize the value of
<code>frameset-filter-alist</code> to filter out the frame parameters you don&rsquo;t
want to be restored; they will then be set according to your customizations
in the init file.
</p>
<span id="index-desktop_002dfiles_002dnot_002dto_002dsave"></span>
<p>デフォルトでは、リモートファイルをvisitしているバッファーに関する情報は保存されません。変数<code>desktop-files-not-to-save</code>をカスタマイズして、これを変更することができます。
</p>
<span id="index-desktop_002drestore_002deager"></span>
<p>デフォルトでは、デスクトップのすべてのバッファーは1度に復元されます。しかし、デスクトップにたくさんのバッファーがあるときは遅くなるかもしれません。変数<code>desktop-restore-eager</code>で、即座に復元するバッファーの最大数を指定できます。残りのバッファーはEmacsのアイドル時に、ゆっくり(lazily)と復元されます。
</p>
<span id="index-desktop_002dclear"></span>
<span id="index-desktop_002dglobals_002dto_002dclear"></span>
<span id="index-desktop_002dclear_002dpreserve_002dbuffers_002dregexp"></span>
<p>Type <kbd>M-x desktop-clear</kbd> to empty the Emacs desktop; this can be useful,
for example, if you want to switch to another desktop by invoking <kbd>M-x
desktop-read</kbd> next.  The <code>desktop-clear</code> command kills all buffers
except for internal ones, and clears the global variables listed in
<code>desktop-globals-to-clear</code>.  If you want it to preserve certain
buffers, customize the variable
<code>desktop-clear-preserve-buffers-regexp</code>, whose value is a regular
expression matching the names of buffers not to kill.
</p>
<p>あるセッションから別のセッションへ、ミニバッファーのヒストリーを保存したい場合は、<code>savehist</code>ライブラリーを使用してください。
</p>
</div>
<hr>
<div class="header">
<p>
Next: <a href="Recursive-Edit.html">再帰編集レベル</a>, Previous: <a href="Editing-Binary-Files.html">バイナリーファイルの編集</a>, Up: <a href="index.html">The Emacs Editor</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Key-Index.html" title="Index" rel="index">Index</a>]</p>
</div>


This page has generated for branch:work/emacs-29_a24e9e3fee59435422af0473b7ec585de2c13b4e, commit:fb03efa36ed9096ad52d5efe82b86a694646951d to check Japanese translation.
</body>
</html>
