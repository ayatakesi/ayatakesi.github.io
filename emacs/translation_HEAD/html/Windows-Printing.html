<!DOCTYPE html>
<html>
<!-- Created by GNU Texinfo 7.1, https://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- This is the GNU Emacs Manual,
updated for Emacs version 30.0.91.

Copyright © 1985-2024 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document under
the terms of the GNU Free Documentation License, Version 1.3 or any later
version published by the Free Software Foundation; with the Invariant
Sections being "The GNU Manifesto," "Distribution" and "GNU GENERAL
PUBLIC LICENSE," with the Front-Cover Texts being "A GNU Manual," and
with the Back-Cover Texts as in (a) below.  A copy of the license is
included in the section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and modify
this GNU manual.  Buying copies from the FSF supports it in developing GNU
and promoting software freedom." -->
<title>Windows Printing (GNU Emacs Manual
(Japanese Translation))</title>

<meta name="description" content="Windows Printing (GNU Emacs Manual
(Japanese Translation))">
<meta name="keywords" content="Windows Printing (GNU Emacs Manual
(Japanese Translation))">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2any">
<meta name="date" content="October 7, 2024">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link href="index.html" rel="start" title="Top">
<link href="Key-Index.html" rel="index" title="Key Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Microsoft-Windows.html" rel="up" title="Microsoft Windows">
<link href="Windows-Fonts.html" rel="next" title="Windows Fonts">
<link href="Windows-Processes.html" rel="prev" title="Windows Processes">
<style type="text/css">
<!--
a.copiable-link {visibility: hidden; text-decoration: none; line-height: 0em}
div.example {margin-left: 3.2em}
kbd.kbd {font-style: oblique}
kbd.key {font-style: normal}
span:hover a.copiable-link {visibility: visible}
-->
</style>


</head>

<body lang="en">
<div class="section-level-extent" id="Windows-Printing">
<div class="nav-panel">
<p>
Next: <a href="Windows-Fonts.html" accesskey="n" rel="next">MS-Windowsでのフォント指定</a>, Previous: <a href="Windows-Processes.html" accesskey="p" rel="prev">Windows 9X/MEおよびWindows NT/2000/XP/Vista/7/8/10でのサブプロセス</a>, Up: <a href="Microsoft-Windows.html" accesskey="u" rel="up">EmacsとMicrosoft Windows/MS-DOS</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Key-Index.html" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<h3 class="section" id="MS_002dWindowsdenoYin-Shua-"><span>I.9 MS-Windowsでの印刷<a class="copiable-link" href="#MS_002dWindowsdenoYin-Shua-"> &para;</a></span></h3>

<p>POSIXスタイルの<code class="code">lpr</code>プログラムが利用できない場合、MS-DOSとMS-Windowsでは、<code class="code">lpr-buffer</code>(<a class="ref" href="Printing.html">ハードコピーの印刷</a>を参照してください)や<code class="code">ps-print-buffer</code>(<a class="ref" href="PostScript.html">PostScriptのハードコピー</a>を参照してください)のような印刷コマンドは、プリンターポートの1つに出力を送ります。同じEmacs変数がすべてのシステムでの印刷を制御しますが、MS-DOSとMS-Windowsでは、それらの変数が異なるデフォルト値をもつ場合があります。
</p>
<p>MS
WindowsのEmacsは、(関数<code class="code">default-printer-name</code>を使用して)デフォルトプリンターの自動検出を試みます。しかし、これはある稀なケースでは失敗することがあり、Emacsから別のプリンターを使用したいと思うときがあるかもしれません。このセクションの残りの部分では、Emacsに使用するプリンターを指示する方法を説明します。
</p>
<a class="index-entry-id" id="index-printer_002dname_002c-_0028MS_002dDOS_002fMS_002dWindows_0029"></a>
<p>ローカルプリンターを使用したい場合、Lisp変数<code class="code">lpr-command</code>に<code class="code">&quot;&quot;</code>(これはWindowsではデフォルトです)をセットして、<code class="code">printer-name</code>にプリンターポート、たとえば通常のローカルプリンターポート<code class="code">&quot;PRN&quot;</code>、または<code class="code">&quot;LPT2&quot;</code>、またはシリアルプリンターにたいする<code class="code">&quot;COM1&quot;</code>などをセットします。<code class="code">printer-name</code>にファイル名をセットすることもできます。この場合、&ldquo;印刷&rdquo;された出力は、そのファイルに追加されます。<code class="code">printer-name</code>を<code class="code">&quot;NUL&quot;</code>にセットした場合、印刷された出力は破棄されます(システムのnullデバイスに送られます)。
</p>
<p><code class="code">printer-name</code>にそのプリンターのUNC共有名 &mdash; たとえば<code class="code">&quot;//joes_pc/hp4si&quot;</code>のような &mdash;
をセットすることにより、他のマシンで共有されているプリンターを使用することもできます(ここではスラッシュを使用するか、バックスラッシュを使用するかは問題ではありません)。共有プリンターの名前を探すには、サーバーのリストを取得するために、コマンドプロンプトでコマンド&lsquo;<samp class="samp">net
view</samp>&rsquo;を実行して、&lsquo;<samp class="samp">net view
<var class="var">server-name</var></samp>&rsquo;でそのサーバーで共有されているプリンター(とディレクトリー)の名前を確認します。かわりにデスクトップの&lsquo;<samp class="samp">Network
Neighborhood</samp>&rsquo;アイコンをクリックして、ネットワークを通じてプリンターを共有しているマシンを確認することもできます。
</p>
<a class="index-entry-id" id="index-net-use_002c-and-printing-on-MS_002dWindows"></a>
<a class="index-entry-id" id="index-networked-printers-_0028MS_002dWindows_0029"></a>
<p>プリンターが&lsquo;<samp class="samp">net
view</samp>&rsquo;で出力されない場合、または<code class="code">printer-name</code>にUNC共有名をセットしても、そのプリンターからハードコピーが出力されない場合、&lsquo;<samp class="samp">net
use</samp>&rsquo;コマンドを使用して、<code class="code">&quot;LPT2&quot;</code>のようなローカルプリンターポートを、ネットワークプリンターに接続できます。たとえば<kbd class="kbd">net
use LPT2:
\\joes_pc\hp4si</kbd><a class="footnote" id="DOCF31" href="#FOOT31"><sup>31</sup></a>により、Windowsに<code class="code">LPT2</code>ポートを<em class="dfn">キャプチャー</em>させて、印刷物をマシン<code class="code">joes_pc</code>に接続されているプリンターにリダイレクトします。このコマンド後は、<code class="code">printer-name</code>に<code class="code">&quot;LPT2&quot;</code>をセットすることにより、そのネットワークプリンターでハードコピーが印刷されます。
</p>
<p>あるWindowsネットワークソフトウェアーでは、<code class="code">&quot;LPT2&quot;</code>のような特定のプリンターポートをキャプチャーして、&lsquo;<samp class="samp">net
use</samp>&rsquo;のかわりに<code class="code">Control&nbsp;Panel-&gt;Printers</code><!-- /@w -->を通じてネットワークプリンターにリダイレクトするよう、Windowsに指示できます。
</p>
<p><code class="code">printer-name</code>にファイル名をセットする場合、絶対ファイル名を使用するのが最良です。Emacsはカレントバッファーのデフォルトディレクトリーに合わせて作業ディレクトリーを変更するので、<code class="code">printer-name</code>のファイル名が相対ファイル名の場合、結果として印刷が行なわれたバッファーのディレクトリーごとに、複数のファイルができてしまいます。
</p>
<p>変数<code class="code">printer-name</code>の値が正しいのに、印刷してもそのプリンターからハードコピーが印刷されない場合、そのプリンターがプレーンテキストの印刷をサポートしない可能性があります(安価なプリンターのいくつかでは、この機能が省略されています)。そのような場合、以下で説明するPostScriptプリントコマンドを試してみてください。
</p>
<a class="index-entry-id" id="index-print_002dbuffer-_0028MS_002dDOS_0029"></a>
<a class="index-entry-id" id="index-print_002dregion-_0028MS_002dDOS_0029"></a>
<a class="index-entry-id" id="index-lpr_002dheaders_002dswitches-_0028MS_002dDOS_0029"></a>
<p>コマンド<code class="code">print-buffer</code>および<code class="code">print-region</code>は、印刷された各ページにヘッダーを生成するために、<code class="code">pr</code>プログラムを呼び出すか、<code class="code">lpr</code>プログラムの特別なスイッチを使用します。通常MS-DOSとMS-Windowsにはこれらのプログラムがないので、デフォルトでは印刷ページのヘッダーの印刷リクエストは単に無視されるように、<code class="code">lpr-headers-switches</code>がセットされています。したがって<code class="code">print-buffer</code>と<code class="code">print-region</code>は、<code class="code">lpr-buffer</code>および<code class="code">lpr-region</code>と同じ出力を生成します。適切な<code class="code">pr</code>プログラム(たとえばGNU
Coreutilsのもの)がある場合は、<code class="code">lpr-headers-switches</code>に<code class="code">nil</code>をセットします。するとEmacsはページヘッダーを生成するために<code class="code">pr</code>を呼び出し、その結果を<code class="code">printer-name</code>で指定されたプリンターで印刷します。
</p>
<a class="index-entry-id" id="index-print_002dregion_002dfunction-_0028MS_002dDOS_0029"></a>
<a class="index-entry-id" id="index-lpr-usage-under-MS_002dDOS"></a>
<a class="index-entry-id" id="index-lpr_002dcommand-_0028MS_002dDOS_0029"></a>
<a class="index-entry-id" id="index-lpr_002dswitches-_0028MS_002dDOS_0029"></a>
<p>最後に、もし<code class="code">lpr</code>によく似たものがある場合、変数<code class="code">lpr-command</code>を<code class="code">&quot;lpr&quot;</code>にセットします。するとEmacsは他のシステムと同じように、印刷に<code class="code">lpr</code>を使用します(そのプログラムの名前が<code class="code">lpr</code>でない場合は、<code class="code">lpr-command</code>に適切な値をセットします)。<code class="code">lpr-command</code>が<code class="code">&quot;&quot;</code>でないときに、変数<code class="code">lpr-switches</code>は、その標準的な意味をもちます。変数<code class="code">printer-name</code>の値が文字列のとき、Unixの場合のように、<code class="code">lpr</code>の<code class="code">-P</code>オプションの値としてその文字列が使用されます。
</p>
<a class="index-entry-id" id="index-ps_002dprint_002dbuffer-_0028MS_002dDOS_0029"></a>
<a class="index-entry-id" id="index-ps_002dspool_002dbuffer-_0028MS_002dDOS_0029"></a>
<a class="index-entry-id" id="index-ps_002dprinter_002dname-_0028MS_002dDOS_0029"></a>
<a class="index-entry-id" id="index-ps_002dlpr_002dcommand-_0028MS_002dDOS_0029"></a>
<a class="index-entry-id" id="index-ps_002dlpr_002dswitches-_0028MS_002dDOS_0029"></a>
<p>類似の変数<code class="code">ps-lpr-command</code>、<code class="code">ps-lpr-switches</code>、<code class="code">ps-printer-name</code>
(<a class="ref" href="PostScript-Variables.html">PostScriptハードコピーにたいする変数</a>を参照してください)は、PostScriptファイルがどのように印刷されるかを定義します。これらの変数は、上記で説明した非PostScript印刷にたいする変数と同じ方法で使用されます。したがって非PostScript印刷にたいして<code class="code">printer-name</code>が使用される方法と同様に、<code class="code">ps-printer-name</code>の値はPostScript出力が送られるデバイス(またはファイル)の名前として使用されます(2つの異なるポートに接続された2つのプリンターがあり、それらの1つだけがPostScriptプリンターの場合、2つの個別の変数セットをもつことができます)。
</p>
<a class="index-entry-id" id="index-Ghostscript_002c-use-for-PostScript-printing"></a>
<p>変数<code class="code">ps-lpr-command</code>のデフォルト値は<code class="code">&quot;&quot;</code>で、これはPostScript出力を<code class="code">ps-printer-name</code>で指定されたプリンターポートに送りますが、<code class="code">ps-lpr-command</code>にはPostScriptファイルを受け付けるプログラム名をセットすることもできます。したがって非PostScriptプリンターがある場合、この変数に(Ghostscriptのような)PostScriptのインタープリタープログラムをセットできます。インタープリタープログラムに渡す必要があるスイッチを指定するには、<code class="code">ps-lpr-switches</code>を使用します(<code class="code">ps-printer-name</code>の値が文字列の場合、<code class="code">-P</code>オプションにたいする値として、スイッチのリストが追加されます。これはおそらく<code class="code">lpr</code>を使用する場合だけ有用なので、インタープリターを使用するときは<code class="code">ps-printer-name</code>に文字列以外の何かをセットすれば、無視させることができます)。
</p>
<p>たとえばシステムのデフォルトプリンターで、Ghostscriptを使用して印刷するには、以下を<samp class="file">.emacs</samp>に記述します:
</p>
<div class="example">
<pre class="example-preformatted">(setq ps-printer-name t)
(setq ps-lpr-command &quot;D:/gs6.01/bin/gswin32c.exe&quot;)
(setq ps-lpr-switches '(&quot;-q&quot; &quot;-dNOPAUSE&quot; &quot;-dBATCH&quot;
                        &quot;-sDEVICE=mswinpr2&quot;
                        &quot;-sPAPERSIZE=a4&quot;))
</pre></div>

<p>(Ghostscriptがディレクトリー<samp class="file">D:/gs6.01</samp>にインストールされていると仮定します。)
</p>
</div>
<div class="footnotes-segment">
<hr>
<h4 class="footnotes-heading">Footnotes</h4>

<h5 class="footnote-body-heading"><a id="FOOT31" href="#DOCF31">(31)</a></h5>
<p><code class="code">printer-name</code>の値は、スラッシュとバックスラッシュの両方でセットできますが、&lsquo;<samp class="samp">net
use</samp>&rsquo;コマンドはUNC共有名がWindowsスタイルのバックスラッシュでタイプされるのを要求することに注意してください。</p>
</div>


This page has generated for branch:work/emacs-30_11e7ae3964e192b0e4bcc437a04278ee727e720b, commit:1ee048bb5a3ce2cc096bb950ed6c3b81fabf61b4 to check Japanese translation.
</body>
</html>
